# XML取扱説明書とガイドの統合サマリー

## 🎯 実施内容

THEME-001「スマートキーでドアが開かない」の13個のガイドと、`docs/xml_aqua/`配下のXML取扱説明書データの紐付けを実施しました。

---

## 📊 作成したドキュメント

| ファイル名 | 内容 | 状態 |
|:-----------|:-----|:-----|
| **GUIDE_XML_MAPPING.md** | XMLファイルとガイドの詳細マッピング | ✅ 完成 |
| **GUIDE_XML_SIMPLE_MAPPING.md** | 簡易マッピングと実装用JSONサンプル | ✅ 完成 |
| **extract_xml_guide_content.py** | XML解析スクリプト | ⚠ DTD問題あり |

---

## 🗂 XMLファイル構成

### 確認済みファイル

| ファイル | チャプター | 関連ガイド数 |
|:---------|:-----------|:------------|
| M52P95tojpjavhch01.xml | 第1章: 安全・安心 | 0 |
| M52P95tojpjavhch02.xml | 第2章: 情報表示 | 0 |
| **M52P95tojpjavhch03.xml** | **第3章: スマートエントリー** | **6ガイド** |
| M52P95tojpjavhch04.xml | 第4章: 操作方法 | 0 |
| M52P95tojpjavhch05.xml | 第5章: 車内装備 | 0 |
| **M52P95tojpjavhch06.xml** | **第6章: メンテナンス** | **4ガイド** |
| **M52P95tojpjavhch07.xml** | **第7章: トラブルシューティング** | **3ガイド** |
| M52P95tojpjavhch08.xml | 第8章: 車両情報 | 0 |

**主要XMLファイル**: 3個 (ch03, ch06, ch07)

---

## 📋 ガイドマッピング結果

### XML参照ガイド（10個）

| ガイドID | タイトル | 対応XMLファイル | 優先度 |
|:---------|:---------|:---------------|:-------|
| GUIDE-001 | 機械キーの取り出し方 | ch03.xml | 高 |
| GUIDE-002 | 機械キーの場所・保管方法 | ch03.xml | 高 |
| GUIDE-003 | 事前準備物 | ch03.xml / ch06.xml | 高 |
| GUIDE-005 | 電池交換手順 | ch03.xml / ch06.xml | 高 |
| GUIDE-007 | ジャンプスタート手順 | ch07.xml | 中 |
| GUIDE-008 | 電波干渉時の対応 | ch03.xml / ch07.xml | 中 |
| GUIDE-009 | キー修理・交換手続き | ch06.xml | 低 |
| GUIDE-010 | ドアロック故障時の対応 | ch07.xml | 中 |
| GUIDE-011 | ロードサービス連絡先 | ch07.xml | 高 |
| GUIDE-013 | 予防策・定期点検 | ch06.xml | 低 |

### システム実装ガイド（3個）

| ガイドID | タイトル | 実装方法 | 優先度 |
|:---------|:---------|:---------|:-------|
| GUIDE-004 | 電池購入方法 | API連携（店舗検索・オンライン購入） | 高 |
| GUIDE-006 | 販売店予約・連絡先 | API連携（予約システム・電話発信） | 高 |
| GUIDE-012 | 販売店連絡先・営業時間 | API連携（店舗情報） | 中 |

---

## 💡 実装用JSONサンプル

### 作成済み

以下のガイドについて、実装用JSONフォーマットを作成しました:

1. ✅ **GUIDE-001**: 機械キーの取り出し方
2. ✅ **GUIDE-003**: 事前準備物
3. ✅ **GUIDE-004**: 電池購入方法
4. ✅ **GUIDE-005**: 電池交換手順
5. ✅ **GUIDE-006**: 販売店予約・連絡先

**場所**: `GUIDE_XML_SIMPLE_MAPPING.md` 内

---

## 🔧 技術的課題

### XML解析の問題

**問題**: XMLファイルにDTDエンティティ(`&rarr;`, `&mdash;`等)が含まれており、標準のXMLパーサーでは読み取れない

**対策**:
1. ✅ **短期**: 手動でXMLを確認し、JSONフォーマットで直接作成
2. ⬜ **中期**: DTDファイル(`toyota_om_vh_jp_ja.dtd`)を読み込むカスタムパーサー作成
3. ⬜ **長期**: XMLからL1データへの自動変換パイプライン構築

---

## 📂 ファイル構造（推奨）

```
docs/journey/csv_data/
├── Guide.csv                          # ガイド一覧CSV
├── GUIDE_XML_MAPPING.md              # XMLマッピング詳細
├── GUIDE_XML_SIMPLE_MAPPING.md       # 簡易マッピング＋JSON
├── extract_xml_guide_content.py      # XML解析スクリプト
│
└── guide_content/                     # ガイドコンテンツ（JSON）
    ├── GUIDE-001_content.json        # 機械キー取り出し
    ├── GUIDE-003_content.json        # 事前準備物
    ├── GUIDE-004_content.json        # 電池購入（システム実装）
    ├── GUIDE-005_content.json        # 電池交換手順
    ├── GUIDE-006_content.json        # 販売店予約（システム実装）
    ├── GUIDE-007_content.json        # ジャンプスタート
    ├── GUIDE-008_content.json        # 電波干渉
    ├── GUIDE-009_content.json        # キー修理
    ├── GUIDE-010_content.json        # ドアロック故障
    ├── GUIDE-011_content.json        # ロードサービス
    ├── GUIDE-012_content.json        # 販売店連絡先（システム実装）
    └── GUIDE-013_content.json        # 予防策・定期点検
```

---

## 🚀 次のアクション

### フェーズ1: ガイドコンテンツ作成（優先度高）

- [ ] GUIDE-001〜006のJSONファイル作成
- [ ] `guide_content/`ディレクトリに配置
- [ ] Guide.csvとの紐付け確認

### フェーズ2: システム実装（優先度高）

- [ ] GUIDE-004: 電池購入サポートAPI実装
  - [ ] オンラインショップリンク生成
  - [ ] 位置情報サービス連携
  - [ ] 近隣店舗検索API

- [ ] GUIDE-006: 販売店予約API実装
  - [ ] トヨタ公式予約システム連携
  - [ ] 電話発信機能（モバイル）
  - [ ] 営業時間動的表示

### フェーズ3: 残りガイド作成（優先度中）

- [ ] GUIDE-007〜013のJSONファイル作成
- [ ] XMLから手順・イラスト情報抽出

### フェーズ4: RAGシステム連携（優先度中）

- [ ] L1データ構造設計
- [ ] ガイドコンテンツのベクトル化
- [ ] L3（AIガイド層）からのクエリ対応

### フェーズ5: XML自動抽出（優先度低）

- [ ] DTD対応パーサー開発
- [ ] XML→JSON自動変換
- [ ] 更新フロー自動化

---

## 📈 進捗状況

| タスク | 進捗 | 状態 |
|:-------|:-----|:-----|
| XMLファイル確認 | 100% | ✅ 完了 |
| ガイド-XMLマッピング | 100% | ✅ 完了 |
| JSON形式設計 | 100% | ✅ 完了 |
| サンプルJSON作成 | 38% (5/13) | 🔄 進行中 |
| 全ガイドJSON作成 | 0% | ⬜ 未着手 |
| システムAPI実装 | 0% | ⬜ 未着手 |
| RAG連携 | 0% | ⬜ 未着手 |

**全体進捗**: 約35%

---

## 💼 ビジネス価値

### 実現できること

1. ✅ **正確な情報提供**
   - 公式取扱説明書に基づくガイド
   - メーカー推奨の手順

2. ✅ **ユーザー体験向上**
   - ステップバイステップの手順
   - 視覚的な説明（イラスト参照）
   - 状況に応じた選択肢（DIY vs 販売店）

3. ✅ **サービス連携**
   - オンライン購入サポート
   - 販売店予約サポート
   - ロードサービス連絡

4. ✅ **拡張性**
   - 他のテーマへの展開可能
   - L2（コンテキストデータ）連携
   - 多言語対応準備

---

## 📝 まとめ

### ✅ 完了したこと

1. XML取扱説明書とTHEME-001ガイドの完全マッピング
2. 実装用JSONフォーマット設計
3. サンプルガイドコンテンツ作成（5個）
4. システム実装が必要なガイドの特定（3個）

### 🔄 進行中

1. 全ガイドのJSONファイル作成

### ⬜ 次のステップ

1. `guide_content/`ディレクトリにJSONファイル配置
2. システムAPI実装（電池購入・販売店予約）
3. RAGシステムとの連携

---

**この統合により、ユーザーは取扱説明書の正確な情報をジャーニーフロー内で簡単にアクセスできるようになります!**
