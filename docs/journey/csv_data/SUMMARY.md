# Journey Graph システム - 完成サマリー

## 🎉 完成したシステム

**シンプル入力からJourney Graph CSVとフロー図を自動生成するシステムが完成しました!**

---

## 📁 ファイル構成

```
csv_data/
├── 📊 正式CSVデータ
│   ├── JourneyNode.csv          (ノード定義)
│   ├── CheckCondition.csv       (判定条件)
│   ├── Edge.csv                 (エッジ・遷移)
│   ├── Guide.csv                (ガイドコンテンツ)
│   └── NodeIntent.csv           (インテント紐付け)
│
├── 🔧 システムスクリプト
│   ├── generate_journey_csv.py  (自動変換スクリプト)
│   └── journey_processor.py     (ジャーニー実行・処理)
│
├── 📖 ドキュメント
│   ├── README.md                (メインドキュメント)
│   ├── HOW_TO_CREATE_FLOW.md    (フロー作成ガイド)
│   ├── CLEANUP_PLAN.md          (整理計画)
│   ├── ultra_simple_template.md (入力形式詳細)
│   └── simple_input_template.md (参考)
│
├── 📝 入力ファイル例
│   ├── THEME-001_realistic_input.txt  (スマートキー・実践版)
│   └── THEME-002_input.txt            (ブレーキ警告灯)
│
└── 🎨 フロー図・分析
    ├── THEME-001_realistic_flow.md    (実践版フロー定義)
    ├── THEME-001_complete_flow.md     (完全版フロー定義)
    ├── THEME-001_visual_flow.html     (最新フロー図)
    ├── THEME-001_visual_flow.md
    ├── THEME-002_visual_flow.html
    ├── JOURNEY_MAP_THEME-001.md
    └── UPDATE_LOG.md                  (更新ログ)
```

---

## 🔄 ワークフロー

### 従来（複雑）
```
8つのCSVファイルを個別編集 → 整合性確認 → 手動でフロー図作成
❌ 時間がかかる
❌ ミスが発生しやすい
❌ 全体像が把握しにくい
```

### 現在（シンプル）
```
1つのテキストファイルを記述 → 自動変換 → CSV + フロー図 自動生成
✅ 5分で完成
✅ エラーが少ない
✅ 視覚的に確認できる
```

---

## 📝 入力形式

### 形式1: 記号ベース（採用）

```
テーマ: [名前]
ID: THEME-XXX
緊急度: high/medium/low

▼ [開始]
  ? [質問]?
    → [選択肢1]: [次1]
    → [選択肢2]: [次2]

■ [ノード名]
  [GUIDE] [ガイド名]
  → [次へ]

✓ 解決
  → (終了)
```

**記号の意味:**
- `▼` = 開始
- `■` = ノード
- `?` = 判定
- `→` = 遷移
- `[GUIDE]` = ガイド
- `✓` = 解決
- `✗` = 問題
- `⚠` = エスカレーション

---

## 🎯 使い方

### ステップ1: 入力ファイル作成
```bash
# THEME-003_input.txtを作成
テーマ: エンジンがかからない
ID: THEME-003
緊急度: high

▼ エンジンがかからない
  ? メーターは点灯する?
    → はい: スターター確認
    → いいえ: バッテリー上がり疑い

■ バッテリー上がり疑い
  [GUIDE] バッテリーチェック方法
  ...
```

### ステップ2: 自動変換
```bash
cd docs/journey/csv_data
py generate_journey_csv.py THEME-003_input.txt
```

### ステップ3: 確認
```bash
# フロー図をブラウザで開く
start THEME-003_visual_flow.html

# CSVを確認
start JourneyNode.csv
```

### ステップ4: テスト
```bash
py journey_processor.py
```

---

## ✅ 完成したテーマ

### THEME-001: スマートキーでドアが開かない（実践版）
- ノード数: 28
- 判定条件: 15
- エッジ: 30
- ガイド: 13
- 状態: ✅ 取扱説明書準拠版
- 特徴:
  - ✅ 実際の取扱説明書に基づく
  - ✅ 電池交換の詳細サポート（準備・購入・実施）
  - ✅ 販売店予約への誘導
  - ✅ リスク管理（部品破損注意）

### THEME-002: ブレーキ警告灯が点灯
- ノード数: 13
- 判定条件: 6
- エッジ: 12
- ガイド: 8
- 状態: ✅ 自動生成テスト完了

---

## 📊 データ統計

### 全体
- **テーマ数**: 7 (THEME-001実践版 + THEME-002 + THEME-001〜005基本版)
- **総ノード数**: 70+ (THEME-001実践版: 28追加)
- **総判定数**: 33+ (THEME-001実践版: 15追加)
- **総エッジ数**: 76+ (THEME-001実践版: 30追加)
- **総ガイド数**: 39+ (THEME-001実践版: 13追加)

### CSVファイルサイズ
- JourneyNode.csv: ~4.5KB
- CheckCondition.csv: ~2.8KB
- Edge.csv: ~2.1KB
- Guide.csv: ~2.0KB
- NodeIntent.csv: ~1.5KB

---

## 🎨 フロー図の特徴

### 自動生成される内容
1. **Mermaid図**
   - CSVデータからグラフ構造を生成
   - ノードタイプに応じた形状

2. **HTMLインタラクティブ図**
   - ズーム・パン可能
   - ノードをクリックで詳細表示（拡張可能）

3. **色分け**
   - フェーズごとに色を自動割り当て
   - 終端ノードを視覚的に区別

---

## 🔧 システムの特徴

### 1. 柔軟な入力
- Markdownライクな記法
- インデントで構造表現
- 記号で役割を明示

### 2. 自動補完
- ノードIDの自動生成
- フェーズの自動推定
- インテントの自動割り当て

### 3. 整合性チェック
- ノード接続の検証
- 終端ノードの確認
- エッジの重複検出

### 4. 拡張性
- 新しいノードタイプ追加可能
- カスタムフェーズ定義可能
- RAGシステムとの連携準備

---

## 🚀 次のステップ

### Phase 1: データ拡充（現在）
- ✅ THEME-001完全版
- ✅ THEME-002生成
- ⬜ THEME-003〜005拡充

### Phase 2: システム強化
- ⬜ エラーハンドリング強化
- ⬜ バリデーション追加
- ⬜ 差分更新機能

### Phase 3: 連携
- ⬜ RAGシステム連携
- ⬜ L1データ(取扱情報)接続
- ⬜ L2コンテキストデータ活用
- ⬜ L4ログ分析連携

### Phase 4: UI/UX
- ⬜ Webベース入力フォーム
- ⬜ リアルタイムプレビュー
- ⬜ フロー図エディタ

---

## 📚 ドキュメント

### 必読
1. **README.md** - システム全体の説明
2. **HOW_TO_CREATE_FLOW.md** - フロー作成手順
3. **ultra_simple_template.md** - 入力形式詳細

### 参考
- **CLEANUP_PLAN.md** - データ整理方針
- **THEME-001_complete_flow.md** - THEME-001詳細
- **journey_graph_量産用csvテンプレート.md** - 元の設計

---

## 💡 Tips

### フロー作成のコツ
1. **小さく始める**
   - 最初は主要なパスのみ
   - 徐々に分岐を追加

2. **実例から学ぶ**
   - THEME-001, THEME-002を参考に
   - パターンを再利用

3. **視覚化で確認**
   - HTMLフロー図で全体像把握
   - 分岐漏れをチェック

4. **反復改善**
   - 最初から完璧を目指さない
   - テスト → 調整 → 再テスト

### トラブルシューティング
- **パースエラー**: インデントとスペースを確認
- **接続ミス**: ノード名の完全一致を確認
- **表示エラー**: ブラウザのJavaScript有効化

---

## 🎓 学習リソース

### 内部ドキュメント
- `docs/output/統合_システム要件定義書.md` - システム全体設計
- `docs/journey/` - ジャーニー関連ドキュメント

### 外部リソース
- Mermaid公式: https://mermaid.js.org/
- CSV形式: https://www.rfc-editor.org/rfc/rfc4180

---

## 🤝 貢献

### 新しいテーマを追加したら
1. 入力ファイル(`THEME-XXX_input.txt`)をコミット
2. 生成されたHTMLフロー図を確認
3. CSVデータの品質を確認
4. ドキュメントを更新

### 改善提案
- 入力形式の改善案
- 自動変換の精度向上
- 新機能のアイデア

---

## 📞 サポート

質問や問題がある場合:
1. `HOW_TO_CREATE_FLOW.md`のトラブルシューティング参照
2. `README.md`のファイル構成を確認
3. 実例ファイル(`THEME-001`, `THEME-002`)を参考に

---

**システム完成日**: 2026-01-27
**バージョン**: 1.0
**ステータス**: ✅ 稼働中

---

**Happy Journey Creating! 🚀**
