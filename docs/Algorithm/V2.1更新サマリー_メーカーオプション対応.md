# V2.1更新サマリー：メーカーオプション対応

**作成日：** 2026年1月14日  
**バージョン：** 2.1

---

## 🎯 更新概要

V2.1では、**メーカーオプションマスタ**を新規追加し、オプション装備の装着状況を管理できるようにしました。これにより、より正確な機能推奨が可能になります。

---

## 🆕 新規追加ファイル

### **1-12_メーカーオプションマスタ.csv**

**目的：**
- 車種機能マスタで「△（オプション）」となっている機能について、各ユーザーの車両に実際に装着されているかを管理
- オプション装備の有無に基づいた正確な機能推奨を実現

**列構成：**
| 列名 | データ型 | 説明 | 例 |
|-----|---------|------|-----|
| 車両個体ID | テキスト | 個別の車両を識別するID | VEH_001 |
| 車種グレードID | テキスト | 車種機能マスタのID | CAR_001 |
| オプション種類 | テキスト | 装着可能なオプション機能名 | BSM, AHS, PVM, なし |
| 装着有無 | 真偽値 | 実際に装着されているか | TRUE/FALSE |
| 備考 | テキスト | 補足情報 | アクアG・BSM装着 |

---

## 📊 装着可能なオプション一覧

車種機能マスタで「△」となっている機能のみ装着可能：

| 車種グレードID | 車種名 | グレード | 装着可能オプション |
|-------------|--------|---------|-----------------|
| CAR_001 | アクア | G | **BSM** |
| CAR_002 | アクア | Z | **AHS** |
| CAR_007 | クラウン | RS | **PVM** |

---

## 🔄 推奨ロジックへの組み込み

### **判定フロー（更新版）**

```
1. 車両個体IDを取得
   ↓
2. 車種グレードIDを取得
   ↓
3. 推奨したい機能IDを取得
   ↓
4. 車種機能マスタで装備状況を確認
   ↓
   ├─ ○（標準装備）→ ✅ 推奨ロジックへ
   │
   ├─ △（オプション）→ メーカーオプションマスタで装着有無を確認
   │                    ↓
   │                    ├─ TRUE（装着あり）→ ✅ 推奨ロジックへ
   │                    └─ FALSE（装着なし）→ ❌ 推奨しない
   │                                        （セールスマンには購入提案）
   │
   └─ ×（装備なし）→ ❌ 推奨しない
```

---

## 💡 具体例

### **例1：アクアG（VEH_002）でBSMを推奨**

**条件：**
- 車両個体ID：VEH_002
- 車種グレードID：CAR_001（アクアG）
- 推奨機能：BSM（FN006）

**判定：**
1. 車種機能マスタでBSMを確認 → △（オプション）
2. メーカーオプションマスタで装着有無を確認 → TRUE（装着あり）
3. **結果：✅ 推奨可能** → 推奨ロジックを適用

**運転者向けメッセージ：**
「ブラインドスポットモニターが作動中です。車線変更時に死角の車両を検知すると、ドアミラーのランプでお知らせします」

---

### **例2：アクアG（VEH_007）でBSMを推奨**

**条件：**
- 車両個体ID：VEH_007
- 車種グレードID：CAR_001（アクアG）
- 推奨機能：BSM（FN006）

**判定：**
1. 車種機能マスタでBSMを確認 → △（オプション）
2. メーカーオプションマスタで装着有無を確認 → FALSE（装着なし）
3. **結果：❌ 推奨不可**

**運転者向けメッセージ：**
なし（装着していないため推奨しない）

**セールスマン向けメッセージ：**
「【提案】お客様の車両（アクアG）にはBSMがオプションで追加可能です。車線変更時の安全性が向上します。次回来店時にご案内しましょう」

---

### **例3：アクアG（VEH_001）でAHSを推奨**

**条件：**
- 車両個体ID：VEH_001
- 車種グレードID：CAR_001（アクアG）
- 推奨機能：AHS（FN005）

**判定：**
1. 車種機能マスタでAHSを確認 → ×（装備なし）
2. **結果：❌ 推奨不可**（そもそも装着できない）

**メッセージ：**
なし（装着できない機能は推奨対象外）

---

## 📋 更新されたドキュメント一覧

| ドキュメント | 更新内容 |
|-----------|---------|
| **01_機能推奨タイミング判定_軸別マスタ.md** | シート構成を11→15シートに更新、メーカーオプションマスタの詳細を追加 |
| **推奨ロジック設計.md** | 推奨ロジックの判定フローにオプション装備確認を追加 |
| **V2更新内容まとめ.md** | V2.1での追加内容（メーカーオプションマスタ）を追記 |
| **メーカーオプションマスタ設計.md** | **新規作成**：マスタの設計思想と使用方法の詳細説明 |

---

## 🎯 このマスタのメリット

### **1. 正確な機能推奨**
✅ オプション装着車両のみに推奨を行う  
✅ 装着していない車両には推奨しない  
✅ ユーザーエクスペリエンスの向上

### **2. セールス機会の創出**
✅ オプション未装着ユーザーに購入を提案  
✅ 顧客満足度向上とアップセル機会  
✅ データに基づいた提案が可能

### **3. データの一貫性**
✅ 車種機能マスタとの連携  
✅ 装備状況の正確な管理  
✅ メンテナンス性の向上

---

## 🔧 実装時の注意点

### **1. データの整合性**
- 車種機能マスタで「△」でない機能は、メーカーオプションマスタに登録できない
- 車両個体IDと車種グレードIDの関連付けが正しいこと

### **2. 「なし」の扱い**
- オプション種類が「なし」の場合は、装着有無は常にFALSE
- 「なし」は、オプションを一切装着していない車両を表す

### **3. 複数オプション装着の場合**
現在の設計では1車両1オプションですが、将来的に複数オプション装着が可能な場合は、以下のように拡張：

```csv
車両個体ID,車種グレードID,BSM装着,AHS装着,PVM装着,備考
VEH_010,CAR_001,TRUE,FALSE,FALSE,アクアG・BSM装着のみ
```

---

## 📊 マスタ間の関連図

```
┌─────────────────────┐
│  車両個体マスタ      │
│  ・車両個体ID       │
│  ・車種グレードID   │
│  ・ユーザーID       │
└──────┬──────────────┘
       │
       ├─────────────────────────────┐
       │                             │
       ▼                             ▼
┌─────────────────────┐    ┌─────────────────────┐
│ 車種機能マスタ       │    │ メーカーオプション   │
│ ・車種グレードID    │    │ マスタ              │
│ ・機能装備状況      │    │ ・車両個体ID        │
│   (○/△/×)         │    │ ・オプション種類     │
└─────────────────────┘    │ ・装着有無          │
                           └─────────────────────┘
                                     │
                                     ▼
                           ┌─────────────────────┐
                           │ 機能推奨ルール       │
                           │ マトリクス          │
                           │ ・推奨ロジック      │
                           └─────────────────────┘
```

---

## 🎉 まとめ

V2.1のメーカーオプションマスタ追加により、以下が実現できます：

✅ **正確な機能推奨** - オプション装備の有無に基づいた推奨  
✅ **セールス機会の創出** - 未装着ユーザーへの購入提案  
✅ **データの一貫性** - 車種機能マスタとの連携  
✅ **ユーザー満足度向上** - 装着していない機能を推奨しない

**これにより、より正確で価値のある機能推奨システムが完成しました！**

