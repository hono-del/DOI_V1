# トラブル対応優先度判定アルゴリズム 設計書

**作成日：** 2026年1月14日  
**バージョン：** 1.0

---

## 🎯 概要

車両トラブル発生時に、トラブルの種別、状況、ユーザー属性を考慮して、対応の優先度を判定し、最適な対応チャネルと対応時間を決定するアルゴリズムです。

---

## 📊 システム構成

### **1. 入力情報**

| カテゴリ | 情報 | 例 |
|---------|------|-----|
| **トラブル情報** | トラブル種別ID | TRB_001（エンジン始動不可） |
| **状況情報** | 状況ID（走行状態・時間帯・天候・場所等） | SIT_001（高速道路走行中） |
| **ユーザー情報** | ユーザー属性ID（年齢・契約プラン等） | USER_008（プレミアム会員） |

### **2. 判定プロセス**

```
┌─────────────────────────────────────┐
│ 1. トラブル種別の基本緊急性スコア  │
│    を取得                            │
└────────────┬────────────────────────┘
             │
┌────────────▼────────────────────────┐
│ 2. 状況による緊急度補正             │
│   （走行状態・時間帯・天候等）      │
└────────────┬────────────────────────┘
             │
┌────────────▼────────────────────────┐
│ 3. ユーザー属性による優先度補正     │
│   （高齢者・妊婦・プレミアム会員等）│
└────────────┬────────────────────────┘
             │
┌────────────▼────────────────────────┐
│ 4. 総合優先度スコアを計算           │
│    総合スコア = 基本スコア ×        │
│                 状況補正 ×          │
│                 ユーザー補正        │
└────────────┬────────────────────────┘
             │
┌────────────▼────────────────────────┐
│ 5. 優先度ランクを決定               │
│   ・最高（1.2以上）                 │
│   ・高（0.8～1.2未満）              │
│   ・中（0.5～0.8未満）              │
│   ・低（0.5未満）                   │
└────────────┬────────────────────────┘
             │
┌────────────▼────────────────────────┐
│ 6. 推奨対応時間と対応チャネルを決定 │
└─────────────────────────────────────┘
```

---

## 📋 優先度ランクと対応時間

| 優先度ランク | スコア範囲 | 対応時間 | 対応チャネル | 対象例 |
|------------|-----------|---------|------------|--------|
| **最高** | 1.2以上 | 即時～15分以内 | 緊急ロードサービス | 高速道路上の走行不能、妊婦・乳幼児同乗の重大トラブル |
| **高** | 0.8～1.2未満 | 20分～60分以内 | ロードサービス | パンク、警告灯点灯（走行中） |
| **中** | 0.5～0.8未満 | 1～3時間以内 | コールセンター | 警告灯点灯（停車中）、異音 |
| **低** | 0.5未満 | 当日～翌日 | コールセンター/チャット | 快適性の問題、軽微な不具合 |

---

## 🔢 スコア計算式

### **総合優先度スコア**

```
総合優先度スコア = 基本緊急性スコア × 状況補正 × ユーザー補正
```

### **各スコアの定義**

#### **1. 基本緊急性スコア（トラブル種別マスタ）**

| スコア | トラブル例 |
|--------|----------|
| **1.0** | 走行不能（エンジン停止、ブレーキ異常等） |
| **0.8～0.9** | 警告灯（エンジン、ブレーキ、燃料漏れ等） |
| **0.5～0.7** | 異音・振動、ADAS不良 |
| **0.3～0.4** | 快適性の問題（エアコン、パワーウィンドウ等） |

#### **2. 状況補正（状況マスタ）**

| 補正値 | 状況例 |
|--------|--------|
| **1.3～1.4** | 高速道路走行中、大雪、山間部 |
| **1.1～1.2** | 一般道走行中、夜間、雨、深夜、長距離移動中 |
| **0.9～1.0** | 市街地、日中、晴れ |
| **0.7** | 駐車中 |

#### **3. ユーザー補正（ユーザー属性マスタ）**

| 補正値 | ユーザー属性例 |
|--------|--------------|
| **1.3** | プレミアム会員 |
| **1.2～1.25** | 高齢者、妊婦、乳幼児同乗、子供同乗、法人車両 |
| **1.0** | スタンダード会員、通常ユーザー |
| **0.85～0.9** | ベーシック会員、レンタカー |

---

## 🎯 具体例

### **例1：高速道路でエンジン停止（最優先ケース）**

**シナリオ：**
- トラブル：走行中エンジン停止（TRB_002）
- 状況：高速道路走行中（SIT_001）
- ユーザー：妊婦（USER_017）

**計算：**
```
基本緊急性スコア: 1.0
状況補正: 1.3（高速道路）
ユーザー補正: 1.25（妊婦）

総合優先度スコア = 1.0 × 1.3 × 1.25 = 1.63
```

**判定結果：**
- 優先度ランク：**最高**
- 対応時間：**即時**
- 対応チャネル：**緊急ロードサービス**

---

### **例2：駐車中のエンジン警告灯（通常ケース）**

**シナリオ：**
- トラブル：エンジン警告灯（TRB_006）
- 状況：停車中（SIT_004）
- ユーザー：ベーシック会員（USER_010）

**計算：**
```
基本緊急性スコア: 0.8
状況補正: 0.9（停車中）
ユーザー補正: 0.9（ベーシック会員）

総合優先度スコア = 0.8 × 0.9 × 0.9 = 0.65
```

**判定結果：**
- 優先度ランク：**中**
- 対応時間：**2時間以内**
- 対応チャネル：**コールセンター**

---

### **例3：晴天時のエアコン不調（低優先ケース）**

**シナリオ：**
- トラブル：エアコン不調（TRB_019）
- 状況：晴れ（SIT_011）
- ユーザー：スタンダード会員（USER_009）

**計算：**
```
基本緊急性スコア: 0.3
状況補正: 0.9（晴れ）
ユーザー補正: 1.0（スタンダード会員）

総合優先度スコア = 0.3 × 0.9 × 1.0 = 0.27
```

**判定結果：**
- 優先度ランク：**低**
- 対応時間：**翌日可**
- 対応チャネル：**コールセンター**

---

## 🚨 特別優先ケース

以下の条件に該当する場合、スコアに関わらず最優先対応とする：

1. **走行不能かつ高速道路上**
2. **妊婦または乳幼児同乗かつ重大トラブル**
3. **ブレーキ・ステアリング異常**
4. **燃料漏れ（走行中）**
5. **プレミアム会員かつ深夜の重大トラブル**

---

## 📊 対応チャネル別の特徴

| チャネル | 対応時間 | コスト | 適用ケース |
|---------|---------|--------|----------|
| **緊急ロードサービス** | 即時～20分 | 高 | 走行不能、高速道路上、妊婦・乳幼児等 |
| **プレミアムロードサービス** | 即時～15分 | 最高 | プレミアム会員専用 |
| **ロードサービス** | 30分～60分 | 中 | 警告灯、パンク、異音等 |
| **コールセンター** | 1時間～翌日 | 低 | 快適性の問題、軽微な不具合 |
| **チャットサポート** | 即時～30分 | 低 | 簡単な質問、対処方法案内 |

---

## 🎯 運用上の考慮事項

### **1. 動的な優先度調整**
- 同時多発トラブル時の優先順位調整
- リソース（ロードサービス車両）の可用性考慮

### **2. エスカレーション**
- 対応遅延時の自動エスカレーション
- ユーザーからの再問合せ時の優先度上昇

### **3. 履歴管理**
- トラブル履歴による優先度補正
- 頻発ユーザーへの特別対応

---

## 📁 関連ファイル

| ファイル名 | 役割 |
|----------|------|
| `2-1_トラブル種別マスタ.csv` | トラブルの基本緊急性スコア定義 |
| `2-2_状況マスタ.csv` | 状況による緊急度補正定義 |
| `2-3_ユーザー属性マスタ.csv` | ユーザー属性による優先度補正定義 |
| `2-4_トラブル対応優先度マトリクス.csv` | 判定ルールと結果の定義 |
| `2-5_対応チャネルマスタ.csv` | 対応チャネルの定義 |
| `2-6_テストケース.csv` | アルゴリズムのテストケース |

---

## ✅ まとめ

このアルゴリズムにより：

1. ✅ **安全最優先**の対応判定
2. ✅ **状況に応じた柔軟な優先度調整**
3. ✅ **ユーザー特性を考慮した配慮**
4. ✅ **リソースの効率的な配分**
5. ✅ **透明性のある判定プロセス**

が実現されます。
