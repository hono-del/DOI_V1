# V2更新内容まとめ

**作成日：** 2026年1月14日  
**バージョン：** 2.0  
**最終更新：** 2026年1月14日（メーカーオプションマスタ追加）

---

## 🎯 V2での主な変更点

### **1. 機能推奨ルールマトリクス**

#### **追加列**
- **機能ID** - 機能詳細マスタとの紐付け（FN001～FN015）
- **操作特性** - 一度ONで継続/都度操作/操作不要
- **推奨ロジック** - 初回のみ推奨/定着促進推奨/毎回推奨/通知不要/推奨しない

#### **最終判定の変更**
- **旧：** 推奨/条件付き推奨/推奨しない
- **新：** 推奨/通知不要/推奨しない

**理由：** 「条件付き推奨」は曖昧なため、より明確な判定に変更

---

### **2. メッセージドキュメント（運転者/セールスマン/コールセンター）**

#### **追加列**
- **機能ID** - 機能詳細マスタとの紐付け
- **操作特性** - 機能の操作特性
- **推奨ロジック** - 推奨ロジックの種類

#### **メッセージの削減**
- **通知不要のルール** - メッセージから除外
  - 例：R003（ACC・中級者・マスター）
  - 例：R007（BSM・常時作動）
  - 例：R008（ICS・常時作動）
  - 例：R016（ACC・曇り高速・使い慣れている）
  - 例：R018（ACC・上級者・マスター）
  - 例：R019（BSM・夕方市街地・常時作動）
  - 例：R038（ACC・冬季高速・使い慣れている）

**理由：** 通知不要のルールにメッセージは不要

---

### **3. テストケース**

#### **追加列**
- **機能ID** - 機能詳細マスタとの紐付け
- **操作特性** - 機能の操作特性
- **推奨ロジック** - 推奨ロジックの種類

#### **最終判定の変更**
- **旧：** 推奨/条件付き推奨/推奨しない
- **新：** 推奨/通知不要/推奨しない

#### **テスト目的の明確化**
- 操作特性に応じた推奨ロジックの検証を追加

---

## 📊 V2で更新・追加したファイル一覧

| ファイル名 | 旧バージョン | 新バージョン | 主な変更点 |
|----------|------------|------------|----------|
| **機能推奨ルールマトリクス** | 1-7_機能推奨ルールマトリクス_完全版.csv | 1-7_機能推奨ルールマトリクス_v2.csv | 機能ID、操作特性、推奨ロジック追加 |
| **運転者向けメッセージ** | 1-8_運転者向けメッセージ.csv | 1-8_運転者向けメッセージ_v2.csv | 機能ID、操作特性、推奨ロジック追加、通知不要メッセージ削除 |
| **セールスマン向けメッセージ** | 1-9_セールスマン向けメッセージ.csv | 1-9_セールスマン向けメッセージ_v2.csv | 機能ID、操作特性、推奨ロジック追加、通知不要メッセージ削除 |
| **コールセンター向けメッセージ** | 1-10_コールセンター向けメッセージ.csv | 1-10_コールセンター向けメッセージ_v2.csv | 機能ID、操作特性、推奨ロジック追加、通知不要メッセージ削除 |
| **テストケース** | 1-11_テストケース.csv | 1-11_テストケース_v2.csv | 機能ID、操作特性、推奨ロジック追加、最終判定変更 |
| **メーカーオプションマスタ** | - | 1-12_メーカーオプションマスタ.csv | **新規追加**：オプション装備の装着状況を管理 |

---

### **🆕 V2.1での追加（メーカーオプションマスタ）**

#### **追加理由**
車種機能マスタで「△（オプション）」となっている機能について、各ユーザーの車両に実際に装着されているかを管理し、正確な機能推奨を行うため。

#### **マスタ構造**
- **車両個体ID** - 個別の車両を識別
- **車種グレードID** - 車種機能マスタとの紐付け
- **オプション種類** - BSM/AHS/PVM/なし
- **装着有無** - TRUE/FALSE
- **備考** - 補足情報

#### **装着可能なオプション**
| 車種グレードID | 車種名 | グレード | 装着可能オプション |
|-------------|--------|---------|-----------------|
| CAR_001 | アクア | G | BSM |
| CAR_002 | アクア | Z | AHS |
| CAR_007 | クラウン | RS | PVM |

#### **推奨判定への影響**
```
車種機能マスタで装備状況確認
↓
○（標準装備）→ 推奨ロジックへ
△（オプション）→ メーカーオプションマスタで装着確認
                ↓
                TRUE（装着あり）→ 推奨ロジックへ
                FALSE（装着なし）→ 推奨しない
×（装備なし）→ 推奨しない
```

---

## 🔄 V1とV2の比較

### **機能推奨ルールマトリクス**

#### **V1（旧）**
```csv
ルールID,道路種別ID,季節ID,天気環境ID,時間帯ID,速度交通量ID,知識レベルID,使用経験ID,必要機能,推奨機能,機能カテゴリ,基本安全スコア,補正後安全スコア,基本優先度スコア,総合優先度スコア,最終判定,優先度ランク,備考
R001,ROAD_001,SEASON_001,WEATHER_001,TIME_003,SPEED_001,LEVEL_001,EXP_001,ACC,渋滞追従,運転支援,0.90,0.90,0.46,0.72,推奨,高,低速で安全に練習可能
```

#### **V2（新）**
```csv
ルールID,道路種別ID,季節ID,天気環境ID,時間帯ID,速度交通量ID,知識レベルID,使用経験ID,機能ID,推奨機能,機能カテゴリ,操作特性,推奨ロジック,基本安全スコア,補正後安全スコア,基本優先度スコア,総合優先度スコア,最終判定,優先度ランク,備考
R001,ROAD_001,SEASON_001,WEATHER_001,TIME_003,SPEED_001,LEVEL_001,EXP_001,FN001,ACC,運転支援,一度ONで継続,初回のみ推奨,0.90,0.90,0.46,0.72,推奨,高,低速で安全に練習可能・習得後は自主的に使用
```

**追加：** 機能ID、操作特性、推奨ロジック

---

### **運転者向けメッセージ**

#### **V1（旧）**
```csv
メッセージID,ルールID,推奨機能,機能カテゴリ,シーン説明,メッセージテンプレート,チャネル,優先度
MSG_DRIVER_001,R001,渋滞追従,運転支援,渋滞時・初心者・未使用,渋滞が始まりました。渋滞追従機能を使うと、ブレーキとアクセルの操作が自動化され、疲労が軽減されます。低速で安全に練習できます。試してみますか？,音声+画面,高
MSG_DRIVER_003,R018,ACC,運転支援,高速道路・上級者・マスター,ACC利用可能です,画面のみ,低
```

#### **V2（新）**
```csv
メッセージID,ルールID,機能ID,推奨機能,機能カテゴリ,操作特性,推奨ロジック,シーン説明,メッセージテンプレート,チャネル,優先度
MSG_DRIVER_001,R001,FN001,ACC,運転支援,一度ONで継続,初回のみ推奨,渋滞時・初心者・未使用,渋滞が始まりました。渋滞追従機能を使うと、ブレーキとアクセルの操作が自動化され、疲労が軽減されます。低速で安全に練習できます。試してみますか？,音声+画面,高
```

**追加：** 機能ID、操作特性、推奨ロジック  
**削除：** MSG_DRIVER_003（R018は通知不要のため）

---

### **テストケース**

#### **V1（旧）**
```csv
テストケースID,ルールID,道路種別ID,季節ID,天気環境ID,時間帯ID,速度交通量ID,知識レベルID,使用経験ID,期待される推奨機能,期待される最終判定,期待される優先度ランク,テスト目的
TEST_001,R001,ROAD_001,SEASON_001,WEATHER_001,TIME_003,SPEED_001,LEVEL_001,EXP_001,渋滞追従,推奨,高,初心者が渋滞時に安全に練習できることを確認
TEST_003,R003,ROAD_002,SEASON_001,WEATHER_001,TIME_003,SPEED_005,LEVEL_002,EXP_004,ACC,条件付き推奨,中,経験者には高速でも推奨できることを確認
```

#### **V2（新）**
```csv
テストケースID,ルールID,機能ID,道路種別ID,季節ID,天気環境ID,時間帯ID,速度交通量ID,知識レベルID,使用経験ID,操作特性,推奨ロジック,期待される推奨機能,期待される最終判定,期待される優先度ランク,テスト目的
TEST_001,R001,FN001,ROAD_001,SEASON_001,WEATHER_001,TIME_003,SPEED_001,LEVEL_001,EXP_001,一度ONで継続,初回のみ推奨,ACC,推奨,高,初心者が渋滞時に安全に練習できることを確認
TEST_003,R003,FN001,ROAD_002,SEASON_001,WEATHER_001,TIME_003,SPEED_005,LEVEL_002,EXP_004,一度ONで継続,通知不要,ACC,通知不要,中,経験者は自主的に使用するため通知不要を確認
```

**追加：** 機能ID、操作特性、推奨ロジック  
**変更：** TEST_003の最終判定が「条件付き推奨」→「通知不要」

---

## 📋 推奨ロジック別のルール数

| 推奨ロジック | ルール数 | 該当ルール |
|------------|---------|----------|
| **初回のみ推奨** | 11 | R001, R005, R009, R010, R031, R032, R033 など |
| **定着促進推奨** | 1 | R026 |
| **毎回推奨** | 16 | R004, R006, R012, R013, R015, R017, R020, R021, R022, R023, R027, R028, R029, R030, R036, R037 |
| **通知不要** | 7 | R003, R007, R008, R016, R018, R019, R038 |
| **推奨しない** | 3 | R002, R011, R024, R025, R034, R035 |

---

## 🎯 V2のメリット

### **1. 通知の価値を最大化**
- 一度ONで継続する機能：初回のみ通知し、習得後は通知しない
- 都度操作が必要な機能：毎回通知する価値がある
- 操作不要の機能：通知不要

### **2. 通知疲れを防ぐ**
- 既に習得した機能は通知しない
- 常時作動している機能は通知しない
- 知識レベルに応じてメッセージを簡潔化

### **3. データの一貫性向上**
- 機能IDで機能詳細マスタと紐付け
- 操作特性と推奨ロジックを明示
- 最終判定を明確化（条件付き推奨→推奨/通知不要）

### **4. メンテナンス性向上**
- 機能の追加・変更時に機能詳細マスタを更新すれば、ルールマトリクスにも反映
- 推奨ロジックが明確なため、ルールの追加・変更が容易

---

## 📝 次のステップ

### **1. Excelへの変換**
- 各CSVファイルをExcelに変換
- 書式設定（ヘッダー色、列幅調整、枠線など）

### **2. 動作検証**
- テストケースを使用して、推奨ロジックが正しく動作するか検証
- 特に「通知不要」のルールが正しく除外されているか確認

### **3. メッセージの最適化**
- 知識レベルに応じたメッセージの簡潔化
- 使用経験に応じたメッセージのバリエーション追加

### **4. 残り4つのアルゴリズム設計**
- トラブル対応の優先度判定
- 情報提示レベル調整
- コミュニケーションチャネル選択
- 学習コンテンツ推奨

---

**V2により、機能の操作特性に応じた適切な推奨ロジックを実装し、ユーザーにとって価値のある通知のみを行うシステムが完成しました！**

