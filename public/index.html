<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¹ãƒãƒ›ã‚¢ãƒ—ãƒª - ãƒ›ãƒ¼ãƒ ç”»é¢ï¼ˆã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: #1A1A1A;
            color: #ffffff;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .mobile-frame {
            max-width: 375px;
            width: 100%;
            margin: 0 auto;
            border: 8px solid #2A2A2A;
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8), 0 0 20px rgba(191, 0, 255, 0.3);
            position: relative;
            background: #1A1A1A;
            display: flex;
            flex-direction: column;
            height: 700px;
        }

        .mobile-header {
            flex-shrink: 0;
            background: #1A1A1A;
            color: #BF00FF;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(191, 0, 255, 0.3);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .mobile-header h2 {
            font-size: 1.1em;
            font-weight: 600;
        }

        .mobile-content {
            flex: 1;
            min-height: 0;
            padding: 20px;
            padding-bottom: 20px;
            background: #1A1A1A;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .mobile-content::-webkit-scrollbar {
            width: 6px;
        }

        .mobile-content::-webkit-scrollbar-track {
            background: #1a1a2e;
        }

        .mobile-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #BF00FF 0%, #D200FF 100%);
            border-radius: 3px;
        }

        .mobile-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #D200FF 0%, #BF00FF 100%);
        }

        .view-screen {
            flex: 1;
            min-height: 0;
            padding: 20px;
            overflow-y: auto;
            background: #1A1A1A;
            display: none;
        }
        .view-screen.active { display: block; }

        .login-form input, .vehicle-select input[type="text"] {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 14px;
            border: 1px solid rgba(191, 0, 255, 0.3);
            border-radius: 10px;
            background: #202020;
            color: #e0e0e0;
            font-size: 1em;
        }
        .login-form input::placeholder { color: #808080; }
        .login-form label { display: block; margin-bottom: 6px; font-size: 0.9em; color: #aaa; }
        .login-form .button { width: 100%; margin-top: 16px; padding: 14px; }

        .vehicle-model-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
            margin-bottom: 20px;
        }
        .vehicle-model-card {
            background: #202020;
            border: 2px solid rgba(191, 0, 255, 0.3);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .vehicle-model-card:hover, .vehicle-model-card.selected {
            border-color: #BF00FF;
            box-shadow: 0 0 16px rgba(191, 0, 255, 0.3);
        }
        .vehicle-model-card img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            display: block;
        }
        .vehicle-model-card .label { padding: 10px; font-weight: 600; color: #BF00FF; font-size: 0.95em; }
        .vehicle-year-list { margin-top: 16px; }
        .vehicle-year-item {
            background: #202020;
            border: 1px solid rgba(191, 0, 255, 0.3);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 10px;
            cursor: pointer;
            text-align: center;
            color: #e0e0e0;
            transition: all 0.2s;
        }
        .vehicle-year-item:hover { background: rgba(191, 0, 255, 0.15); border-color: #BF00FF; }

        .settings-menu { display: flex; flex-direction: column; gap: 12px; }
        .settings-menu-btn {
            width: 100%;
            padding: 16px 18px;
            text-align: left;
            background: #202020;
            border: 1px solid rgba(191, 0, 255, 0.3);
            border-radius: 12px;
            color: #e0e0e0;
            font-size: 1em;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
        }
        .settings-menu-btn:hover { background: rgba(191, 0, 255, 0.15); border-color: #BF00FF; }
        .settings-menu-btn span { font-size: 1.2em; }
        .language-options { margin-top: 12px; }
        .language-option {
            background: #202020;
            border: 1px solid rgba(191, 0, 255, 0.3);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 10px;
            cursor: pointer;
            text-align: center;
            color: #e0e0e0;
            transition: all 0.2s;
        }
        .language-option:hover, .language-option.selected { background: rgba(191, 0, 255, 0.15); border-color: #BF00FF; }

        .search-box {
            background: #202020;
            border: 1px solid rgba(191, 0, 255, 0.3);
            border-radius: 25px;
            padding: 12px 20px;
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.4),
                -4px -4px 8px rgba(255, 255, 255, 0.05),
                inset 2px 2px 4px rgba(0, 0, 0, 0.3),
                inset -2px -2px 4px rgba(191, 0, 255, 0.1);
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 1em;
            margin-left: 10px;
            background: transparent;
            color: #e0e0e0;
        }

        .search-box input::placeholder {
            color: #808080;
        }

        .card {
            background: #202020;
            border: 1px solid rgba(191, 0, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.4),
                -4px -4px 8px rgba(255, 255, 255, 0.05),
                inset 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .card-title {
            font-weight: 600;
            color: #BF00FF;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .card-content {
            color: #e0e0e0;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .alert-card {
            background: #202020;
            border: 1px solid rgba(255, 107, 107, 0.5);
            border-left: 5px solid #ff6b6b;
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.4),
                -4px -4px 8px rgba(255, 255, 255, 0.05),
                inset 1px 1px 2px rgba(0, 0, 0, 0.2),
                0 0 15px rgba(255, 107, 107, 0.2);
        }

        .alert-card .card-title {
            color: #ff6b6b;
            display: flex;
            align-items: center;
        }

        .alert-card .card-content {
            color: #e0e0e0;
        }

        .button {
            background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%);
            color: #ffffff;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            display: inline-block;
            box-shadow: 0 4px 8px rgba(191, 0, 255, 0.4), 0 0 15px rgba(191, 0, 255, 0.2);
            transition: all 0.3s;
        }

        .button:hover {
            background: linear-gradient(135deg, #D200FF 0%, #BF00FF 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(191, 0, 255, 0.6), 0 0 20px rgba(191, 0, 255, 0.3);
        }

        #feedbackSection button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }

        #feedbackSection button:active {
            transform: translateY(0) scale(1);
        }

        .chat-message {
            margin-bottom: 15px;
        }

        .chat-message.user {
            text-align: right;
        }

        .chat-bubble {
            display: inline-block;
            padding: 12px 16px;
            border-radius: 18px;
            max-width: 90%;
            word-wrap: break-word;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .chat-bubble.user {
            background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%);
            color: #ffffff;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(191, 0, 255, 0.4), 0 0 10px rgba(191, 0, 255, 0.2);
        }

        .chat-bubble.ai {
            background: #202020;
            color: #e0e0e0;
            border: 1px solid rgba(191, 0, 255, 0.3);
            box-shadow: 
                4px 4px 8px rgba(0, 0, 0, 0.4),
                -4px -4px 8px rgba(255, 255, 255, 0.05);
        }

        /* ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ—ãƒ©ã‚¤ï¼ˆãƒãƒ£ãƒƒãƒˆç”¨ï¼‰ */
        .quick-reply-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .quick-reply {
            background: rgba(191, 0, 255, 0.1);
            color: #BF00FF;
            padding: 8px 14px;
            border-radius: 18px;
            font-size: 0.85em;
            cursor: pointer;
            border: 1px solid rgba(191, 0, 255, 0.4);
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .quick-reply:hover {
            background: rgba(191, 0, 255, 0.2);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(191, 0, 255, 0.4), 0 0 10px rgba(191, 0, 255, 0.2);
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            margin-right: 5px;
        }

        .badge-new {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(255, 107, 107, 0.3);
        }

        .badge-info {
            background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%);
            color: #ffffff;
            box-shadow: 0 2px 4px rgba(191, 0, 255, 0.4);
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(191, 0, 255, 0.2);
            color: #b0b0b0;
            transition: all 0.3s;
        }

        .feature-list li:hover {
            color: #BF00FF;
            padding-left: 5px;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .feature-list li::before {
            content: "âœ“";
            color: #BF00FF;
            font-weight: bold;
            margin-right: 10px;
        }

        .search-button {
            background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%);
            color: #ffffff;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            margin-left: 10px;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(191, 0, 255, 0.4), 0 0 15px rgba(191, 0, 255, 0.2);
            transition: all 0.3s;
        }

        .search-button:hover {
            background: linear-gradient(135deg, #D200FF 0%, #BF00FF 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(191, 0, 255, 0.6), 0 0 20px rgba(191, 0, 255, 0.3);
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .quick-question {
            display: inline-block;
            background: #202020;
            border: 2px solid rgba(191, 0, 255, 0.5);
            color: #BF00FF;
            padding: 8px 15px;
            border-radius: 20px;
            margin: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
            box-shadow: 
                2px 2px 4px rgba(0, 0, 0, 0.3),
                -2px -2px 4px rgba(255, 255, 255, 0.05);
        }

        .quick-question:hover {
            background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%);
            color: #ffffff;
            border-color: #BF00FF;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(191, 0, 255, 0.5), 0 0 15px rgba(191, 0, 255, 0.3);
        }

        .search-input-wrapper {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .search-input-wrapper input {
            flex: 1;
        }

        .mobile-tab-bar {
            flex-shrink: 0;
            background: #1A1A1A;
            border-top: 2px solid rgba(191, 0, 255, 0.3);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px 0;
            color: #888;
            font-size: 0.85em;
        }

        .tab-item:hover {
            color: #BF00FF;
            transform: translateY(-2px);
        }

        .tab-item.active {
            color: #BF00FF;
        }

        .tab-item .tab-icon {
            font-size: 1.5em;
            margin-bottom: 4px;
        }

        .tab-item.active .tab-icon {
            animation: tabBounce 0.5s ease;
        }

        @keyframes tabBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .tab-item .notification-badge {
            position: relative;
        }

        .tab-item .notification-badge::after {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            background: #ff6b6b;
            border-radius: 50%;
            border: 2px solid #16213e;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            to {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="mobile-frame">
                    <div class="mobile-header">
                        <h2 id="headerTitle" data-i18n="app-title">DIGITAL OM</h2>
                        <span id="headerBackBtn" style="display:none; cursor:pointer; font-size:1.1em;" onclick="showScreen('home')" title="æˆ»ã‚‹" data-i18n="btn-back">â† æˆ»ã‚‹</span>
                        <span id="headerSettingsBtn" style="display:none; cursor:pointer; font-size:1.2em; user-select:none;" onclick="showScreen('settings')" data-i18n="btn-settings" title="è¨­å®š">âš™ï¸</span>
                    </div>
                    <!-- â‘ ID/PWãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ -->
                    <div id="loginScreen" class="view-screen active">
                        <div style="margin-bottom: 24px; font-size: 1.1em; color: #BF00FF;" data-i18n="screen-login">ãƒ­ã‚°ã‚¤ãƒ³</div>
                        <form class="login-form" onsubmit="handleLogin(event)">
                            <label for="loginId" data-i18n="label-id">ID</label>
                            <input type="text" id="loginId" placeholder="IDã‚’å…¥åŠ›" data-i18n-placeholder="placeholder-id" autocomplete="username">
                            <label for="loginPw" data-i18n="label-password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
                            <input type="password" id="loginPw" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" data-i18n-placeholder="placeholder-password" autocomplete="current-password">
                            <button type="submit" class="button" data-i18n="btn-login">ãƒ­ã‚°ã‚¤ãƒ³</button>
                        </form>
                    </div>
                    <!-- â‘¡è»Šç¨®é¸æŠç”»é¢ -->
                    <div id="vehicleSelectScreen" class="view-screen">
                        <div style="margin-bottom: 16px; font-size: 1.1em; color: #BF00FF;" data-i18n="screen-vehicle-select">è»Šç¨®ã‚’é¸æŠ</div>
                        <div id="vehicleModelStep">
                            <div class="vehicle-model-grid">
                                <div class="vehicle-model-card" data-model="G" onclick="selectModel('G')">
                                    <img src="./images/ã‚°ãƒ¬ãƒ¼SUV_èƒŒæ™¯é»’.png" alt="Model G">
                                    <div class="label">Model G</div>
                                </div>
                                <div class="vehicle-model-card" data-model="B" onclick="selectModel('B')">
                                    <img src="./images/ãƒ–ãƒ«ãƒ¼ã‚»ãƒ€ãƒ³.png" alt="Model B">
                                    <div class="label">Model B</div>
                                </div>
                            </div>
                        </div>
                        <div id="vehicleYearStep" style="display: none;">
                            <button type="button" class="button" style="background:#333; margin-bottom:14px; font-size:0.9em;" onclick="document.getElementById('vehicleYearStep').style.display='none'; document.getElementById('vehicleModelStep').style.display='block';" data-i18n="btn-back-to-model">â† è»Šç¨®ã‚’é¸ã³ç›´ã™</button>
                            <div style="margin-bottom: 10px; color: #aaa;" data-i18n="screen-vehicle-year">å¹´å¼ã‚’é¸æŠ</div>
                            <div class="vehicle-year-list">
                                <div class="vehicle-year-item" onclick="selectYear('2025-06')">2025å¹´6æœˆç™ºå£²</div>
                                <div class="vehicle-year-item" onclick="selectYear('2024-11')">2024å¹´11æœˆç™ºå£²</div>
                                <div class="vehicle-year-item" onclick="selectYear('2023-04')">2023å¹´4æœˆç™ºå£²</div>
                            </div>
                        </div>
                    </div>
                    <!-- â‘¢è¨­å®šç”»é¢ï¼ˆãƒ›ãƒ¼ãƒ ã‹ã‚‰âš™ã§é·ç§»ï¼‰ -->
                    <div id="settingsScreen" class="view-screen">
                        <div style="margin-bottom: 20px; font-size: 1.1em; color: #BF00FF;" data-i18n="screen-settings">è¨­å®š</div>
                        <div class="settings-menu">
                            <button type="button" class="settings-menu-btn" onclick="openLanguageSettings()">
                                <span>ğŸŒ</span> <span data-i18n="menu-language">è¨€èªè¨­å®š</span>
                            </button>
                            <button type="button" class="settings-menu-btn" onclick="goToVehicleSelect()">
                                <span>ğŸš—</span> <span data-i18n="menu-vehicle">è»Šä¸¡é¸æŠ</span>
                            </button>
                            <a href="oem-dashboard.html" target="_blank" rel="noopener" class="settings-menu-btn" style="display: block; text-align: left; text-decoration: none; color: inherit;">
                                <span>ğŸ“Š</span> <span data-i18n="menu-dashboard">ç®¡ç†è€…å‘ã‘ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
                            </a>
                        </div>
                        <!-- è¨€èªé¸æŠã‚µãƒ–ç”»é¢ -->
                        <div id="languageSelectPanel" style="display: none; margin-top: 20px;">
                            <button type="button" class="button" style="background:#333; margin-bottom:14px; font-size:0.9em;" onclick="closeLanguageSettings()" data-i18n="btn-back-to-settings">â† è¨­å®šã«æˆ»ã‚‹</button>
                            <div style="margin-bottom: 10px; color: #aaa;" data-i18n="language-select-title">è¡¨ç¤ºè¨€èªã‚’é¸æŠ</div>
                            <div class="language-options">
                                <div class="language-option selected" data-lang="ja" onclick="selectLanguage('ja')">æ—¥æœ¬èª</div>
                                <div class="language-option" data-lang="en" onclick="selectLanguage('en')">English</div>
                                <div class="language-option" data-lang="fr" onclick="selectLanguage('fr')">FranÃ§ais</div>
                                <div class="language-option" data-lang="es" onclick="selectLanguage('es')">EspaÃ±ol</div>
                            </div>
                        </div>
                    </div>
                    <div class="mobile-content" id="homeContent" style="display: none;">
                        <!-- æ¤œç´¢çµæœã‚¨ãƒªã‚¢ -->
                        <div id="searchResult" class="hidden"></div>

                        <!-- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
                        <div id="defaultContent">
                            <!-- 1. ä»Šã™ãç¢ºèªï¼ˆæœ€ä¸Šéƒ¨ï¼‰- ãƒ©ãƒ³ãƒ€ãƒ è¡¨ç¤º -->
                            <div class="card alert-card" id="alertCard">
                                <div class="card-title" id="alertCardTitle">
                                    <span>âš ï¸</span> <span data-i18n="alert-title">ä»Šã™ãç¢ºèª</span>
                                </div>
                                <div class="card-content" id="alertContent">
                                    <!-- JavaScriptã§å‹•çš„ã«è¡¨ç¤º -->
                                </div>
                            </div>

                            <!-- 2. è»Šä¸¡ç”»åƒï¼ˆè»Šç¨®é¸æŠã§è¨­å®šï¼‰ -->
                            <div class="card" style="padding: 0; overflow: hidden; margin-bottom: 20px;">
                                <img id="homeVehicleImage" src="./images/ã‚°ãƒ¬ãƒ¼SUV_èƒŒæ™¯é»’.png"
                                     alt="ã‚ãªãŸã®è»Šä¸¡"
                                     style="width: 100%; height: auto; display: block;"
                                     onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 800 500%27%3E%3Crect fill=%27%23e0e0e0%27 width=%27800%27 height=%27500%27/%3E%3Ctext x=%27400%27 y=%27250%27 text-anchor=%27middle%27 font-size=%2724%27 fill=%27%23666%27 font-family=%27Arial%27%3EğŸš— ã‚ãªãŸã®è»Šä¸¡%3C/text%3E%3C/svg%3E'">
                            </div>

                            <!-- 3. æ¤œç´¢ã‚¨ãƒªã‚¢ -->
                            <div class="search-input-wrapper">
                                <div class="search-box" style="flex: 1; margin-bottom: 0;">
                                    <span>ğŸ”</span>
                                    <input type="text" id="searchInput" placeholder="æ“ä½œæ–¹æ³•ã‚„æ©Ÿèƒ½ã‚’æ¤œç´¢..." data-i18n-placeholder="search-placeholder">
                                </div>
                                <button class="search-button" onclick="performSearch()" data-i18n="btn-search">æ¤œç´¢</button>
                            </div>

                            <!-- ã‚¯ã‚¤ãƒƒã‚¯è³ªå•ãƒœã‚¿ãƒ³ -->
                            <div style="margin-bottom: 20px; text-align: center;">
                                <div style="font-size: 0.9em; color: #666; margin-bottom: 10px;" data-i18n="quick-question-label">ã‚ˆãã‚ã‚‹è³ªå•ã‚’ã‚¿ãƒƒãƒ—:</div>
                                <span class="quick-question" onclick="setQuestion('ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„')">ğŸšª <span data-i18n="quick-door">ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„</span></span>
                                <span class="quick-question" onclick="setQuestion('Bluetoothæ¥ç¶šã¯ã©ã†ã‚„ã£ã¦ã‚„ã‚‹ã®ï¼Ÿ')">ğŸ“± <span data-i18n="quick-bluetooth">Bluetoothæ¥ç¶š</span></span>
                                <span class="quick-question" onclick="setQuestion('è­¦å‘Šç¯ãŒç‚¹ç¯ã—ãŸ')">âš ï¸ <span data-i18n="quick-warning">è­¦å‘Šç¯ãŒç‚¹ç¯</span></span>
                            </div>

                            <!-- 4. ãŠã™ã™ã‚æ©Ÿèƒ½ -->
                            <div class="card" id="recommendationCard">
                                <div class="card-title">
                                    <span class="badge badge-new" data-i18n="badge-new">NEW</span> <span data-i18n="card-recommendation">ãŠã™ã™ã‚æ©Ÿèƒ½</span>
                                </div>
                                <div class="card-content" id="recommendationContent">
                                    <div id="recommendationText" data-i18n="recommendation-seat-heater">ã‚·ãƒ¼ãƒˆãƒ’ãƒ¼ã‚¿ãƒ¼æ©Ÿèƒ½ã‚’ã¾ã ä½¿ã£ã¦ã„ã¾ã›ã‚“ã­ã€‚å†¬ã«ä¾¿åˆ©ãªæ©Ÿèƒ½ã§ã™ã€‚</div>
                                    <div style="display: flex; gap: 10px; margin-top: 12px; align-items: center; flex-wrap: wrap;">
                                        <a href="https://www.youtube.com/shorts/-rbaCNJrUc0" target="_blank" class="button" style="text-decoration: none; display: inline-block; flex: 1; min-width: 140px;">
                                            ğŸ¥ <span data-i18n="btn-watch-video">ä½¿ã„æ–¹ã‚’è¦‹ã‚‹</span>
                                        </a>
                                        <button onclick="showNextRecommendation()" class="button" style="background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px 18px; flex: 0;">
                                            âœ…
                                        </button>
                                        <button onclick="showRecommendationFeedback()" class="button" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px 18px; flex: 0;">
                                            ğŸ˜’
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 5. ã‚ˆãã‚ã‚‹è³ªå• -->
                            <div class="card">
                                <div class="card-title" data-i18n="card-faq">ã‚ˆãã‚ã‚‹è³ªå•</div>
                                <div class="card-content">
                                    <ul class="feature-list">
                                        <li data-i18n="faq-bluetooth">Bluetoothæ¥ç¶šã®è¨­å®šæ–¹æ³•</li>
                                        <li data-i18n="faq-aircon">ã‚¨ã‚¢ã‚³ãƒ³ã®ä½¿ã„æ–¹</li>
                                        <li data-i18n="faq-wiper">ãƒ¯ã‚¤ãƒ‘ãƒ¼ã®æ“ä½œæ–¹æ³•</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å›ºå®šã‚¿ãƒ–ãƒãƒ¼ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãƒ»è»Šç¨®é¸æŠå¾Œè¡¨ç¤ºï¼‰ -->
                    <div id="mainTabBar" class="mobile-tab-bar" style="position:relative;z-index:9999;flex-shrink:0; display: none;">
                        <div class="tab-item active" data-tab="home" onclick="typeof switchTab==='function'&&switchTab('home',event)">
                            <div class="tab-icon">ğŸ </div>
                            <div data-i18n="tab-home">ãƒ›ãƒ¼ãƒ </div>
                        </div>
                        <div class="tab-item" data-tab="chat" onclick="typeof switchTab==='function'&&switchTab('chat',event)">
                            <div class="tab-icon">ğŸ’¬</div>
                            <div data-i18n="tab-chat">ãƒãƒ£ãƒƒãƒˆ</div>
                        </div>
                        <div class="tab-item" data-tab="notification" onclick="typeof switchTab==='function'&&switchTab('notification',event)">
                            <div class="tab-icon notification-badge">ğŸ””</div>
                            <div data-i18n="tab-notification">é€šçŸ¥</div>
                        </div>
                        <div class="tab-item" data-tab="status" onclick="typeof switchTab==='function'&&switchTab('status',event)">
                            <div class="tab-icon">ğŸ“Š</div>
                            <div data-i18n="tab-status">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div>
                        </div>
                    </div>
                    <!-- Bluetoothã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« -->
                    <div id="bluetoothStepGuideModal" style="display: none; position: absolute; inset: 0; background: rgba(0,0,0,0.92); z-index: 9000; overflow-y: auto; padding: 15px;">
                        <div id="bluetoothStepGuideContent"></div>
                    </div>
                </div>
    </div>

    <!-- æ•‘æ¸ˆ: ä»Šã™ãç¢ºèªã¨ã‚¿ãƒ–ã‚’ç¢ºå®Ÿã«è¡¨ç¤ºï¼ˆãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚ˆã‚Šå…ˆã«å®Ÿè¡Œï¼‰ -->
    <script>
(function(){
  function fix(){
    try{
      var t=document.getElementById('alertCardTitle');
      if(t)t.innerHTML='<span>\u26a0\ufe0f</span> ä»Šã™ãç¢ºèª';
      var d=document.getElementById('defaultContent');
      if(d)d.classList.remove('hidden');
      var s=document.getElementById('searchResult');
      if(s&&!s.querySelector('.chat-message'))s.classList.add('hidden');
    }catch(e){}
  }
  if(document.readyState==='loading')document.addEventListener('DOMContentLoaded',fix);
  else fix();
  setTimeout(fix,50);
})();
    </script>
    <script>
        // å¤šè¨€èªå¯¾å¿œã‚·ã‚¹ãƒ†ãƒ 
        var currentLang = 'ja';
        var translations = {
            ja: {
                'app-title': 'DIGITAL OM',
                'btn-back': 'æˆ»ã‚‹',
                'btn-settings': 'è¨­å®š',
                'screen-login': 'ãƒ­ã‚°ã‚¤ãƒ³',
                'label-id': 'ID',
                'label-password': 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',
                'placeholder-id': 'IDã‚’å…¥åŠ›',
                'placeholder-password': 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›',
                'btn-login': 'ãƒ­ã‚°ã‚¤ãƒ³',
                'screen-vehicle-select': 'è»Šç¨®ã‚’é¸æŠ',
                'screen-vehicle-year': 'å¹´å¼ã‚’é¸æŠ',
                'btn-back-to-model': 'â† è»Šç¨®ã‚’é¸ã³ç›´ã™',
                'screen-settings': 'è¨­å®š',
                'menu-language': 'è¨€èªè¨­å®š',
                'menu-vehicle': 'è»Šä¸¡é¸æŠ',
                'menu-dashboard': 'ç®¡ç†è€…å‘ã‘ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',
                'language-select-title': 'è¡¨ç¤ºè¨€èªã‚’é¸æŠ',
                'btn-back-to-settings': 'â† è¨­å®šã«æˆ»ã‚‹',
                'alert-title': 'ä»Šã™ãç¢ºèª',
                'search-placeholder': 'æ“ä½œæ–¹æ³•ã‚„æ©Ÿèƒ½ã‚’æ¤œç´¢...',
                'btn-search': 'æ¤œç´¢',
                'quick-question-label': 'ã‚ˆãã‚ã‚‹è³ªå•ã‚’ã‚¿ãƒƒãƒ—:',
                'quick-door': 'ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„',
                'quick-bluetooth': 'Bluetoothæ¥ç¶š',
                'quick-warning': 'è­¦å‘Šç¯ãŒç‚¹ç¯',
                'card-recommendation': 'ãŠã™ã™ã‚æ©Ÿèƒ½',
                'badge-new': 'NEW',
                'btn-watch-video': 'ä½¿ã„æ–¹ã‚’è¦‹ã‚‹',
                'card-faq': 'ã‚ˆãã‚ã‚‹è³ªå•',
                'tab-home': 'ãƒ›ãƒ¼ãƒ ',
                'tab-chat': 'ãƒãƒ£ãƒƒãƒˆ',
                'tab-notification': 'é€šçŸ¥',
                'tab-status': 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹',
                'chat-placeholder': 'ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã‚„ã‚¯ãƒ«ãƒã«ã¤ã„ã¦è³ªå•ã§ãã¾ã™...',
                'btn-send': 'é€ä¿¡',
                // å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”¨
                'recommendation-seat-heater': 'ã‚·ãƒ¼ãƒˆãƒ’ãƒ¼ã‚¿ãƒ¼æ©Ÿèƒ½ã‚’ã¾ã ä½¿ã£ã¦ã„ã¾ã›ã‚“ã­ã€‚å†¬ã«ä¾¿åˆ©ãªæ©Ÿèƒ½ã§ã™ã€‚',
                'faq-bluetooth': 'Bluetoothæ¥ç¶šã®è¨­å®šæ–¹æ³•',
                'faq-aircon': 'ã‚¨ã‚¢ã‚³ãƒ³ã®ä½¿ã„æ–¹',
                'faq-wiper': 'ãƒ¯ã‚¤ãƒ‘ãƒ¼ã®æ“ä½œæ–¹æ³•',
                'chat-intro-name': 'ã•ã‚“ã€ä»ŠçŸ¥ã‚ŠãŸã„ã“ã¨ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
                'chat-intro-quick': 'ã™ãã«è©¦ã›ã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚‚ã”ç”¨æ„ã—ã¦ã„ã¾ã™ï¼š',
                'chat-quick-door': 'ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„',
                'chat-quick-battery': 'ã‚­ãƒ¼é›»æ± åˆ‡ã‚Œã®è¡¨ç¤ºãŒå‡ºã¦ã„ã‚‹',
                'chat-quick-warning': 'è­¦å‘Šç¯ãŒç‚¹ç¯',
                // é€šçŸ¥
                'notif-title': 'é€šçŸ¥å±¥æ­´',
                'notif-feedback': 'ä»¥ä¸‹ã®é€šçŸ¥ãŒå½¹ã«ç«‹ã¡ã¾ã—ãŸã‹ï¼Ÿãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚',
                'notif-helpful': 'å½¹ç«‹ã£ãŸ',
                'notif-not-helpful': 'å½¹ç«‹ãŸãªã‹ã£ãŸ',
                'notif-time-minutes': 'åˆ†å‰',
                'notif-time-hours': 'æ™‚é–“å‰',
                'notif-time-yesterday': 'æ˜¨æ—¥',
                'notif-time-days': 'æ—¥å‰',
                'notif-1': 'å¤œé–“èµ°è¡Œä¸­ã§ã™ã€‚ã‚ªãƒ¼ãƒˆãƒã‚¤ãƒ“ãƒ¼ãƒ ã‚’ã‚ªãƒ³ã«ã™ã‚‹ã¨å®‰å…¨ã§ã™ã€‚',
                'notif-2': 'ç‹­ã„é§è»Šå ´ã§ã™ã€‚ãƒ‘ãƒãƒ©ãƒŸãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚’ä½¿ã†ã¨å®‰å¿ƒã§ã™ã€‚',
                'notif-3': 'å¸‚è¡—åœ°èµ°è¡ŒãŒç¶šã„ã¦ã„ã¾ã™ã€‚ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã†ã¨ç‡ƒè²»ãŒå‘ä¸Šã—ã¾ã™ã€‚',
                'notif-4': 'ãƒ–ãƒ¬ãƒ¼ã‚­æ“ä½œãŒå¢—ãˆã¦ã„ã¾ã™ã€‚ãƒ‘ãƒ‰ãƒ«ã‚·ãƒ•ãƒˆã§æ¸›é€Ÿæ™‚ã®æ“ä½œã‚’ã‚µãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚',
                'notif-5': 'ãã‚ãã‚ã‚¨ã‚¢ã‚³ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ¸…æƒã‚’ã—ã¾ã—ã‚‡ã†ã€‚',
                'notif-6': 'é•·æ™‚é–“é‹è»¢ãŒç¶šã„ã¦ã„ã¾ã™ã€‚è¿‘ãã§ä¼‘æ†©ã‚’å–ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚',
                // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç”»é¢
                'status-title': 'ã‚ãªãŸã¨æ„›è»Šã®é–¢ä¿‚å€¤',
                'status-level-1': 'ã¯ã˜ã‚ã¾ã—ã¦',
                'status-level-2': 'é¡”ãªã˜ã¿',
                'status-level-3': 'é ¼ã‚Œã‚‹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼',
                'status-level-4': 'ç›¸æ£’',
                'status-next-level': 'æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¾ã§:',
                'status-hint-title': 'æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¸ã®ãƒ’ãƒ³ãƒˆ',
                'status-hint-1': 'ãŠã™ã™ã‚æ©Ÿèƒ½ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†',
                'status-hint-2': 'å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚’å®Ÿæ–½ã—ã¾ã—ã‚‡ã†',
                'status-hint-3': 'é‹è»¢ãƒ‡ãƒ¼ã‚¿ã‚’æ”¹å–„ã—ã¾ã—ã‚‡ã†',
                'status-drive-title': 'é‹è»¢ãƒ‡ãƒ¼ã‚¿',
                'status-total-distance': 'ç·èµ°è¡Œè·é›¢',
                'status-monthly-distance': 'æœˆé–“èµ°è¡Œè·é›¢',
                'status-avg-fuel': 'å¹³å‡ç‡ƒè²»',
                'status-monthly-goal': 'æœˆé–“ç›®æ¨™é”æˆï¼',
                'status-feature-title': 'æ©Ÿèƒ½æ´»ç”¨åº¦',
                'status-features-used': 'æ´»ç”¨ã—ã¦ã„ã‚‹æ©Ÿèƒ½',
                'status-recent-features': 'æœ€è¿‘ä½¿ã£ãŸæ©Ÿèƒ½ï¼š',
                'status-feature-seat': 'ã‚·ãƒ¼ãƒˆãƒ’ãƒ¼ã‚¿ãƒ¼',
                'status-feature-panoramic': 'ãƒ‘ãƒãƒ©ãƒŸãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‹ã‚¿ãƒ¼',
                'status-feature-eco': 'ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰',
                'status-new-feature': 'æ–°æ©Ÿèƒ½ã‚’æ´»ç”¨ä¸­',
                'status-maintenance-title': 'ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹çŠ¶æ³',
                'status-last-check': 'å‰å›ã®ç‚¹æ¤œ',
                'status-next-check': 'æ¬¡å›ã®ç‚¹æ¤œ',
                'status-maintenance-rate': 'ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹éµå®ˆç‡',
                'status-proper-maintenance': 'é©åˆ‡ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å®Ÿæ–½ä¸­',
                'status-level-list-title': 'é–¢ä¿‚å€¤ãƒ¬ãƒ™ãƒ«ä¸€è¦§',
                'status-level-4-desc': 'æ„›è»Šã‚’å®Œå…¨ã«ä½¿ã„ã“ãªã—ã€æœ€é«˜ã®é–¢ä¿‚ã‚’ç¯‰ã„ã¦ã„ã‚‹',
                'status-level-3-desc': 'å¤šãã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã€æ„›è»Šã‚’ç†è§£ã—ã¦ã„ã‚‹',
                'status-level-2-desc': 'æ©Ÿèƒ½ã‚’ä½¿ã„å§‹ã‚ã€æ„›è»Šã®ã“ã¨ã‚’å°‘ã—ãšã¤çŸ¥ã£ã¦ãã¾ã—ãŸ',
                'status-level-1-desc': 'ã¾ã æ„›è»Šã®ã“ã¨ã‚’ã‚ˆãçŸ¥ã‚‰ãªã„çŠ¶æ…‹',
                'status-current': 'ç¾åœ¨',
                'status-achieved': 'é”æˆæ¸ˆã¿',
                'status-locked': 'ğŸ”’',
                // ã‚¢ãƒ©ãƒ¼ãƒˆ
                'alert-parking': 'ç‹­ã„é§è»Šå ´ã§ã™ã€‚<br>ãƒ‘ãƒãƒ©ãƒŸãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚’ä½¿ã†ã¨å®‰å¿ƒã§ã™ã€‚',
                'alert-btn-howto': 'ä½¿ç”¨æ–¹æ³•ã‚’è¦‹ã‚‹',
                'alert-filter': 'ãã‚ãã‚ã‚¨ã‚¢ã‚³ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ¸…æƒã‚’ã—ã¾ã—ã‚‡ã†ã€‚',
                'alert-btn-filter': 'æ¸…æƒæ–¹æ³•ã‚’è¦‹ã‚‹',
                'alert-ecomode': 'å¸‚è¡—åœ°èµ°è¡ŒãŒç¶šã„ã¦ã„ã¾ã™ã€‚ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã†ã¨ç‡ƒè²»ãŒå‘ä¸Šã—ã¾ã™ã€‚',
                'alert-btn-ecomode': 'è¨­å®šæ–¹æ³•ã‚’è¦‹ã‚‹',
                'alert-highbeam': 'å¤œé–“èµ°è¡Œä¸­ã§ã™ã€‚ã‚ªãƒ¼ãƒˆãƒã‚¤ãƒ“ãƒ¼ãƒ ã‚’ã‚ªãƒ³ã«ã™ã‚‹ã¨å®‰å…¨ã§ã™ã€‚',
                'alert-btn-highbeam': 'è¨­å®šæ–¹æ³•ã‚’è¦‹ã‚‹',
                'alert-rest': 'é•·æ™‚é–“é‹è»¢ãŒç¶šã„ã¦ã„ã¾ã™ã€‚<br>è¿‘ãã§ä¼‘æ†©ã‚’å–ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚',
                'alert-btn-rest': '2kmå…ˆã®ABC PAã¸ç›®çš„åœ°ã‚’è¨­å®šã™ã‚‹',
                'alert-paddle': 'ãƒ–ãƒ¬ãƒ¼ã‚­æ“ä½œãŒå¢—ãˆã¦ã„ã¾ã™ã€‚ãƒ‘ãƒ‰ãƒ«ã‚·ãƒ•ãƒˆã§æ¸›é€Ÿæ™‚ã®æ“ä½œã‚’ã‚µãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚',
                'alert-btn-paddle': 'ä½¿ç”¨æ–¹æ³•ã‚’è¦‹ã‚‹'
            },
            en: {
                'app-title': 'DIGITAL OM',
                'btn-back': 'Back',
                'btn-settings': 'Settings',
                'screen-login': 'Login',
                'label-id': 'ID',
                'label-password': 'Password',
                'placeholder-id': 'Enter ID',
                'placeholder-password': 'Enter password',
                'btn-login': 'Login',
                'screen-vehicle-select': 'Select Vehicle Model',
                'screen-vehicle-year': 'Select Year',
                'btn-back-to-model': 'â† Change Model',
                'screen-settings': 'Settings',
                'menu-language': 'Language Settings',
                'menu-vehicle': 'Vehicle Selection',
                'menu-dashboard': 'Admin Dashboard',
                'language-select-title': 'Select Display Language',
                'btn-back-to-settings': 'â† Back to Settings',
                'alert-title': 'Check Now',
                'search-placeholder': 'Search for operations or features...',
                'btn-search': 'Search',
                'quick-question-label': 'Tap frequently asked questions:',
                'quick-door': 'Door won\'t open',
                'quick-bluetooth': 'Bluetooth',
                'quick-warning': 'Warning light',
                'card-recommendation': 'Recommended Features',
                'badge-new': 'NEW',
                'btn-watch-video': 'Watch How-To',
                'card-faq': 'FAQ',
                'tab-home': 'Home',
                'tab-chat': 'Chat',
                'tab-notification': 'Notifications',
                'tab-status': 'Status',
                'chat-placeholder': 'Ask about your smart key or vehicle...',
                'btn-send': 'Send',
                // Dynamic content
                'recommendation-seat-heater': 'You haven\'t used the seat heater function yet. It\'s convenient in winter.',
                'faq-bluetooth': 'How to set up Bluetooth connection',
                'faq-aircon': 'How to use air conditioner',
                'faq-wiper': 'How to operate wipers',
                'chat-intro-name': ', what would you like to know?',
                'chat-intro-quick': 'Quick menu options are available:',
                'chat-quick-door': 'Smart key door won\'t open',
                'chat-quick-battery': 'Key battery low warning displayed',
                'chat-quick-warning': 'Warning light is on',
                // Notifications
                'notif-title': 'Notification History',
                'notif-feedback': 'Were these notifications helpful? Please provide feedback.',
                'notif-helpful': 'Helpful',
                'notif-not-helpful': 'Not Helpful',
                'notif-time-minutes': 'min ago',
                'notif-time-hours': 'hr ago',
                'notif-time-yesterday': 'Yesterday',
                'notif-time-days': 'days ago',
                'notif-1': 'You\'re driving at night. Turning on auto high beam is safer.',
                'notif-2': 'Parking in a narrow space. Panoramic view monitor will help.',
                'notif-3': 'You\'ve been driving in the city. Eco mode can improve fuel efficiency.',
                'notif-4': 'Frequent braking detected. Paddle shift can assist with deceleration.',
                'notif-5': 'Time to clean the air conditioning filter.',
                'notif-6': 'You\'ve been driving for a long time. We recommend taking a break nearby.',
                // Status screen
                'status-title': 'Your Relationship with Your Vehicle',
                'status-level-1': 'Nice to Meet You',
                'status-level-2': 'Getting Acquainted',
                'status-level-3': 'Reliable Partner',
                'status-level-4': 'Best Buddy',
                'status-next-level': 'To next level:',
                'status-hint-title': 'Tips for Next Level',
                'status-hint-1': 'Try recommended features',
                'status-hint-2': 'Perform regular maintenance',
                'status-hint-3': 'Improve driving data',
                'status-drive-title': 'Driving Data',
                'status-total-distance': 'Total Distance',
                'status-monthly-distance': 'Monthly Distance',
                'status-avg-fuel': 'Avg Fuel Economy',
                'status-monthly-goal': 'Monthly goal achieved!',
                'status-feature-title': 'Feature Utilization',
                'status-features-used': 'Features Used',
                'status-recent-features': 'Recently used features:',
                'status-feature-seat': 'Seat Heater',
                'status-feature-panoramic': 'Panoramic View Monitor',
                'status-feature-eco': 'Eco Mode',
                'status-new-feature': 'Using new features',
                'status-maintenance-title': 'Maintenance Status',
                'status-last-check': 'Last Inspection',
                'status-next-check': 'Next Inspection',
                'status-maintenance-rate': 'Maintenance Compliance',
                'status-proper-maintenance': 'Proper maintenance being performed',
                'status-level-list-title': 'Relationship Level List',
                'status-level-4-desc': 'Master your vehicle and build the best relationship',
                'status-level-3-desc': 'Utilize many features and understand your vehicle',
                'status-level-2-desc': 'Starting to use features and getting to know your vehicle',
                'status-level-1-desc': 'Still learning about your vehicle',
                'status-current': 'Current',
                'status-achieved': 'Achieved',
                'status-locked': 'ğŸ”’',
                // Alerts
                'alert-parking': 'Narrow parking space.<br>Panoramic view monitor will help you feel safe.',
                'alert-btn-howto': 'How to Use',
                'alert-filter': 'Time to clean your air conditioning filter.',
                'alert-btn-filter': 'How to Clean',
                'alert-ecomode': 'You\'ve been driving in the city. Eco mode can improve fuel efficiency.',
                'alert-btn-ecomode': 'How to Set',
                'alert-highbeam': 'Driving at night. Turning on auto high beam is safer.',
                'alert-btn-highbeam': 'How to Set',
                'alert-rest': 'You\'ve been driving for a long time.<br>We recommend taking a break nearby.',
                'alert-btn-rest': 'Set destination to ABC PA 2km ahead',
                'alert-paddle': 'Frequent braking detected. Paddle shift can assist with deceleration.',
                'alert-btn-paddle': 'How to Use'
            }
        };

        // ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼šç¿»è¨³ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
        function t(key) {
            return (translations[currentLang] && translations[currentLang][key]) || (translations.ja && translations.ja[key]) || key;
        }

        function applyTranslations() {
            var t = translations[currentLang] || translations.ja;
            
            // data-i18n å±æ€§ã‚’æŒã¤è¦ç´ 
            document.querySelectorAll('[data-i18n]').forEach(function(el) {
                var key = el.getAttribute('data-i18n');
                if (t[key]) el.textContent = t[key];
            });
            
            // data-i18n-html å±æ€§ã‚’æŒã¤è¦ç´ ï¼ˆHTMLå«ã‚€ï¼‰
            document.querySelectorAll('[data-i18n-html]').forEach(function(el) {
                var key = el.getAttribute('data-i18n-html');
                if (t[key]) el.innerHTML = t[key];
            });
            
            // placeholder å±æ€§
            document.querySelectorAll('[data-i18n-placeholder]').forEach(function(el) {
                var key = el.getAttribute('data-i18n-placeholder');
                if (t[key]) el.placeholder = t[key];
            });
            
            // title å±æ€§ã®æ›´æ–°
            document.title = t['app-title'] || 'DIGITAL OM';
            
            // å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å†ç”Ÿæˆ
            if (typeof displayRandomAlert === 'function') {
                displayRandomAlert();
            }
        }

        // file:// ç­‰ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã‚‚è¡¨ç¤ºã‚’å¾©å…ƒã™ã‚‹
        window.onerror = function() {
            try {
                var t = document.getElementById('alertCardTitle');
                if (t) t.innerHTML = '<span>\u26a0\ufe0f</span> ä»Šã™ãç¢ºèª';
                var d = document.getElementById('defaultContent');
                if (d) d.classList.remove('hidden');
            } catch (e) {}
            return false;
        };

        // OEMãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰é€£æºç”¨çµ±è¨ˆï¼ˆlocalStorage: doi_oem_dashboard_statsï¼‰
        var OEM_STATS_KEY = 'doi_oem_dashboard_stats';
        function getDefaultOemStats() {
            return {
                totalQuestionsEnduser: 25000,
                totalQuestionsStaff: 3340,
                answerCorrectEnduser: 23000,
                answerCorrectStaff: 3080,
                searchTopics: {
                    'Bluetoothæ¥ç¶šã®è¨­å®šæ–¹æ³•': { enduser: 2000, staff: 340 },
                    'ã‚¨ã‚¢ã‚³ãƒ³ã®ä½¿ã„æ–¹': { enduser: 1600, staff: 290 },
                    'ãƒ¯ã‚¤ãƒ‘ãƒ¼ã®æ“ä½œæ–¹æ³•': { enduser: 1300, staff: 260 },
                    'ã‚¯ãƒ«ãƒ¼ã‚ºã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®è¨­å®š': { enduser: 1000, staff: 230 },
                    'ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§ã®ç¢ºèªæ–¹æ³•': { enduser: 800, staff: 180 },
                    'è­¦å‘Šç¯ãŒç‚¹ç¯': { enduser: 500, staff: 100 }
                },
                proactiveSent: 8340,
                proactiveViewed: 3753,
                featureUtilizationUp: 15,
                activeUsers: 12450
            };
        }
        function getOemStats() {
            try {
                var raw = localStorage.getItem(OEM_STATS_KEY);
                if (!raw) return getDefaultOemStats();
                var s = JSON.parse(raw);
                var def = getDefaultOemStats();
                if (!s.searchTopics) s.searchTopics = def.searchTopics;
                return s;
            } catch (e) { return getDefaultOemStats(); }
        }
        function setOemStats(s) {
            try {
                localStorage.setItem(OEM_STATS_KEY, JSON.stringify(s));
                try { (new BroadcastChannel('doi_oem_stats_broadcast')).postMessage('update'); } catch (e) {}
            } catch (e) {}
        }
        function mapQueryToTopic(q) {
            var t = (q || '').toLowerCase();
            if (t.indexOf('bluetooth') >= 0 || t.indexOf('ãƒ–ãƒ«ãƒ¼ãƒˆã‚¥ãƒ¼ã‚¹') >= 0) return 'Bluetoothæ¥ç¶šã®è¨­å®šæ–¹æ³•';
            if (t.indexOf('ã‚¨ã‚¢ã‚³ãƒ³') >= 0 || t.indexOf('å†·ãˆãªã„') >= 0) return 'ã‚¨ã‚¢ã‚³ãƒ³ã®ä½¿ã„æ–¹';
            if (t.indexOf('ãƒ¯ã‚¤ãƒ‘ãƒ¼') >= 0) return 'ãƒ¯ã‚¤ãƒ‘ãƒ¼ã®æ“ä½œæ–¹æ³•';
            if (t.indexOf('ã‚¯ãƒ«ãƒ¼ã‚º') >= 0) return 'ã‚¯ãƒ«ãƒ¼ã‚ºã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®è¨­å®š';
            if (t.indexOf('ã‚¿ã‚¤ãƒ¤') >= 0 || t.indexOf('ç©ºæ°—åœ§') >= 0) return 'ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§ã®ç¢ºèªæ–¹æ³•';
            if (t.indexOf('è­¦å‘Šç¯') >= 0 || t.indexOf('è­¦å‘Šç¯ãŒä»˜ã„ãŸ') >= 0) return 'è­¦å‘Šç¯ãŒç‚¹ç¯';
            if (t.indexOf('ãƒ‰ã‚¢') >= 0 || t.indexOf('é–‹ã‹ãªã„') >= 0) return 'ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„';
            return 'ãã®ä»–';
        }
        function recordOemQuestion(query, source) {
            var s = getOemStats();
            if (source === 'enduser') {
                s.totalQuestionsEnduser = (s.totalQuestionsEnduser || 0) + 1;
                s.answerCorrectEnduser = (s.answerCorrectEnduser || 0) + Math.random() < 0.92 ? 1 : 0;
            } else {
                s.totalQuestionsStaff = (s.totalQuestionsStaff || 0) + 1;
                s.answerCorrectStaff = (s.answerCorrectStaff || 0) + Math.random() < 0.92 ? 1 : 0;
            }
            var topic = mapQueryToTopic(query);
            if (!s.searchTopics[topic]) s.searchTopics[topic] = { enduser: 0, staff: 0 };
            if (source === 'enduser') s.searchTopics[topic].enduser = (s.searchTopics[topic].enduser || 0) + 1;
            else s.searchTopics[topic].staff = (s.searchTopics[topic].staff || 0) + 1;
            setOemStats(s);
        }
        function recordOemProactiveView() {
            var s = getOemStats();
            s.proactiveViewed = (s.proactiveViewed || 0) + 1;
            setOemStats(s);
        }
        function recordOemProactiveSent() {
            var s = getOemStats();
            s.proactiveSent = (s.proactiveSent || 0) + 1;
            setOemStats(s);
        }

        // ãƒ­ã‚°ã‚¤ãƒ³ãƒ»è»Šç¨®é¸æŠãƒ•ãƒ­ãƒ¼ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
        var selectedVehicle = null;
        var VEHICLE_IMAGES = { G: './images/ã‚°ãƒ¬ãƒ¼SUV_èƒŒæ™¯é»’.png', B: './images/ãƒ–ãƒ«ãƒ¼ã‚»ãƒ€ãƒ³.png' };
        function showScreen(name) {
            var login = document.getElementById('loginScreen');
            var vehicle = document.getElementById('vehicleSelectScreen');
            var settings = document.getElementById('settingsScreen');
            var home = document.getElementById('homeContent');
            var tabBar = document.getElementById('mainTabBar');
            var headerTitle = document.getElementById('headerTitle');
            var headerBack = document.getElementById('headerBackBtn');
            var headerSettings = document.getElementById('headerSettingsBtn');
            if (login) login.classList.toggle('active', name === 'login');
            if (vehicle) vehicle.classList.toggle('active', name === 'vehicle');
            if (settings) settings.classList.toggle('active', name === 'settings');
            if (home) home.style.display = name === 'home' ? 'block' : 'none';
            if (tabBar) tabBar.style.display = name === 'home' ? 'flex' : 'none';
            if (headerTitle) headerTitle.textContent = (name === 'settings' ? 'è¨­å®š' : 'DIGITAL OM');
            if (headerBack) headerBack.style.display = (name === 'settings' ? 'inline' : 'none');
            if (headerSettings) headerSettings.style.display = (name === 'home' ? 'inline' : 'none');
            if (name === 'settings') closeLanguageSettings();
        }
        function handleLogin(e) {
            if (e && e.preventDefault) e.preventDefault();
            showScreen('vehicle');
            document.getElementById('vehicleModelStep').style.display = 'block';
            document.getElementById('vehicleYearStep').style.display = 'none';
            document.querySelectorAll('.vehicle-model-card').forEach(function(el) { el.classList.remove('selected'); });
        }
        function selectModel(modelId) {
            document.querySelectorAll('.vehicle-model-card').forEach(function(el) {
                el.classList.toggle('selected', el.getAttribute('data-model') === modelId);
            });
            document.getElementById('vehicleModelStep').style.display = 'none';
            document.getElementById('vehicleYearStep').style.display = 'block';
            selectedVehicle = { model: modelId, imageSrc: VEHICLE_IMAGES[modelId] || VEHICLE_IMAGES.G };
        }
        function selectYear(yearId) {
            if (!selectedVehicle) return;
            selectedVehicle.year = yearId;
            var img = document.getElementById('homeVehicleImage');
            if (img && selectedVehicle.imageSrc) img.src = selectedVehicle.imageSrc;
            showScreen('home');
        }

        function openLanguageSettings() {
            document.querySelector('.settings-menu').style.display = 'none';
            document.getElementById('languageSelectPanel').style.display = 'block';
        }
        function closeLanguageSettings() {
            document.getElementById('languageSelectPanel').style.display = 'none';
            var menu = document.querySelector('.settings-menu');
            if (menu) menu.style.display = 'flex';
        }
        function selectLanguage(lang) {
            document.querySelectorAll('.language-option').forEach(function(el) {
                el.classList.toggle('selected', el.getAttribute('data-lang') === lang);
            });
            // è¨€èªåˆ‡ã‚Šæ›¿ãˆå®Ÿè£…
            currentLang = lang;
            document.documentElement.lang = lang;
            applyTranslations();
            localStorage.setItem('preferred_language', lang);
        }
        function goToVehicleSelect() {
            document.getElementById('vehicleModelStep').style.display = 'block';
            document.getElementById('vehicleYearStep').style.display = 'none';
            document.querySelectorAll('.vehicle-model-card').forEach(function(el) { el.classList.remove('selected'); });
            showScreen('vehicle');
        }

        // ã€Œä»Šã™ãç¢ºèªã€ã®ãƒ©ãƒ³ãƒ€ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        var alertMessages = [
            {
                id: 'highbeam',
                textKey: 'alert-highbeam',
                buttonKey: 'alert-btn-highbeam',
                detail: {
                    title: 'ã‚ªãƒ¼ãƒˆãƒã‚¤ãƒ“ãƒ¼ãƒ ã®è¨­å®šæ–¹æ³•',
                    content: `
                        <strong>ã‚ªãƒ¼ãƒˆãƒã‚¤ãƒ“ãƒ¼ãƒ ã¨ã¯ï¼Ÿ</strong><br>
                        å‰æ–¹ã®è»Šä¸¡ã‚„è¡—ç¯ã‚’æ¤œçŸ¥ã—ã¦ã€è‡ªå‹•ã§ãƒã‚¤ãƒ“ãƒ¼ãƒ ã¨ãƒ­ãƒ¼ãƒ“ãƒ¼ãƒ ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹æ©Ÿèƒ½ã§ã™ã€‚<br><br>
                        <strong>è¨­å®šæ‰‹é †ï¼š</strong><br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 1: ãƒ©ã‚¤ãƒˆã‚¹ã‚¤ãƒƒãƒã‚’ç¢ºèª</strong><br>
                        â€¢ ãƒ©ã‚¤ãƒˆã‚¹ã‚¤ãƒƒãƒã‚’ã€ŒAUTOã€ã®ä½ç½®ã«ã—ã¾ã™<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 2: ãƒ¬ãƒãƒ¼ã‚’æ“ä½œ</strong><br>
                        â€¢ ãƒ©ã‚¤ãƒˆãƒ¬ãƒãƒ¼ã‚’å‰æ–¹ã«æŠ¼ã—ã¾ã™<br>
                        â€¢ ãƒ¡ãƒ¼ã‚¿ãƒ¼å†…ã«ã€ŒAUTOã€è¡¨ç¤ºãŒç‚¹ç¯ã—ã¾ã™<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 3: ä½œå‹•ç¢ºèª</strong><br>
                        â€¢ æš—ã„å ´æ‰€ã§å‰æ–¹ã«è»ŠãŒã„ãªã„æ™‚ã€è‡ªå‹•ã§ãƒã‚¤ãƒ“ãƒ¼ãƒ ã«ãªã‚Šã¾ã™<br>
                        â€¢ å¯¾å‘è»Šã‚„å…ˆè¡Œè»Šã‚’æ¤œçŸ¥ã™ã‚‹ã¨ã€è‡ªå‹•ã§ãƒ­ãƒ¼ãƒ“ãƒ¼ãƒ ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™<br><br>
                        <strong>ğŸ’¡ æ³¨æ„äº‹é …ï¼š</strong><br>
                        â€¢ å¸‚è¡—åœ°ã§ã¯æ‰‹å‹•ã§ãƒ­ãƒ¼ãƒ“ãƒ¼ãƒ ã«ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™<br>
                        â€¢ æ‚ªå¤©å€™æ™‚ã¯æ­£å¸¸ã«ä½œå‹•ã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™
                    `
                }
            },
            {
                id: 'rest',
                textKey: 'alert-rest',
                buttonKey: 'alert-btn-rest',
                detail: {
                    title: 'ä¼‘æ†©ã‚¹ãƒãƒƒãƒˆã¸ã®ã”æ¡ˆå†…',
                    content: `
                        <strong>ğŸ“ ABC ãƒ‘ãƒ¼ã‚­ãƒ³ã‚°ã‚¨ãƒªã‚¢</strong><br>
                        è·é›¢: 2kmå…ˆï¼ˆç´„3åˆ†ï¼‰<br>
                        å–¶æ¥­æ™‚é–“: 24æ™‚é–“<br><br>
                        <strong>æ–½è¨­æƒ…å ±ï¼š</strong><br>
                        â€¢ ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãƒ»å£²åº—<br>
                        â€¢ ãƒˆã‚¤ãƒ¬ãƒ»å–«ç…™æ‰€<br>
                        â€¢ è‡ªå‹•è²©å£²æ©Ÿ<br>
                        â€¢ ç„¡æ–™Wi-Fi<br>
                        â€¢ EVå……é›»ã‚¹ã‚¿ãƒ³ãƒ‰<br><br>
                        <strong>ğŸ’¡ é‹è»¢ç–²åŠ´ã®ã‚µã‚¤ãƒ³ï¼š</strong><br>
                        â€¢ 2æ™‚é–“ä»¥ä¸Šã®é€£ç¶šé‹è»¢<br>
                        â€¢ ã‚ãã³ãŒé »ç¹ã«å‡ºã‚‹<br>
                        â€¢ é›†ä¸­åŠ›ã®ä½ä¸‹<br><br>
                        <strong>æ¨å¥¨ä¼‘æ†©æ™‚é–“ï¼š</strong><br>
                        15-20åˆ†ç¨‹åº¦ã®ä¼‘æ†©ã§ã€é‹è»¢ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå›å¾©ã—ã¾ã™ã€‚
                    `
                }
            },
            {
                id: 'panoramic',
                textKey: 'alert-parking',
                buttonKey: 'alert-btn-howto',
                detail: {
                    title: 'ãƒ‘ãƒãƒ©ãƒŸãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‹ã‚¿ãƒ¼ã®ä½¿ç”¨æ–¹æ³•',
                    content: `
                        <strong>ãƒ‘ãƒãƒ©ãƒŸãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‹ã‚¿ãƒ¼ã¨ã¯ï¼Ÿ</strong><br>
                        è»Šä¸¡ã®å‘¨å›²ã‚’çœŸä¸Šã‹ã‚‰è¦‹ãŸã‚ˆã†ãªæ˜ åƒã‚’è¡¨ç¤ºã—ã€é§è»Šã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚<br><br>
                        
                        <div style="text-align: center; margin: 20px 0;">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C!-- èƒŒæ™¯ï¼ˆãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤é¢¨ï¼‰ --%3E%3Crect fill='%23000000' width='700' height='400' rx='10'/%3E%3Crect fill='%231a1a2e' width='680' height='380' x='10' y='10' rx='5'/%3E%3C!-- å·¦å´ï¼šãƒˆãƒƒãƒ—ãƒ“ãƒ¥ãƒ¼ --%3E%3Crect fill='%232d4a6e' width='320' height='340' x='20' y='30' rx='8'/%3E%3Ctext x='180' y='55' text-anchor='middle' font-size='14' fill='%234facfe' font-weight='bold'%3EçœŸä¸Šã‹ã‚‰ã®è¦–ç‚¹%3C/text%3E%3C!-- é“è·¯ --%3E%3Crect fill='%23556b7a' width='280' height='300' x='40' y='70'/%3E%3C!-- è»Šä¸¡ï¼ˆçœŸä¸Šã‹ã‚‰ï¼‰ --%3E%3Crect fill='%23ffffff' width='80' height='140' x='140' y='150' rx='8'/%3E%3Crect fill='%23e0e0e0' width='60' height='100' x='150' y='170' rx='4'/%3E%3C!-- ã‚¿ã‚¤ãƒ¤ --%3E%3Crect fill='%23333' width='15' height='30' x='135' y='160'/%3E%3Crect fill='%23333' width='15' height='30' x='210' y='160'/%3E%3Crect fill='%23333' width='15' height='30' x='135' y='270'/%3E%3Crect fill='%23333' width='15' height='30' x='210' y='270'/%3E%3C!-- ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆé»„è‰²ï¼‰ --%3E%3Cpath d='M 140 150 L 90 100 M 220 150 L 270 100' stroke='%23ffeb3b' stroke-width='2' stroke-dasharray='5,5' fill='none'/%3E%3Cpath d='M 140 290 L 90 340 M 220 290 L 270 340' stroke='%23ffeb3b' stroke-width='2' stroke-dasharray='5,5' fill='none'/%3E%3C!-- ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆèµ¤ï¼‰ --%3E%3Cpath d='M 140 290 L 90 350 M 220 290 L 270 350' stroke='%23ff5252' stroke-width='3' fill='none'/%3E%3C!-- å³å´ï¼šãƒªã‚¢ãƒ“ãƒ¥ãƒ¼ --%3E%3Crect fill='%232d4a6e' width='320' height='340' x='360' y='30' rx='8'/%3E%3Ctext x='520' y='55' text-anchor='middle' font-size='14' fill='%234facfe' font-weight='bold'%3Eå¾Œæ–¹ã‚«ãƒ¡ãƒ©è¦–ç‚¹%3C/text%3E%3C!-- é§è»Šå ´ã®åœ°é¢ --%3E%3Crect fill='%23556b7a' width='280' height='300' x='380' y='70'/%3E%3C!-- é§è»Šãƒ©ã‚¤ãƒ³ --%3E%3Cline x1='380' y1='100' x2='660' y2='100' stroke='%23ffffff' stroke-width='2'/%3E%3Cline x1='380' y1='340' x2='660' y2='340' stroke='%23ffffff' stroke-width='2'/%3E%3C!-- ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆé»„è‰²ãƒ»å°å½¢ï¼‰ --%3E%3Cpath d='M 450 370 L 400 280 L 640 280 L 590 370 Z' stroke='%23ffeb3b' stroke-width='2' fill='%23ffeb3b' opacity='0.2'/%3E%3Ctext x='520' y='315' text-anchor='middle' font-size='16' fill='%23ffeb3b' font-weight='bold'%3Eè»Šå¹…%3C/text%3E%3C!-- ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆèµ¤ï¼‰ --%3E%3Cline x1='480' y1='370' x2='430' y2='300' stroke='%23ff5252' stroke-width='3'/%3E%3Cline x1='560' y1='370' x2='610' y2='300' stroke='%23ff5252' stroke-width='3'/%3E%3Ctext x='520' y='360' text-anchor='middle' font-size='14' fill='%23ff5252' font-weight='bold'%3Eæ³¨æ„%3C/text%3E%3C!-- ä¸‹éƒ¨ï¼šã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ --%3E%3Crect fill='%230f3460' width='660' height='50' x='20' y='340' rx='5'/%3E%3C!-- ãƒœã‚¿ãƒ³1ï¼šãƒˆãƒƒãƒ—ãƒ“ãƒ¥ãƒ¼ --%3E%3Crect fill='%234facfe' width='80' height='35' x='40' y='350' rx='5'/%3E%3Ctext x='80' y='372' text-anchor='middle' font-size='12' fill='%23000' font-weight='bold'%3EçœŸä¸Š%3C/text%3E%3C!-- ãƒœã‚¿ãƒ³2ï¼šãƒ•ãƒ­ãƒ³ãƒˆ --%3E%3Crect fill='%232d3561' width='80' height='35' x='140' y='350' rx='5' stroke='%234facfe' stroke-width='1'/%3E%3Ctext x='180' y='372' text-anchor='middle' font-size='12' fill='%234facfe'%3Eå‰æ–¹%3C/text%3E%3C!-- ãƒœã‚¿ãƒ³3ï¼šã‚µã‚¤ãƒ‰ --%3E%3Crect fill='%232d3561' width='80' height='35' x='240' y='350' rx='5' stroke='%234facfe' stroke-width='1'/%3E%3Ctext x='280' y='372' text-anchor='middle' font-size='12' fill='%234facfe'%3Eå´é¢%3C/text%3E%3C!-- è¨­å®šã‚¢ã‚¤ã‚³ãƒ³ --%3E%3Ccircle cx='630' cy='367' r='15' fill='%232d3561' stroke='%234facfe' stroke-width='1'/%3E%3Ctext x='630' y='373' text-anchor='middle' font-size='16' fill='%234facfe'%3Eâš™%3C/text%3E%3C/svg%3E" 
                                alt="ãƒ‘ãƒãƒ©ãƒŸãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‹ã‚¿ãƒ¼ç”»é¢" 
                                style="width: 100%; max-width: 500px; border-radius: 12px; margin: 10px 0;">
                        </div>
                        
                        <strong>èµ·å‹•æ–¹æ³•ï¼š</strong><br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 1: ã‚·ãƒ•ãƒˆã‚’Rã«å…¥ã‚Œã‚‹</strong><br>
                        â€¢ ãƒãƒƒã‚¯ã‚®ã‚¢ã«å…¥ã‚Œã‚‹ã¨è‡ªå‹•ã§èµ·å‹•ã—ã¾ã™<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 2: è¡¨ç¤ºåˆ‡æ›¿</strong><br>
                        â€¢ ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã®ã€Œè¡¨ç¤ºåˆ‡æ›¿ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—<br>
                        â€¢ <span style="color: #BF00FF; font-weight: 600;">çœŸä¸Š</span>ã€<span style="color: #BF00FF;">å‰æ–¹</span>ã€<span style="color: #BF00FF;">å´é¢</span>ãƒ“ãƒ¥ãƒ¼ã‚’é¸æŠå¯èƒ½<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 3: ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ç¢ºèª</strong><br>
                        â€¢ <span style="color: #ffeb3b; font-weight: 600;">é»„è‰²ã®ãƒ©ã‚¤ãƒ³</span>: è»Šä¸¡ã®å¹…ã‚’ç¤ºã—ã¾ã™<br>
                        â€¢ <span style="color: #ff5252; font-weight: 600;">èµ¤è‰²ã®ãƒ©ã‚¤ãƒ³</span>: éšœå®³ç‰©ã¨ã®å±é™ºãªè·é›¢ã‚’ç¤ºã—ã¾ã™<br><br>
                        <strong>ğŸ’¡ æ´»ç”¨ã‚·ãƒ¼ãƒ³ï¼š</strong><br>
                        â€¢ ç‹­ã„é§è»Šå ´ã§ã®é§è»Š<br>
                        â€¢ ç¸¦åˆ—é§è»Š<br>
                        â€¢ ç‹­ã„é“ã§ã®åˆ‡ã‚Šè¿”ã—<br>
                        â€¢ ãƒãƒƒã‚¯æ™‚ã®éšœå®³ç‰©ç¢ºèª<br><br>
                        <strong>âš ï¸ æ³¨æ„ï¼š</strong><br>
                        ã‚«ãƒ¡ãƒ©ã®æ˜ åƒã¯è£œåŠ©æ©Ÿèƒ½ã§ã™ã€‚å¿…ãšç›®è¦–ã§ã‚‚å‘¨å›²ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
                    `
                }
            },
            {
                id: 'ecomode',
                textKey: 'alert-ecomode',
                buttonKey: 'alert-btn-ecomode',
                detail: {
                    title: 'ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã®è¨­å®šæ–¹æ³•',
                    content: `
                        <strong>ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã¨ã¯ï¼Ÿ</strong><br>
                        ã‚¢ã‚¯ã‚»ãƒ«æ“ä½œã«å¯¾ã™ã‚‹ã‚¨ãƒ³ã‚¸ãƒ³ã¨ãƒˆãƒ©ãƒ³ã‚¹ãƒŸãƒƒã‚·ãƒ§ãƒ³ã®å¿œç­”ã‚’ç©ã‚„ã‹ã«ã—ã€ç‡ƒè²»ã‚’å‘ä¸Šã•ã›ã‚‹ãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚<br><br>
                        <strong>è¨­å®šæ‰‹é †ï¼š</strong><br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 1: ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¢ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™</strong><br>
                        â€¢ ã‚»ãƒ³ã‚¿ãƒ¼ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã€ŒMODEã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 2: ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠ</strong><br>
                        â€¢ ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€ŒECOã€ã‚’é¸æŠ<br>
                        â€¢ ãƒ¡ãƒ¼ã‚¿ãƒ¼å†…ã«ã€ŒECOã€è¡¨ç¤ºãŒç‚¹ç¯ã—ã¾ã™<br><br>
                        <strong>ğŸ’¡ ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã®åŠ¹æœï¼š</strong><br>
                        â€¢ ç‡ƒè²»ãŒç´„10-15%å‘ä¸Š<br>
                        â€¢ ã‚¢ã‚¯ã‚»ãƒ«æ“ä½œãŒç©ã‚„ã‹ã«<br>
                        â€¢ ã‚¨ã‚¢ã‚³ãƒ³ã®åŠ¹ããŒæŠ‘ãˆã‚‰ã‚Œã¾ã™<br><br>
                        <strong>æ¨å¥¨ä½¿ç”¨ã‚·ãƒ¼ãƒ³ï¼š</strong><br>
                        â€¢ å¸‚è¡—åœ°èµ°è¡Œ<br>
                        â€¢ æ¸‹æ»æ™‚<br>
                        â€¢ é•·è·é›¢èµ°è¡Œ<br><br>
                        <strong>âš ï¸ æ³¨æ„ï¼š</strong><br>
                        æ€¥ãªåŠ é€ŸãŒå¿…è¦ãªå ´é¢ã§ã¯ã€é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã¦ãã ã•ã„ã€‚<br><br>
                        <div style="text-align: center; margin-top: 15px;">
                            <button class="button" onclick="showFuelEfficiencyData()" 
                                    style="background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%); padding: 12px 24px; border-radius: 8px; color: white; font-weight: 600; border: none; cursor: pointer;">
                                ğŸ“Š ã‚ãªãŸã®ç‡ƒè²»ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚‹
                            </button>
                        </div>
                    `
                }
            },
            {
                id: 'paddle',
                textKey: 'alert-paddle',
                buttonKey: 'alert-btn-paddle',
                detail: {
                    title: 'ãƒ‘ãƒ‰ãƒ«ã‚·ãƒ•ãƒˆã®ä½¿ç”¨æ–¹æ³•',
                    content: `
                        <strong>ãƒ‘ãƒ‰ãƒ«ã‚·ãƒ•ãƒˆã¨ã¯ï¼Ÿ</strong><br>
                        ãƒãƒ³ãƒ‰ãƒ«ã®è£å´ã«ã‚ã‚‹ãƒ¬ãƒãƒ¼ã§ã€æ‰‹å‹•ã§ã‚®ã‚¢ã‚’å¤‰æ›´ã§ãã‚‹æ©Ÿèƒ½ã§ã™ã€‚<br><br>
                        
                        <div style="text-align: center; margin: 20px 0;">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 350'%3E%3C!-- èƒŒæ™¯ --%3E%3Crect fill='%23ffffff' width='500' height='350' rx='15'/%3E%3Crect fill='none' stroke='%23333' stroke-width='3' width='480' height='330' x='10' y='10' rx='10'/%3E%3C!-- ãƒãƒ³ãƒ‰ãƒ«ï¼ˆæ‰‹æ›¸ãé¢¨ï¼‰ --%3E%3Cpath d='M 150 175 Q 150 100 250 100 Q 350 100 350 175' fill='none' stroke='%23333' stroke-width='4' stroke-linecap='round'/%3E%3Cpath d='M 150 175 Q 150 250 250 250 Q 350 250 350 175' fill='none' stroke='%23333' stroke-width='4' stroke-linecap='round'/%3E%3Cline x1='150' y1='175' x2='150' y2='175' stroke='%23333' stroke-width='4'/%3E%3Cline x1='350' y1='175' x2='350' y2='175' stroke='%23333' stroke-width='4'/%3E%3C!-- ãƒãƒ³ãƒ‰ãƒ«ã®å¤ªã• --%3E%3Cpath d='M 160 175 Q 160 110 250 110 Q 340 110 340 175' fill='none' stroke='%23ddd' stroke-width='15' stroke-linecap='round'/%3E%3Cpath d='M 160 175 Q 160 240 250 240 Q 340 240 340 175' fill='none' stroke='%23ddd' stroke-width='15' stroke-linecap='round'/%3E%3C!-- ä¸­å¿ƒéƒ¨ --%3E%3Ccircle cx='250' cy='175' r='35' fill='%23f0f0f0' stroke='%23333' stroke-width='3'/%3E%3C!-- å·¦å´ãƒ‘ãƒ‰ãƒ«ï¼ˆæ‰‹æ›¸ãé¢¨ã€ãƒ”ãƒ³ã‚¯ï¼‰ --%3E%3Cpath d='M 120 150 L 90 140 L 85 145 L 85 205 L 90 210 L 120 200 Z' fill='%23ffb3d9' stroke='%23333' stroke-width='2.5' stroke-linejoin='round'/%3E%3C!-- ãƒ‘ãƒ‰ãƒ«ã®è©³ç´°ç·šï¼ˆå·¦ï¼‰ --%3E%3Cline x1='95' y1='150' x2='95' y2='195' stroke='%23333' stroke-width='1.5'/%3E%3Cline x1='105' y1='155' x2='105' y2='195' stroke='%23333' stroke-width='1.5'/%3E%3C!-- å³å´ãƒ‘ãƒ‰ãƒ«ï¼ˆæ‰‹æ›¸ãé¢¨ã€ãƒ”ãƒ³ã‚¯ï¼‰ --%3E%3Cpath d='M 380 150 L 410 140 L 415 145 L 415 205 L 410 210 L 380 200 Z' fill='%23ffb3d9' stroke='%23333' stroke-width='2.5' stroke-linejoin='round'/%3E%3C!-- ãƒ‘ãƒ‰ãƒ«ã®è©³ç´°ç·šï¼ˆå³ï¼‰ --%3E%3Cline x1='405' y1='150' x2='405' y2='195' stroke='%23333' stroke-width='1.5'/%3E%3Cline x1='395' y1='155' x2='395' y2='195' stroke='%23333' stroke-width='1.5'/%3E%3C!-- çŸ¢å°ï¼ˆå·¦å´ï¼‰ --%3E%3Cpath d='M 100 115 L 95 95 L 90 115' fill='none' stroke='%23ff6b9d' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cline x1='95' y1='95' x2='95' y2='130' stroke='%23ff6b9d' stroke-width='2.5' stroke-linecap='round'/%3E%3C!-- çŸ¢å°ï¼ˆå³å´ï¼‰ --%3E%3Cpath d='M 400 115 L 405 95 L 410 115' fill='none' stroke='%23ff6b9d' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cline x1='405' y1='95' x2='405' y2='130' stroke='%23ff6b9d' stroke-width='2.5' stroke-linecap='round'/%3E%3C!-- ãƒ©ãƒ™ãƒ«ï¼ˆå·¦ï¼‰ --%3E%3Ctext x='50' y='178' text-anchor='middle' font-size='20' fill='%23333' font-weight='bold'%3E-%3C/text%3E%3Ctext x='100' y='245' text-anchor='middle' font-size='14' fill='%23666'%3Eå·¦ãƒ‘ãƒ‰ãƒ«%3C/text%3E%3Ctext x='100' y='265' text-anchor='middle' font-size='12' fill='%23999'%3Eï¼ˆã‚·ãƒ•ãƒˆãƒ€ã‚¦ãƒ³ï¼‰%3C/text%3E%3C!-- ãƒ©ãƒ™ãƒ«ï¼ˆå³ï¼‰ --%3E%3Ctext x='450' y='178' text-anchor='middle' font-size='20' fill='%23333' font-weight='bold'%3E%2B%3C/text%3E%3Ctext x='400' y='245' text-anchor='middle' font-size='14' fill='%23666'%3Eå³ãƒ‘ãƒ‰ãƒ«%3C/text%3E%3Ctext x='400' y='265' text-anchor='middle' font-size='12' fill='%23999'%3Eï¼ˆã‚·ãƒ•ãƒˆã‚¢ãƒƒãƒ—ï¼‰%3C/text%3E%3C!-- èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆ --%3E%3Ctext x='250' y='310' text-anchor='middle' font-size='13' fill='%23666'%3Eãƒãƒ³ãƒ‰ãƒ«ã®è£å´ã«é…ç½®ã•ã‚Œã¦ã„ã¾ã™%3C/text%3E%3Ctext x='250' y='330' text-anchor='middle' font-size='12' fill='%23999'%3Eé‹è»¢ä¸­ã«è¦ªæŒ‡ã§ç°¡å˜ã«æ“ä½œã§ãã¾ã™%3C/text%3E%3C/svg%3E" 
                                alt="ãƒ‘ãƒ‰ãƒ«ã‚·ãƒ•ãƒˆã®ä½ç½®" 
                                style="width: 100%; max-width: 400px; border-radius: 12px; margin: 10px 0; background: white; padding: 10px;">
                        </div>
                        
                        <strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong><br><br>
                        <strong>åŸºæœ¬æ“ä½œï¼š</strong><br>
                        â€¢ <span style="color: #D200FF; font-weight: 600;">å³å´ãƒ‘ãƒ‰ãƒ«ï¼ˆ+ï¼‰</span>: ã‚·ãƒ•ãƒˆã‚¢ãƒƒãƒ—ï¼ˆé«˜ã„ã‚®ã‚¢ã¸ï¼‰<br>
                        â€¢ <span style="color: #ff6b6b; font-weight: 600;">å·¦å´ãƒ‘ãƒ‰ãƒ«ï¼ˆ-ï¼‰</span>: ã‚·ãƒ•ãƒˆãƒ€ã‚¦ãƒ³ï¼ˆä½ã„ã‚®ã‚¢ã¸ï¼‰<br><br>
                        <strong>æ¸›é€Ÿæ™‚ã®æ´»ç”¨ï¼š</strong><br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 1: ä¸‹ã‚Šå‚ã§ä½¿ç”¨</strong><br>
                        â€¢ å·¦å´ãƒ‘ãƒ‰ãƒ«ï¼ˆ-ï¼‰ã‚’å¼•ã„ã¦ã‚·ãƒ•ãƒˆãƒ€ã‚¦ãƒ³<br>
                        â€¢ ã‚¨ãƒ³ã‚¸ãƒ³ãƒ–ãƒ¬ãƒ¼ã‚­ãŒåŠ¹ãã¾ã™<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 2: ã‚«ãƒ¼ãƒ–æ‰‹å‰ã§ä½¿ç”¨</strong><br>
                        â€¢ ã‚«ãƒ¼ãƒ–æ‰‹å‰ã§ã‚·ãƒ•ãƒˆãƒ€ã‚¦ãƒ³<br>
                        â€¢ å®‰å®šã—ãŸæ¸›é€ŸãŒå¯èƒ½<br><br>
                        <strong>ğŸ’¡ ãƒ¡ãƒªãƒƒãƒˆï¼š</strong><br>
                        â€¢ ãƒ–ãƒ¬ãƒ¼ã‚­ã®è² æ‹…ã‚’è»½æ¸›<br>
                        â€¢ ç‡ƒè²»ã®å‘ä¸Š<br>
                        â€¢ ã‚¹ãƒ ãƒ¼ã‚ºãªæ¸›é€Ÿ<br><br>
                        <strong>æ¨å¥¨ä½¿ç”¨ã‚·ãƒ¼ãƒ³ï¼š</strong><br>
                        â€¢ é•·ã„ä¸‹ã‚Šå‚<br>
                        â€¢ å±±é“<br>
                        â€¢ é€£ç¶šã™ã‚‹ã‚«ãƒ¼ãƒ–<br><br>
                        <strong>âš ï¸ æ³¨æ„ï¼š</strong><br>
                        æ€¥ãªã‚·ãƒ•ãƒˆãƒ€ã‚¦ãƒ³ã¯è»Šä¸¡ã«è² æ‹…ã‚’ã‹ã‘ã¾ã™ã€‚æ®µéšçš„ã«æ“ä½œã—ã¦ãã ã•ã„ã€‚
                    `
                }
            },
            {
                id: 'filter',
                textKey: 'alert-filter',
                buttonKey: 'alert-btn-filter',
                detail: {
                    title: 'ã‚¨ã‚¢ã‚³ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ¸…æƒæ–¹æ³•',
                    content: `
                        <strong>ã‚¨ã‚¢ã‚³ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¨ã¯ï¼Ÿ</strong><br>
                        è»Šå†…ã«å…¥ã‚‹ç©ºæ°—ã‚’ã‚éã—ã€èŠ±ç²‰ã‚„ãƒ›ã‚³ãƒªã‚’é™¤å»ã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§ã™ã€‚<br><br>
                        <strong>æ¸…æƒãƒ»äº¤æ›æ™‚æœŸï¼š</strong><br>
                        â€¢ æ¨å¥¨: 1å¹´ã«1å›ã¾ãŸã¯èµ°è¡Œè·é›¢10,000km<br>
                        â€¢ ã‚¨ã‚¢ã‚³ãƒ³ã®åŠ¹ããŒæ‚ªã„å ´åˆã¯æ—©ã‚ã«äº¤æ›<br><br>
                        <strong>æ¸…æƒæ‰‹é †ï¼š</strong><br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 1: ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®å–ã‚Šå¤–ã—</strong><br>
                        â€¢ ã‚°ãƒ­ãƒ¼ãƒ–ãƒœãƒƒã‚¯ã‚¹ã‚’é–‹ã‘ã¾ã™<br>
                        â€¢ å¥¥ã«ã‚ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚«ãƒãƒ¼ã‚’å¤–ã—ã¾ã™<br>
                        â€¢ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’å¼•ãå‡ºã—ã¾ã™<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 2: æ¸…æƒ</strong><br>
                        â€¢ æƒé™¤æ©Ÿã§ãƒ›ã‚³ãƒªã‚’å¸ã„å–ã‚Šã¾ã™<br>
                        â€¢ æ°´æ´—ã„ã¯é¿ã‘ã¦ãã ã•ã„<br>
                        â€¢ æ±šã‚ŒãŒã²ã©ã„å ´åˆã¯æ–°å“ã«äº¤æ›<br><br>
                        <strong>ã‚¹ãƒ†ãƒƒãƒ— 3: å–ã‚Šä»˜ã‘</strong><br>
                        â€¢ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®å‘ãã‚’ç¢ºèªï¼ˆçŸ¢å°ãŒä¸‹å‘ãï¼‰<br>
                        â€¢ ã‚«ãƒãƒ¼ã‚’å…ƒã«æˆ»ã—ã¾ã™<br><br>
                        <strong>ğŸ’¡ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼äº¤æ›ã®ã‚µã‚¤ãƒ³ï¼š</strong><br>
                        â€¢ ã‚¨ã‚¢ã‚³ãƒ³ã®é¢¨é‡ãŒå¼±ã„<br>
                        â€¢ è»Šå†…ã«ç•°è‡­ãŒã™ã‚‹<br>
                        â€¢ çª“ãŒæ›‡ã‚Šã‚„ã™ã„<br><br>
                        <strong>ğŸ“¦ äº¤æ›ç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼š</strong><br>
                        è²©å£²åº—ã¾ãŸã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆã‚¢ã§è³¼å…¥å¯èƒ½ï¼ˆå“ç•ª: 8713932010ï¼‰<br><br>
                        <div style="text-align: center; margin-top: 15px;">
                            <a href="https://shop.toyota.co.za/products/8713932010" 
                               target="_blank" 
                               class="button" 
                               style="display: inline-block; text-decoration: none; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 12px 24px; border-radius: 8px; color: white; font-weight: 600;">
                                ğŸ›’ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è³¼å…¥
                            </a>
                        </div>
                    `
                }
            }
        ];

        let currentAlertId = null;

        // ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
        function displayRandomAlert() {
            var alertTitle = document.getElementById('alertCardTitle');
            if (!alertTitle) alertTitle = document.getElementById('alertCard') && document.getElementById('alertCard').querySelector('.card-title');
            if (alertTitle) alertTitle.innerHTML = '<span>âš ï¸</span> ' + t('alert-title');
            const randomIndex = Math.floor(Math.random() * alertMessages.length);
            const message = alertMessages[randomIndex];
            currentAlertId = message.id;
            const alertContent = document.getElementById('alertContent');
            if (alertContent) {
                var messageText = message.textKey ? t(message.textKey) : message.text;
                var buttonText = message.buttonKey ? t(message.buttonKey) : message.button;
                alertContent.innerHTML = `
                    ${messageText}
                    <div class="button" onclick="showAlertDetail('${message.id}')">${buttonText}</div>
                `;
            }
        }

        // ã‚¢ãƒ©ãƒ¼ãƒˆã®è©³ç´°ç”»é¢ã‚’è¡¨ç¤º
        function showAlertDetail(alertId) {
            const message = alertMessages.find(m => m.id === alertId);
            if (!message) return;

            const defaultContent = document.getElementById('defaultContent');
            const searchResult = document.getElementById('searchResult');

            defaultContent.classList.add('hidden');

            searchResult.innerHTML = `
                <div class="card" style="margin-bottom: 15px;">
                    <div class="card-title" style="font-size: 1.1em;">
                        ${message.detail.title}
                    </div>
                    <div class="card-content">
                        ${message.detail.content}
                    </div>
                </div>
                
                <div id="feedbackSection" style="margin: 20px 0;">
                    <div class="card" style="background: rgba(26, 26, 46, 0.6); border: 1px solid rgba(191, 0, 255, 0.2);">
                        <div class="card-content" style="text-align: center;">
                            <strong style="font-size: 1.05em; color: #fff;">ã“ã®æƒ…å ±ã¯å½¹ã«ç«‹ã¡ã¾ã—ãŸã‹ï¼Ÿ</strong>
                            <div style="margin-top: 15px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                                <button onclick="submitFeedback('very_helpful', '${message.detail.title}')" 
                                        style="background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9em; transition: transform 0.2s;">
                                    ğŸ˜Š ã¨ã¦ã‚‚å½¹ç«‹ã£ãŸ
                                </button>
                                <button onclick="submitFeedback('helpful', '${message.detail.title}')" 
                                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9em; transition: transform 0.2s;">
                                    ğŸ™‚ å½¹ç«‹ã£ãŸ
                                </button>
                                <button onclick="submitFeedback('not_helpful', '${message.detail.title}')" 
                                        style="background: linear-gradient(135deg, #888 0%, #666 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9em; transition: transform 0.2s;">
                                    ğŸ˜• ã‚ã¾ã‚Šå½¹ç«‹ãŸãªã‹ã£ãŸ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="button" onclick="resetToHome()">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
                </div>
            `;
            searchResult.classList.remove('hidden');
            document.getElementById('homeContent').scrollTop = 0;
        }

        // ãƒ›ãƒ¼ãƒ ç”»é¢ã«æˆ»ã‚‹
        function resetToHome() {
            document.getElementById('searchResult').classList.add('hidden');
            document.getElementById('defaultContent').classList.remove('hidden');
            document.getElementById('homeContent').scrollTop = 0;
        }

        // ç‡ƒè²»ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
        function showFuelEfficiencyData() {
            const defaultContent = document.getElementById('defaultContent');
            const searchResult = document.getElementById('searchResult');

            defaultContent.classList.add('hidden');

            searchResult.innerHTML = `
                <div class="card" style="margin-bottom: 15px;">
                    <div class="card-title" style="font-size: 1.1em;">
                        ğŸ“Š ã‚ãªãŸã®ç‡ƒè²»ãƒ‡ãƒ¼ã‚¿
                    </div>
                    <div class="card-content">
                        <div style="background: linear-gradient(135deg, rgba(191, 0, 255, 0.15) 0%, rgba(210, 0, 255, 0.1) 100%); padding: 15px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #BF00FF;">
                            <strong style="color: #BF00FF; font-size: 1.1em;">ğŸ’¡ ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã®åŠ¹æœäºˆæ¸¬</strong><br><br>
                            ç¾åœ¨ã®ç‡ƒè²»: <strong style="color: #ff6b6b;">8.9 km/L</strong><br>
                            ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ä½¿ç”¨æ™‚: <strong style="color: #BF00FF;">10.3 km/L</strong><br>
                            <strong style="color: #D200FF;">+15.7% ã®ç‡ƒè²»æ”¹å–„ãŒæœŸå¾…ã§ãã¾ã™ï¼</strong>
                        </div>
                        
                        <strong>ğŸ“ˆ ç‡ƒè²»æ”¹å–„ã®ãƒ’ãƒ³ãƒˆ</strong><br><br>
                        
                        <div style="background: rgba(255, 107, 107, 0.1); padding: 12px; border-radius: 8px; margin: 10px 0;">
                            <strong style="color: #ff6b6b;">âš ï¸ ç‡ƒè²»ãŒæ‚ªåŒ–ã—ã¦ã„ã‚‹è¦å› ï¼š</strong><br>
                            â€¢ å¸‚è¡—åœ°èµ°è¡ŒãŒå¢—åŠ ï¼ˆã‚¹ãƒˆãƒƒãƒ—&ã‚´ãƒ¼ãŒå¤šã„ï¼‰<br>
                            â€¢ å†¬å­£ã®ãŸã‚æš–æ©Ÿé‹è»¢ãŒå¿…è¦<br>
                            â€¢ ã‚¨ã‚¢ã‚³ãƒ³ä½¿ç”¨é »åº¦ã®å¢—åŠ 
                        </div>
                        
                        <div style="background: rgba(191, 0, 255, 0.1); padding: 12px; border-radius: 8px; margin: 10px 0;">
                            <strong style="color: #BF00FF;">âœ… ãŠã™ã™ã‚ã®æ”¹å–„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br><br>
                            <strong>1. ã‚¨ã‚³ãƒ¢ãƒ¼ãƒ‰ã‚’æ´»ç”¨</strong><br>
                            â€¢ å¸‚è¡—åœ°èµ°è¡Œæ™‚ã«ON â†’ ç‡ƒè²»+15%å‘ä¸Š<br><br>
                            <strong>2. æ€¥ç™ºé€²ãƒ»æ€¥ãƒ–ãƒ¬ãƒ¼ã‚­ã‚’é¿ã‘ã‚‹</strong><br>
                            â€¢ ãªã‚ã‚‰ã‹ãªåŠ æ¸›é€Ÿ â†’ ç‡ƒè²»+10%å‘ä¸Š<br><br>
                            <strong>3. ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§ã‚’ãƒã‚§ãƒƒã‚¯</strong><br>
                            â€¢ é©æ­£ç©ºæ°—åœ§ã®ç¶­æŒ â†’ ç‡ƒè²»+3%å‘ä¸Š<br><br>
                            <strong>4. ä¸è¦ãªè·ç‰©ã‚’é™ã‚ã™</strong><br>
                            â€¢ è»Šé‡100kgå‰Šæ¸› â†’ ç‡ƒè²»+3%å‘ä¸Š
                        </div>
                        
                        <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.1) 100%); padding: 15px; border-radius: 10px; margin: 15px 0; text-align: center;">
                            <strong style="font-size: 1.1em;">ğŸ¯ ç›®æ¨™ç‡ƒè²»</strong><br>
                            <div style="font-size: 2em; font-weight: bold; color: #667eea; margin: 10px 0;">11.0 km/L</div>
                            <div style="color: #aaa;">ä¸Šè¨˜ã®æ”¹å–„ã§é”æˆå¯èƒ½ã§ã™ï¼</div>
                        </div>
                    </div>
                </div>
                
                <div id="feedbackSection" style="margin: 20px 0;">
                    <div class="card" style="background: rgba(26, 26, 46, 0.6); border: 1px solid rgba(191, 0, 255, 0.2);">
                        <div class="card-content" style="text-align: center;">
                            <strong style="font-size: 1.05em; color: #fff;">ã“ã®æƒ…å ±ã¯å½¹ã«ç«‹ã¡ã¾ã—ãŸã‹ï¼Ÿ</strong>
                            <div style="margin-top: 15px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                                <button onclick="submitFeedback('very_helpful', 'ç‡ƒè²»ãƒ‡ãƒ¼ã‚¿')" 
                                        style="background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9em; transition: transform 0.2s;">
                                    ğŸ˜Š ã¨ã¦ã‚‚å½¹ç«‹ã£ãŸ
                                </button>
                                <button onclick="submitFeedback('helpful', 'ç‡ƒè²»ãƒ‡ãƒ¼ã‚¿')" 
                                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9em; transition: transform 0.2s;">
                                    ğŸ™‚ å½¹ç«‹ã£ãŸ
                                </button>
                                <button onclick="submitFeedback('not_helpful', 'ç‡ƒè²»ãƒ‡ãƒ¼ã‚¿')" 
                                        style="background: linear-gradient(135deg, #888 0%, #666 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9em; transition: transform 0.2s;">
                                    ğŸ˜• ã‚ã¾ã‚Šå½¹ç«‹ãŸãªã‹ã£ãŸ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="button" onclick="resetToHome()">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
                </div>
            `;
            searchResult.classList.remove('hidden');
            document.getElementById('homeContent').scrollTop = 0;
        }

        // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ä¿¡
        function submitFeedback(rating, pageTitle) {
            const feedbackSection = document.getElementById('feedbackSection');
            if (feedbackSection) {
                feedbackSection.innerHTML = `
                    <div style="background: linear-gradient(135deg, rgba(191, 0, 255, 0.2) 0%, rgba(210, 0, 255, 0.15) 100%); padding: 20px; border-radius: 12px; text-align: center; margin: 20px 0; border: 2px solid rgba(191, 0, 255, 0.3);">
                        <div style="font-size: 2em; margin-bottom: 10px;">âœ…</div>
                        <strong style="color: #BF00FF; font-size: 1.1em;">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼</strong><br>
                        <div style="color: #aaa; margin-top: 10px; font-size: 0.9em;">
                            ãŠå®¢æ§˜ã®å£°ã‚’ã‚‚ã¨ã«ã€ã‚ˆã‚Šè‰¯ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚
                        </div>
                    </div>
                `;
            }
            console.log(`Feedback submitted: ${rating} for "${pageTitle}"`);
        }

        // æ¬¡ã®ãŠã™ã™ã‚æ©Ÿèƒ½ã‚’è¡¨ç¤º
        function showNextRecommendation() {
            try { recordOemProactiveView(); } catch (e) {}
            const recommendationContent = document.getElementById('recommendationContent');
            if (recommendationContent) {
                recommendationContent.innerHTML = `
                    <div id="recommendationText">ãŠã‚¯ãƒ«ãƒã«ã¯é›»å‹•ãƒ†ãƒ¼ãƒ«ã‚²ãƒ¼ãƒˆãŒæ­è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>æ—¥å¸¸ã®ç©ã¿ä¸‹ã‚ã—ã§ä¾¿åˆ©ãªæ©Ÿèƒ½ã§ã™ã€‚</div>
                    <div style="display: flex; gap: 10px; margin-top: 12px; align-items: center; flex-wrap: wrap;">
                        <a href="https://www.youtube.com/shorts/OsvZRTbj2Cg" target="_blank" class="button" style="text-decoration: none; display: inline-block; flex: 1; min-width: 140px;">
                            ğŸ¥ ä½¿ã„æ–¹ã‚’è¦‹ã‚‹
                        </a>
                        <button onclick="showThankYouMessage()" class="button" style="background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px 18px; flex: 0;">
                            âœ…
                        </button>
                        <button onclick="showRecommendationFeedback()" class="button" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px 18px; flex: 0;">
                            ğŸ˜’
                        </button>
                    </div>
                `;
            }
            console.log('Next recommendation shown: é›»å‹•ãƒ†ãƒ¼ãƒ«ã‚²ãƒ¼ãƒˆ');
        }

        // ã‚µãƒ³ã‚­ãƒ¥ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
        function showThankYouMessage() {
            try { recordOemProactiveView(); } catch (e) {}
            const recommendationContent = document.getElementById('recommendationContent');
            if (recommendationContent) {
                recommendationContent.innerHTML = `
                    <div style="background: linear-gradient(135deg, rgba(0, 208, 132, 0.2) 0%, rgba(0, 185, 109, 0.15) 100%); padding: 20px; border-radius: 12px; text-align: center; border: 2px solid rgba(0, 208, 132, 0.3);">
                        <div style="font-size: 2em; margin-bottom: 10px;">âœ¨</div>
                        <strong style="color: #00d084; font-size: 1.1em;">ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼</strong><br>
                        <div style="color: #aaa; margin-top: 10px; font-size: 0.9em;">
                            å¼•ãç¶šããŠå½¹ç«‹ã¡æƒ…å ±ã‚’ãŠå±Šã‘ã—ã¾ã™ã€‚
                        </div>
                    </div>
                `;
            }
            console.log('Thank you message displayed');
        }

        // ãŠã™ã™ã‚æ©Ÿèƒ½ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”»é¢ã‚’è¡¨ç¤º
        function showRecommendationFeedback() {
            try { recordOemProactiveView(); } catch (e) {}
            const recommendationContent = document.getElementById('recommendationContent');
            if (recommendationContent) {
                recommendationContent.innerHTML = `
                    <div style="text-align: center;">
                        <strong style="font-size: 1.05em; color: #fff; display: block; margin-bottom: 15px;">ã“ã®ææ¡ˆãŒå½¹ç«‹ãŸãªã‹ã£ãŸç†ç”±ã‚’æ•™ãˆã¦ãã ã•ã„</strong>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <button onclick="submitRecommendationFeedback('ä¸æ˜')" 
                                    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.95em; transition: all 0.3s; width: 100%;">
                                â“ ä½¿ã„æ–¹ãŒã‚ã‹ã‚‰ãªã„
                            </button>
                            <button onclick="submitRecommendationFeedback('ä½¿ã„ã«ãã„')" 
                                    style="background: linear-gradient(135deg, #ff9a76 0%, #ff7c6c 100%); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.95em; transition: all 0.3s; width: 100%;">
                                ğŸ˜“ ä½¿ã„ã«ãã„
                            </button>
                            <button onclick="submitRecommendationFeedback('å¬‰ã—ããªã„')" 
                                    style="background: linear-gradient(135deg, #888 0%, #666 100%); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.95em; transition: all 0.3s; width: 100%;">
                                ğŸ˜ å¬‰ã—ããªã„
                            </button>
                        </div>
                    </div>
                `;
            }
            console.log('Recommendation feedback screen shown');
        }

        // ãŠã™ã™ã‚æ©Ÿèƒ½ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ä¿¡
        function submitRecommendationFeedback(reason) {
            const recommendationContent = document.getElementById('recommendationContent');
            if (recommendationContent) {
                recommendationContent.innerHTML = `
                    <div style="background: linear-gradient(135deg, rgba(191, 0, 255, 0.2) 0%, rgba(210, 0, 255, 0.15) 100%); padding: 20px; border-radius: 12px; text-align: center; border: 2px solid rgba(191, 0, 255, 0.3);">
                        <div style="font-size: 2em; margin-bottom: 10px;">ğŸ’¬</div>
                        <strong style="color: #BF00FF; font-size: 1.1em;">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™</strong><br>
                        <div style="color: #aaa; margin-top: 10px; font-size: 0.9em;">
                            ã„ãŸã ã„ãŸã”æ„è¦‹ã‚’å‚è€ƒã«ã€<br>ã‚ˆã‚Šè‰¯ã„ææ¡ˆãŒã§ãã‚‹ã‚ˆã†æ”¹å–„ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚
                        </div>
                    </div>
                `;
            }
            console.log(`Recommendation feedback submitted: ${reason}`);
        }

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function switchTab(tabName, evt) {
            const allTabs = document.querySelectorAll('.tab-item');
            allTabs.forEach(tab => tab.classList.remove('active'));
            const target = (evt && evt.currentTarget) || document.querySelector(`.tab-item[data-tab="${tabName}"]`);
            if (target) target.classList.add('active');

            const resultDiv = document.getElementById('searchResult');
            const defaultContent = document.getElementById('defaultContent');

            console.log(`${tabName} ã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ`);

            if (tabName === 'home') {
                resetSearch();
                displayRandomAlert();
            } else if (tabName === 'chat') {
                showChatScreen();
            } else if (tabName === 'notification') {
                showNotificationScreen();
            } else if (tabName === 'status') {
                showStatusScreen();
            }
        }

        // è³ªå•ã¨å›ç­”ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
        const qaDatabase = {
            'ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„': {
                intent: 'å•é¡Œè§£æ±ºã‚µãƒãƒ¼ãƒˆ',
                urgency: 'medium',
                answer: `
                    <strong>ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„å ´åˆã®è¨ºæ–­</strong><br><br>
                    ä»¥ä¸‹ã®é †ç•ªã§ç¢ºèªã—ã¦ãã ã•ã„ï¼š<br><br>
                    <strong>1. ã‚­ãƒ¼ã®é›»æ± ã‚’ç¢ºèª</strong><br>
                    â€¢ ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®é›»æ± ãŒåˆ‡ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™<br>
                    â€¢ é›»æ± æ®‹é‡ãŒå°‘ãªã„å ´åˆã€ãƒ‰ã‚¢ã«è¿‘ã¥ã‘ã¦æ“ä½œã—ã¦ãã ã•ã„<br><br>
                    <strong>2. ãƒãƒ£ã‚¤ãƒ«ãƒ‰ãƒ­ãƒƒã‚¯ã‚’ç¢ºèª</strong><br>
                    â€¢ å¾Œéƒ¨åº§å¸­ã®ãƒ‰ã‚¢ã®å ´åˆã€ãƒãƒ£ã‚¤ãƒ«ãƒ‰ãƒ­ãƒƒã‚¯ãŒã‹ã‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™<br>
                    â€¢ å†…å´ã®ãƒ¬ãƒãƒ¼ã§è§£é™¤ã§ãã¾ã™<br><br>
                    <strong>3. ãƒ‰ã‚¢ãƒ­ãƒƒã‚¯ã®å‡çµã‚’ç¢ºèªï¼ˆå†¬å­£ï¼‰</strong><br>
                    â€¢ æ°—æ¸©ãŒä½ã„å ´åˆã€ãƒ‰ã‚¢ãƒ­ãƒƒã‚¯ãŒå‡çµã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™<br>
                    â€¢ æ¸©æ°´ã‚’ã‹ã‘ã‚‹ã‹ã€è§£æ°·ã‚¹ãƒ—ãƒ¬ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„<br><br>
                    <strong>4. ãã‚Œã§ã‚‚é–‹ã‹ãªã„å ´åˆ</strong><br>
                    â€¢ ãƒ¡ã‚«ãƒ‹ã‚«ãƒ«ã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„<br>
                    â€¢ ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã‹ã‚‰ãƒ¡ã‚«ãƒ‹ã‚«ãƒ«ã‚­ãƒ¼ã‚’å–ã‚Šå‡ºã—ã€ãƒ‰ã‚¢ã®éµç©´ã«å·®ã—è¾¼ã‚“ã§ãã ã•ã„
                `,
                actions: [
                    { label: 'è©³ç´°ãªæ‰‹é †ã‚’è¦‹ã‚‹', type: 'primary' },
                    { label: 'è²©å£²åº—ã«ç›¸è«‡', type: 'secondary' }
                ]
            },
            'Bluetoothæ¥ç¶šã¯ã©ã†ã‚„ã£ã¦ã‚„ã‚‹ã®ï¼Ÿ': {
                intent: 'æ“ä½œæ–¹æ³•ã‚¬ã‚¤ãƒ‰',
                urgency: 'low',
                answer: `
                    <strong>Bluetoothæ¥ç¶šã®è¨­å®šæ–¹æ³•</strong><br><br>
                    ä»¥ä¸‹ã®æ‰‹é †ã§è¨­å®šã§ãã¾ã™ï¼š<br><br>
                    <strong>ã‚¹ãƒ†ãƒƒãƒ— 1: è¨­å®šç”»é¢ã‚’é–‹ã</strong><br>
                    â€¢ ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã®ã€Œè¨­å®šã€ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¾ã™<br><br>
                    <strong>ã‚¹ãƒ†ãƒƒãƒ— 2: Bluetoothã‚’é¸æŠ</strong><br>
                    â€¢ ã€ŒBluetoothã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠã—ã¾ã™<br>
                    â€¢ BluetoothãŒã‚ªãƒ•ã®å ´åˆã¯ã‚ªãƒ³ã«ã—ã¾ã™<br><br>
                    <strong>ã‚¹ãƒ†ãƒƒãƒ— 3: ãƒ‡ãƒã‚¤ã‚¹ã‚’æ¤œç´¢</strong><br>
                    â€¢ ã€Œæ–°ã—ã„ãƒ‡ãƒã‚¤ã‚¹ã‚’è¿½åŠ ã€ã‚’ã‚¿ãƒƒãƒ—ã—ã¾ã™<br>
                    â€¢ ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®Bluetoothè¨­å®šã‚’é–‹ãã€æ¤œå‡ºå¯èƒ½ã«ã—ã¾ã™<br><br>
                    <strong>ã‚¹ãƒ†ãƒƒãƒ— 4: ãƒšã‚¢ãƒªãƒ³ã‚°</strong><br>
                    â€¢ è»Šã®ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã«è¡¨ç¤ºã•ã‚ŒãŸãƒ‡ãƒã‚¤ã‚¹åã‚’ã‚¿ãƒƒãƒ—ã—ã¾ã™<br>
                    â€¢ ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã«è¡¨ç¤ºã•ã‚Œã‚‹PINã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã€ã€Œãƒšã‚¢ãƒªãƒ³ã‚°ã€ã‚’ã‚¿ãƒƒãƒ—ã—ã¾ã™<br><br>
                    <strong>ğŸ’¡ ãƒ’ãƒ³ãƒˆ:</strong><br>
                    â€¢ åˆå›æ¥ç¶šå¾Œã¯ã€è‡ªå‹•çš„ã«æ¥ç¶šã•ã‚Œã¾ã™<br>
                    â€¢ æ¥ç¶šã§ããªã„å ´åˆã¯ã€ä¸€åº¦Bluetoothã‚’ã‚ªãƒ•â†’ã‚ªãƒ³ã«ã—ã¦ãã ã•ã„
                `,
                actions: [
                    { label: 'ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹', type: 'primary' },
                    { label: 'å‹•ç”»ã§è¦‹ã‚‹', type: 'secondary' }
                ]
            },
            'è­¦å‘Šç¯ãŒç‚¹ç¯ã—ãŸ': {
                intent: 'å•é¡Œè§£æ±ºã‚µãƒãƒ¼ãƒˆ',
                urgency: 'high',
                answer: `
                    <strong style="color: #ff6b6b;">âš ï¸ è­¦å‘Šç¯ãŒç‚¹ç¯ã—ãŸå ´åˆã®å¯¾å¿œ</strong><br><br>
                    è­¦å‘Šç¯ã®è‰²ã«ã‚ˆã£ã¦å¯¾å¿œãŒç•°ãªã‚Šã¾ã™ï¼š<br><br>
                    <strong style="color: #ff0000;">ğŸ”´ èµ¤è‰²ã®è­¦å‘Šç¯ã®å ´åˆï¼ˆç·Šæ€¥ï¼‰</strong><br>
                    <strong>ã™ãã«ä»¥ä¸‹ã®å¯¾å¿œã‚’ã—ã¦ãã ã•ã„ï¼š</strong><br>
                    1. å®‰å…¨ãªå ´æ‰€ã«åœè»Šã—ã¦ãã ã•ã„<br>
                    2. ã‚¨ãƒ³ã‚¸ãƒ³ã‚’åœæ­¢ã—ã¦ãã ã•ã„<br>
                    3. ã™ãã«è²©å£²åº—ã«ã”é€£çµ¡ãã ã•ã„<br><br>
                    <strong>ä¸»ãªèµ¤è‰²è­¦å‘Šç¯ï¼š</strong><br>
                    â€¢ ãƒ–ãƒ¬ãƒ¼ã‚­è­¦å‘Šç¯<br>
                    â€¢ ã‚¨ãƒ³ã‚¸ãƒ³æ²¹åœ§è­¦å‘Šç¯<br>
                    â€¢ å……é›»è­¦å‘Šç¯<br>
                    â€¢ æ°´æ¸©è­¦å‘Šç¯<br><br>
                    <strong style="color: #ffa500;">ğŸŸ¡ é»„è‰²ã®è­¦å‘Šç¯ã®å ´åˆ</strong><br>
                    <strong>ä»¥ä¸‹ã®å¯¾å¿œã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼š</strong><br>
                    1. é€Ÿã‚„ã‹ã«è²©å£²åº—ã§ç‚¹æ¤œã‚’å—ã‘ã¦ãã ã•ã„<br>
                    2. èµ°è¡Œã¯å¯èƒ½ã§ã™ãŒã€é•·è·é›¢é‹è»¢ã¯é¿ã‘ã¦ãã ã•ã„<br>
                    3. æ€¥åŠ é€Ÿã‚„é«˜é€Ÿèµ°è¡Œã‚’æ§ãˆã¦ãã ã•ã„<br><br>
                    <strong>ä¸»ãªé»„è‰²è­¦å‘Šç¯ï¼š</strong><br>
                    â€¢ ã‚¨ãƒ³ã‚¸ãƒ³è­¦å‘Šç¯ï¼ˆãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ã‚¸ãƒ³ãƒ©ãƒ³ãƒ—ï¼‰<br>
                    â€¢ ABSè­¦å‘Šç¯<br>
                    â€¢ ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§è­¦å‘Šç¯<br><br>
                    <strong>ğŸ“ ç·Šæ€¥é€£çµ¡å…ˆï¼š</strong><br>
                    æœ€å¯„ã‚Šã®è²©å£²åº—: 0120-XXX-XXXï¼ˆ24æ™‚é–“å¯¾å¿œï¼‰
                `,
                actions: [
                    { label: 'è²©å£²åº—ã‚’æ¤œç´¢', type: 'primary' },
                    { label: 'ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚’å‘¼ã¶', type: 'secondary' }
                ]
            }
        };

        // ========== T1-T6 ãƒ•ã‚§ãƒ¼ã‚º1: ãƒ¢ãƒƒã‚¯çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ãƒ»çŠ¶æ…‹ãƒ»ã‚¨ãƒ³ã‚¸ãƒ³ ==========
        const T16_KB_DOOR_NOT_OPEN = {
            event_id: 'DOOR_NOT_OPEN',
            cause_candidates: [
                { cause_id: 'KEY_BATTERY_EMPTY', description: 'ã‚­ãƒ¼é›»æ± åˆ‡ã‚Œ', required_observations: ['key_indicator_light'], risk_level: 'low', action_group: 'battery_replace' },
                { cause_id: 'KEY_FAULT', description: 'ã‚­ãƒ¼æ•…éšœ', required_observations: ['key_indicator_light'], risk_level: 'low', action_group: 'dealer' },
                { cause_id: 'RADIO_INTERFERENCE', description: 'é›»æ³¢å¹²æ¸‰', required_observations: ['key_indicator_light', 'location'], risk_level: 'low', action_group: 'retry_or_relocate' },
                { cause_id: 'VEHICLE_12V_LOW', description: 'è»Šä¸¡12Vä½ä¸‹', required_observations: ['key_indicator_light', 'vehicle_12v'], risk_level: 'low', action_group: 'jump_start' },
                { cause_id: 'LOCK_ACTUATOR_FAULT', description: 'ãƒ‰ã‚¢ãƒ­ãƒƒã‚¯æ•…éšœ', required_observations: ['other_key_result'], risk_level: 'medium', action_group: 'dealer' },
                { cause_id: 'USER_OPERATION', description: 'æ“ä½œæ¡ä»¶ä¸ä¸€è‡´', required_observations: ['key_indicator_light', 'operation_condition'], risk_level: 'low', action_group: 'guide' }
            ],
            t3_question: {
                question_id: 'Q_DOOR_001',
                question_text: 'ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ãƒ©ãƒ³ãƒ—ã¯ç‚¹ãã¾ã™ã‹ï¼Ÿ',
                answer_type: 'yes_no',
                expected_split: { yes: ['RADIO_INTERFERENCE', 'VEHICLE_12V_LOW', 'USER_OPERATION', 'LOCK_ACTUATOR_FAULT'], no: ['KEY_BATTERY_EMPTY', 'KEY_FAULT'] },
                priority: 1
            },
            action_cards_by_cause: {
                KEY_BATTERY_EMPTY: [
                    { action_id: 'A_DOOR_001', guide_id: 'GUIDE-001', title: 'ä»Šã™ãé–‹ã‘ã‚‹ï¼šæ©Ÿæ¢°ã‚­ãƒ¼ã§è§£éŒ ', steps: ['ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼å´é¢ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦æ©Ÿæ¢°ã‚­ãƒ¼ã‚’å–ã‚Šå‡ºã™', 'é‹è»¢å¸­ãƒ‰ã‚¢ã®éµç©´ã«å·®ã—è¾¼ã‚“ã§å›ã™'], duration: 'ç´„30ç§’', required_items: [], risk_notice: null, alternative: 'é–‹ã‹ãªã„å ´åˆã¯ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¸', is_immediate: true },
                    { action_id: 'A_DOOR_002', guide_id: 'GUIDE-005', title: 'æ’ä¹…å¯¾å¿œï¼šé›»æ± äº¤æ›', steps: ['CR2032ï¼ˆã¾ãŸã¯CR2450ï¼‰ã‚’ç”¨æ„', 'ã‚­ãƒ¼ã‚’é–‹ã‘ã¦é›»æ± ã‚’äº¤æ›', 'å‹•ä½œç¢ºèª'], duration: 'ç´„3åˆ†', required_items: ['CR2032 ã¾ãŸã¯ CR2450ï¼ˆãƒœã‚¿ãƒ³é›»æ± ï¼‰'], risk_notice: 'éƒ¨å“ç ´æã®æã‚ŒãŒã‚ã‚‹ãŸã‚ã€è²©å£²åº—ã§ã®äº¤æ›ã‚’æ¨å¥¨ã—ã¾ã™ã€‚', alternative: 'é›»æ± è³¼å…¥å…ˆã®æ¡ˆå†…ã¸', is_immediate: false },
                    { action_id: 'A_DOOR_003', guide_id: 'GUIDE-006', title: 'ä¸å®‰ãªã‚‰ï¼šè²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹', steps: ['ä½ç½®å…±æœ‰ãƒ»ç—‡çŠ¶è¦ç´„ä»˜ãã§é€£çµ¡'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                RADIO_INTERFERENCE: [
                    { action_id: 'A_DOOR_004', guide_id: 'GUIDE-008', title: 'ã‚­ãƒ¼ã‚’ãƒ‰ã‚¢ãƒãƒ³ãƒ‰ãƒ«ã«è¿‘ã¥ã‘ã¦å†è©¦è¡Œ', steps: ['ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã‚’ãƒ‰ã‚¢ãƒãƒ³ãƒ‰ãƒ«ã«ã§ãã‚‹ã ã‘è¿‘ã¥ã‘ã¦æ“ä½œ', 'æ•°ãƒ¡ãƒ¼ãƒˆãƒ«ç§»å‹•ã—ã¦å†è©¦è¡Œ'], duration: 'ç´„1åˆ†', required_items: [], risk_notice: null, alternative: 'æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹ã‘ã‚‹', is_immediate: true },
                    { action_id: 'A_DOOR_005', guide_id: null, title: 'äºˆå‚™ã®ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§è©¦ã™', steps: ['äºˆå‚™ã®ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒã‚ã‚Œã°ã€åŒã˜ã‚ˆã†ã«ãƒ‰ã‚¢ã®è§£éŒ ã‚’è©¦ã™'], duration: 'ç´„1åˆ†', required_items: [], risk_notice: null, alternative: 'äºˆå‚™ã‚­ãƒ¼ãŒãªã„å ´åˆã¯æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹ã‘ã‚‹', is_immediate: true },
                    { action_id: 'A_DOOR_001', guide_id: 'GUIDE-001', title: 'ä»Šã™ãé–‹ã‘ã‚‹ï¼šæ©Ÿæ¢°ã‚­ãƒ¼ã§è§£éŒ ', steps: ['ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼å´é¢ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦æ©Ÿæ¢°ã‚­ãƒ¼ã‚’å–ã‚Šå‡ºã™', 'é‹è»¢å¸­ãƒ‰ã‚¢ã®éµç©´ã«å·®ã—è¾¼ã‚“ã§å›ã™'], duration: 'ç´„30ç§’', required_items: [], risk_notice: null, alternative: 'ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¸', is_immediate: true }
                ],
                LOCK_ACTUATOR_FAULT: [
                    { action_id: 'A_DOOR_005', guide_id: null, title: 'äºˆå‚™ã®ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§è©¦ã™', steps: ['äºˆå‚™ã®ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒã‚ã‚Œã°ã€åŒã˜ã‚ˆã†ã«ãƒ‰ã‚¢ã®è§£éŒ ã‚’è©¦ã™'], duration: 'ç´„1åˆ†', required_items: [], risk_notice: null, alternative: 'äºˆå‚™ã‚­ãƒ¼ãŒãªã„å ´åˆã¯æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹ã‘ã‚‹', is_immediate: true },
                    { action_id: 'A_DOOR_001', guide_id: 'GUIDE-001', title: 'ä»Šã™ãé–‹ã‘ã‚‹ï¼šæ©Ÿæ¢°ã‚­ãƒ¼ã§è§£éŒ ', steps: ['ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼å´é¢ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦æ©Ÿæ¢°ã‚­ãƒ¼ã‚’å–ã‚Šå‡ºã™', 'é‹è»¢å¸­ãƒ‰ã‚¢ã®éµç©´ã«å·®ã—è¾¼ã‚“ã§å›ã™'], duration: 'ç´„30ç§’', required_items: [], risk_notice: null, alternative: 'é–‹ã‹ãªã„å ´åˆã¯ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¸', is_immediate: true },
                    { action_id: 'A_DOOR_003', guide_id: 'GUIDE-006', title: 'è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«é€£çµ¡', steps: ['ä½ç½®å…±æœ‰ãƒ»ç—‡çŠ¶è¦ç´„ä»˜ãã§é€£çµ¡'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                _default: [
                    { action_id: 'A_DOOR_005', guide_id: null, title: 'äºˆå‚™ã®ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§è©¦ã™', steps: ['äºˆå‚™ã®ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒã‚ã‚Œã°ã€åŒã˜ã‚ˆã†ã«ãƒ‰ã‚¢ã®è§£éŒ ã‚’è©¦ã™'], duration: 'ç´„1åˆ†', required_items: [], risk_notice: null, alternative: 'äºˆå‚™ã‚­ãƒ¼ãŒãªã„å ´åˆã¯æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹ã‘ã‚‹', is_immediate: true },
                    { action_id: 'A_DOOR_001', guide_id: 'GUIDE-001', title: 'ä»Šã™ãé–‹ã‘ã‚‹ï¼šæ©Ÿæ¢°ã‚­ãƒ¼ã§è§£éŒ ', steps: ['ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼å´é¢ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦æ©Ÿæ¢°ã‚­ãƒ¼ã‚’å–ã‚Šå‡ºã™', 'é‹è»¢å¸­ãƒ‰ã‚¢ã®éµç©´ã«å·®ã—è¾¼ã‚“ã§å›ã™'], duration: 'ç´„30ç§’', required_items: [], risk_notice: null, alternative: 'é–‹ã‹ãªã„å ´åˆã¯ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¸', is_immediate: true },
                    { action_id: 'A_DOOR_003', guide_id: 'GUIDE-006', title: 'è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹', steps: ['ä½ç½®å…±æœ‰ãƒ»ç—‡çŠ¶è¦ç´„ä»˜ãã§é€£çµ¡'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ]
            },
            escalation_option: { dealer: 'è²©å£²åº—äºˆç´„', road_service: 'ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹' }
        };

        // è­¦å‘Šç¯ã‚¢ã‚¤ã‚³ãƒ³ç”¨SVGï¼ˆå–èª¬ã‚¤ãƒ¡ãƒ¼ã‚¸ã«æº–æ‹ : https://manual.toyota.jp/aqua/2509/hev/ja_JP/contents/vhch07se020402.php ï¼‰
        var WARNING_LIGHT_ICONS = {
            brake_red: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='28' fill='none' stroke='%23e53935' stroke-width='3'/%3E%3Ctext x='32' y='42' text-anchor='middle' fill='%23e53935' font-size='32' font-weight='bold'%3E!%3C/text%3E%3Cpath d='M14 32 Q32 10 50 32' fill='none' stroke='%23e53935' stroke-width='2' stroke-dasharray='4 3'/%3E%3Cpath d='M14 32 Q32 54 50 32' fill='none' stroke='%23e53935' stroke-width='2' stroke-dasharray='4 3'/%3E%3C/svg%3E",
            brake_yellow: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='28' fill='none' stroke='%23ffa726' stroke-width='3'/%3E%3Ctext x='32' y='42' text-anchor='middle' fill='%23ffa726' font-size='32' font-weight='bold'%3E!%3C/text%3E%3Cpath d='M14 32 Q32 10 50 32' fill='none' stroke='%23ffa726' stroke-width='2' stroke-dasharray='4 3'/%3E%3Cpath d='M14 32 Q32 54 50 32' fill='none' stroke='%23ffa726' stroke-width='2' stroke-dasharray='4 3'/%3E%3C/svg%3E",
            coolant: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect x='26' y='8' width='12' height='40' rx='4' fill='none' stroke='%23e53935' stroke-width='2'/%3E%3Ccircle cx='32' cy='52' r='6' fill='none' stroke='%23e53935' stroke-width='2'/%3E%3Cpath d='M32 20 L32 40' stroke='%23e53935' stroke-width='2'/%3E%3C/svg%3E",
            oil: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cellipse cx='32' cy='48' rx='20' ry='6' fill='none' stroke='%23e53935' stroke-width='2'/%3E%3Cpath d='M20 48 L20 24 L32 14 L44 24 L44 48' fill='none' stroke='%23e53935' stroke-width='2'/%3E%3Ctext x='32' y='36' text-anchor='middle' fill='%23e53935' font-size='14'%3Eoil%3C/text%3E%3C/svg%3E",
            charge: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpath d='M32 8 L20 28 L30 28 L22 56 L44 32 L32 32 Z' fill='none' stroke='%23e53935' stroke-width='2' stroke-linejoin='round'/%3E%3C/svg%3E",
            engine: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect x='12' y='24' width='40' height='24' rx='2' fill='none' stroke='%23ffa726' stroke-width='2'/%3E%3Cpath d='M28 24 L28 16 L36 16 L36 24' fill='none' stroke='%23ffa726' stroke-width='2'/%3E%3Cpath d='M20 32 L44 32' stroke='%23ffa726' stroke-width='2'/%3E%3C/svg%3E",
            tyre: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='24' fill='none' stroke='%23ffa726' stroke-width='2'/%3E%3Ctext x='32' y='40' text-anchor='middle' fill='%23ffa726' font-size='28' font-weight='bold'%3E!%3C/text%3E%3C/svg%3E",
            abs: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ctext x='32' y='38' text-anchor='middle' fill='%23ffa726' font-size='18' font-weight='bold'%3EABS%3C/text%3E%3C/svg%3E",
            other: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='26' fill='none' stroke='%23888' stroke-width='2'/%3E%3Ctext x='32' y='42' text-anchor='middle' fill='%23888' font-size='32' font-weight='bold'%3E!%3C/text%3E%3C/svg%3E"
        };

        const T16_KB_WARNING_LIGHT = {
            event_id: 'WARNING_LIGHT',
            cause_candidates: [
                { cause_id: 'ENGINE_WARNING', description: 'ã‚¨ãƒ³ã‚¸ãƒ³è­¦å‘Šç¯ï¼ˆã‚·ã‚¹ãƒ†ãƒ ç•°å¸¸ï¼‰', required_observations: ['lamp_color'], risk_level: 'medium', action_group: 'dealer' },
                { cause_id: 'ENGINE_OIL', description: 'ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«', required_observations: ['lamp_color'], risk_level: 'medium', action_group: 'check_oil' },
                { cause_id: 'BRAKE_SYSTEM', description: 'ãƒ–ãƒ¬ãƒ¼ã‚­ç³»çµ±', required_observations: ['lamp_color'], risk_level: 'high', action_group: 'dealer' },
                { cause_id: 'ENGINE_COOLANT', description: 'ã‚¨ãƒ³ã‚¸ãƒ³ãƒ»å†·å´ç³»', required_observations: ['lamp_color'], risk_level: 'high', action_group: 'dealer' },
                { cause_id: 'BATTERY_CHARGE', description: 'ãƒãƒƒãƒ†ãƒªãƒ¼å……é›»', required_observations: ['lamp_color'], risk_level: 'medium', action_group: 'jump_start' },
                { cause_id: 'TYRE_PRESSURE', description: 'ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§', required_observations: ['lamp_color'], risk_level: 'low', action_group: 'tyre_check' },
                { cause_id: 'OTHER_WARNING', description: 'ãã®ä»–è­¦å‘Š', required_observations: ['lamp_color'], risk_level: 'medium', action_group: 'dealer' }
            ],
            warning_light_options: [
                { option_id: 'BRAKE_RED', label: 'ãƒ–ãƒ¬ãƒ¼ã‚­è­¦å‘Šç¯ï¼ˆèµ¤ï¼‰', cause_id: 'BRAKE_SYSTEM', icon: 'brake_red' },
                { option_id: 'BRAKE_YELLOW', label: 'ãƒ–ãƒ¬ãƒ¼ã‚­è­¦å‘Šç¯ï¼ˆé»„ï¼‰', cause_id: 'BRAKE_SYSTEM', icon: 'brake_yellow' },
                { option_id: 'COOLANT', label: 'é«˜æ°´æ¸©è­¦å‘Šç¯', cause_id: 'ENGINE_COOLANT', icon: 'coolant' },
                { option_id: 'HYBRID_OVERHEAT', label: 'ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ éç†±è­¦å‘Šç¯', cause_id: 'ENGINE_COOLANT', icon: 'coolant' },
                { option_id: 'CHARGE', label: 'å……é›»è­¦å‘Šç¯', cause_id: 'BATTERY_CHARGE', icon: 'charge' },
                { option_id: 'OIL', label: 'æ²¹åœ§è­¦å‘Šç¯', cause_id: 'ENGINE_OIL', icon: 'oil' },
                { option_id: 'ENGINE', label: 'ã‚¨ãƒ³ã‚¸ãƒ³è­¦å‘Šç¯', cause_id: 'ENGINE_WARNING', icon: 'engine' },
                { option_id: 'ABS', label: 'ABSï¼†ãƒ–ãƒ¬ãƒ¼ã‚­ã‚¢ã‚·ã‚¹ãƒˆè­¦å‘Šç¯', cause_id: 'BRAKE_SYSTEM', icon: 'abs' },
                { option_id: 'TYRE', label: 'ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§è­¦å‘Šç¯', cause_id: 'TYRE_PRESSURE', icon: 'tyre' },
                { option_id: 'OTHER', label: 'ãã®ä»–ãƒ»ã‚ã‹ã‚‰ãªã„', cause_id: 'OTHER_WARNING', icon: 'other' }
            ],
            t3_question: {
                question_id: 'Q_WARN_001',
                question_text: 'ç‚¹ç¯ã—ã¦ã„ã‚‹è­¦å‘Šç¯ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚<br><a href="https://manual.toyota.jp/aqua/2509/hev/ja_JP/contents/vhch07se020402.php" target="_blank" rel="noopener" style="color:#BF00FF; font-size:0.9em;">â€» å–èª¬ã€Œè­¦å‘Šç¯ãŒã¤ã„ãŸã¨ãã¯ã€ã§è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™</a>',
                answer_type: 'single_choice',
                options_ref: 'warning_light_options',
                priority: 1
            },
            action_cards_by_cause: {
                ENGINE_WARNING: [
                    { action_id: 'A_WARN_ENG', guide_id: null, title: 'ã‚¨ãƒ³ã‚¸ãƒ³è­¦å‘Šç¯ãŒç‚¹ç¯ã—ãŸã¨ãï¼ˆå–èª¬ch07æº–æ‹ ï¼‰', steps: ['ãƒãƒ«ãƒã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã«è¡¨ç¤ºã•ã‚Œã‚‹è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã™ã‚‹', 'è¡¨ç¤ºå†…å®¹ã«å¾“ã£ã¦å¯¾å‡¦ã™ã‚‹', 'ç‚¹ç¯ã—ãŸã¾ã¾ã®ã¨ãã¯ã‚·ã‚¹ãƒ†ãƒ ç•°å¸¸ã®ãŠãã‚ŒãŒã‚ã‚‹ãŸã‚ã€ãƒˆãƒ¨ã‚¿è²©å£²åº—ã§ç‚¹æ¤œã‚’å—ã‘ã¦ãã ã•ã„'], duration: null, required_items: [], risk_notice: 'ä½œå‹•ç¢ºèªã®ãŸã‚ãƒ‘ãƒ¯ãƒ¼ã‚¹ã‚¤ãƒƒãƒã‚’ONã«ã™ã‚‹ã¨ç‚¹ç¯ã—ã€æ•°ç§’å¾Œã¾ãŸã¯ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ å§‹å‹•ã§æ¶ˆç¯ã™ã‚‹ã®ãŒæ­£å¸¸ã§ã™ã€‚ç‚¹ç¯ã—ãªã„å ´åˆã‚‚ç‚¹æ¤œã‚’ã€‚', alternative: 'è²©å£²åº—ã¸', is_immediate: true },
                    { action_id: 'A_WARN_003', guide_id: null, title: 'è²©å£²åº—ã§ç‚¹æ¤œ', steps: ['ã‚¨ãƒ³ã‚¸ãƒ³è­¦å‘Šç¯ã®ç‚¹ç¯ã¨ã—ã¦ç‚¹æ¤œã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                BRAKE_SYSTEM: [
                    { action_id: 'A_WARN_001', guide_id: null, title: 'å®‰å…¨ãªå ´æ‰€ã«åœè»Šã—ã€ã™ãã«ç‚¹æ¤œã‚’', steps: ['é€Ÿã‚„ã‹ã«å®‰å…¨ãªå ´æ‰€ã¸åœè»Š', 'ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æ­¢ã‚ã‚‹', 'è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«é€£çµ¡'], duration: null, required_items: [], risk_notice: 'ãƒ–ãƒ¬ãƒ¼ã‚­ç³»çµ±ã®è­¦å‘Šã®ãŸã‚ã€èµ°è¡Œã¯é¿ã‘ã¦ãã ã•ã„ã€‚', alternative: null, is_immediate: true },
                    { action_id: 'A_WARN_003', guide_id: null, title: 'è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«é€£çµ¡', steps: ['ä½ç½®ãƒ»ç—‡çŠ¶ã‚’ä¼ãˆã¦å¼•ãå–ã‚Šãƒ»ç‚¹æ¤œã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                ENGINE_COOLANT: [
                    { action_id: 'A_WARN_002', guide_id: null, title: 'ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æ­¢ã‚ã¦å†·å´ã‚’ç¢ºèª', steps: ['å®‰å…¨ãªå ´æ‰€ã«åœè»Š', 'ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æ­¢ã‚ã¦å†·ã¾ã™', 'å†·å´æ°´ã®é‡ã‚’ç¢ºèªï¼ˆå–èª¬å‚ç…§ï¼‰'], duration: 'ç´„10åˆ†ä»¥ä¸Š', required_items: [], risk_notice: 'ç„¡ç†ã«èµ°è¡Œã™ã‚‹ã¨ã‚¨ãƒ³ã‚¸ãƒ³æå‚·ã®æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚', alternative: 'ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¸', is_immediate: true },
                    { action_id: 'A_WARN_003', guide_id: null, title: 'è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«é€£çµ¡', steps: ['ä½ç½®ãƒ»ç—‡çŠ¶ã‚’ä¼ãˆã¦ç‚¹æ¤œã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                ENGINE_OIL: [
                    { action_id: 'A_WARN_004', guide_id: null, title: 'ã‚ªã‚¤ãƒ«é‡ã‚’ç¢ºèª', steps: ['æ°´å¹³ãªå ´æ‰€ã«åœè»Šã™ã‚‹', 'ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æš–æ©Ÿã—ãŸå¾Œã€ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã‚’åœæ­¢ã™ã‚‹', '5åˆ†ä»¥ä¸ŠçµŒéã—ã¦ã‹ã‚‰ã€ãƒ¬ãƒ™ãƒ«ã‚²ãƒ¼ã‚¸ï¼ˆã‚ªã‚¤ãƒ«é‡è¨ˆæ¸¬æ£’ï¼‰ã§ã‚ªã‚¤ãƒ«é‡ã‚’ç¢ºèªã™ã‚‹'], duration: 'ç´„5åˆ†', required_items: [], risk_notice: 'ã‚ªã‚¤ãƒ«ä¸è¶³ã®å ´åˆã¯èµ°è¡Œã‚’æ§ãˆã€è£œå……ã¾ãŸã¯ç‚¹æ¤œã‚’ã€‚', alternative: 'è²©å£²åº—ã¸', is_immediate: true },
                    { action_id: 'A_WARN_003', guide_id: null, title: 'è²©å£²åº—ã§ç‚¹æ¤œ', steps: ['ã‚ªã‚¤ãƒ«äº¤æ›ãƒ»ç‚¹æ¤œã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                TYRE_PRESSURE: [
                    { action_id: 'A_WARN_005', guide_id: null, title: 'ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§ã‚’ç¢ºèªãƒ»è£œå……', steps: ['å®‰å…¨ãªå ´æ‰€ã«åœè»Š', 'ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§ã‚’è¨ˆæ¸¬ã—ã€è¦å®šå€¤ã«åˆã‚ã›ã‚‹'], duration: 'ç´„15åˆ†', required_items: ['ç©ºæ°—åœ§è¨ˆ'], risk_notice: null, alternative: 'ã‚¬ã‚½ãƒªãƒ³ã‚¹ã‚¿ãƒ³ãƒ‰ã‚„è²©å£²åº—ã§è£œå……', is_immediate: true },
                    { action_id: 'A_WARN_003', guide_id: null, title: 'è²©å£²åº—ãƒ»ã‚¬ã‚½ãƒªãƒ³ã‚¹ã‚¿ãƒ³ãƒ‰ã§ç¢ºèª', steps: ['ç©ºæ°—åœ§ãƒã‚§ãƒƒã‚¯ãƒ»è£œå……ã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                BATTERY_CHARGE: [
                    { action_id: 'A_WARN_006', guide_id: null, title: 'ãƒãƒƒãƒ†ãƒªãƒ¼å……é›»çŠ¶æ…‹ã‚’ç¢ºèª', steps: ['ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‹ã‹ã‚‹å ´åˆã¯ã—ã°ã‚‰ãèµ°è¡Œã—ã¦å……é›»', 'ã‹ã‹ã‚‰ãªã„å ´åˆã¯ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¸'], duration: null, required_items: [], risk_notice: null, alternative: 'ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹', is_immediate: true },
                    { action_id: 'A_WARN_003', guide_id: null, title: 'è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«é€£çµ¡', steps: ['ãƒãƒƒãƒ†ãƒªãƒ¼ç‚¹æ¤œãƒ»äº¤æ›ã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                _default: [
                    { action_id: 'A_WARN_003', guide_id: null, title: 'è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«é€£çµ¡', steps: ['è­¦å‘Šç¯ã®ç¨®é¡ãƒ»ç—‡çŠ¶ã‚’ä¼ãˆã¦ç‚¹æ¤œã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ]
            },
            escalation_option: { dealer: 'è²©å£²åº—äºˆç´„', road_service: 'ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹' }
        };

        const T16_KB_BLUETOOTH = {
            event_id: 'BLUETOOTH',
            cause_candidates: [
                { cause_id: 'NOT_PAIRED', description: 'ãƒšã‚¢ãƒªãƒ³ã‚°æœªè¨­å®š', required_observations: ['was_connected_before'], risk_level: 'low', action_group: 'pairing' },
                { cause_id: 'PAIRING_LOST', description: 'ãƒšã‚¢ãƒªãƒ³ã‚°ãŒè§£é™¤ã•ã‚ŒãŸ', required_observations: ['was_connected_before'], risk_level: 'low', action_group: 're_pair' },
                { cause_id: 'DEVICE_BUSY', description: 'ä»–æ©Ÿå™¨ã¨æ¥ç¶šä¸­', required_observations: ['was_connected_before'], risk_level: 'low', action_group: 'disconnect_other' },
                { cause_id: 'AUDIO_SETTING', description: 'ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªè¨­å®šãƒ»ã‚½ãƒ¼ã‚¹', required_observations: ['was_connected_before'], risk_level: 'low', action_group: 'guide' },
                { cause_id: 'HARDWARE_FAULT', description: 'æ©Ÿæã®ä¸èª¿', required_observations: ['was_connected_before'], risk_level: 'medium', action_group: 'dealer' }
            ],
            t3_question: {
                question_id: 'Q_BT_001',
                question_text: 'ä»¥å‰ã¯ã“ã®æ©Ÿç¨®ã§æ¥ç¶šã§ãã¦ã„ã¾ã—ãŸã‹ï¼Ÿ',
                answer_type: 'yes_no',
                expected_split: { yes: ['PAIRING_LOST', 'DEVICE_BUSY', 'AUDIO_SETTING', 'HARDWARE_FAULT'], no: ['NOT_PAIRED'] },
                label_yes: 'ã¯ã„ã€ä»¥å‰ã¯æ¥ç¶šã§ããŸ',
                label_no: 'ã„ã„ãˆã€åˆã‚ã¦æ¥ç¶šã™ã‚‹',
                priority: 1
            },
            action_cards_by_cause: {
                NOT_PAIRED: [
                    { action_id: 'A_BT_001', guide_id: null, title: 'ãƒšã‚¢ãƒªãƒ³ã‚°æ‰‹é †ã‚’å®Ÿè¡Œ', steps: ['è»Šè¼‰ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã§Bluetoothè¨­å®šã‚’é–‹ã', 'ã‚¹ãƒãƒ›ã®Bluetoothã‚’ONã«ã—ã€è»Šã®åå‰ã‚’é¸æŠ', 'ç”»é¢ã®æŒ‡ç¤ºã«å¾“ã£ã¦ãƒšã‚¢ãƒªãƒ³ã‚°'], duration: 'ç´„2åˆ†', required_items: [], risk_notice: null, alternative: 'å–èª¬ã®Bluetoothé …ç›®ã‚’å‚ç…§', is_immediate: true },
                    { action_id: 'A_BT_002', guide_id: null, title: 'å–èª¬ã§ãƒšã‚¢ãƒªãƒ³ã‚°æ‰‹é †ã‚’ç¢ºèª', steps: ['è»Šç¨®åˆ¥å–èª¬ã®ã€ŒBluetoothã€ã€Œã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã€ã®é …ç›®ã‚’é–‹ã'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                PAIRING_LOST: [
                    { action_id: 'A_BT_003', guide_id: null, title: 'ãƒšã‚¢ãƒªãƒ³ã‚°ã‚’ã‚„ã‚Šç›´ã™', steps: ['è»Šè¼‰å´ã§ç™»éŒ²æ©Ÿç¨®ã‹ã‚‰å½“æ©Ÿã‚’å‰Šé™¤', 'ã‚¹ãƒãƒ›å´ã§ã‚‚è»Šã‚’å‰Šé™¤', 'å†åº¦ãƒšã‚¢ãƒªãƒ³ã‚°æ‰‹é †ã‚’å®Ÿè¡Œ'], duration: 'ç´„3åˆ†', required_items: [], risk_notice: null, alternative: 'è²©å£²åº—ã§è¨­å®šç¢ºèª', is_immediate: true },
                    { action_id: 'A_BT_001', guide_id: null, title: 'ãƒšã‚¢ãƒªãƒ³ã‚°æ‰‹é †ã‚’å®Ÿè¡Œ', steps: ['è»Šè¼‰ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã§Bluetoothè¨­å®šã‚’é–‹ã', 'ã‚¹ãƒãƒ›ã®Bluetoothã‚’ONã«ã—ã€è»Šã®åå‰ã‚’é¸æŠ'], duration: 'ç´„2åˆ†', required_items: [], risk_notice: null, alternative: null, is_immediate: true }
                ],
                DEVICE_BUSY: [
                    { action_id: 'A_BT_004', guide_id: null, title: 'ä»–æ©Ÿå™¨ã®æ¥ç¶šã‚’è§£é™¤', steps: ['è»Šè¼‰ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã§æ¥ç¶šä¸­ã®æ©Ÿç¨®ã‚’åˆ‡æ–­', 'ã‚¹ãƒãƒ›ã®Bluetoothã§ä»–æ©Ÿå™¨ã‚’ã‚ªãƒ•', 'å†åº¦ã“ã®æ©Ÿç¨®ã§æ¥ç¶š'], duration: 'ç´„1åˆ†', required_items: [], risk_notice: null, alternative: null, is_immediate: true },
                    { action_id: 'A_BT_003', guide_id: null, title: 'ãƒšã‚¢ãƒªãƒ³ã‚°ã‚’ã‚„ã‚Šç›´ã™', steps: ['ç™»éŒ²å‰Šé™¤å¾Œã«å†ãƒšã‚¢ãƒªãƒ³ã‚°'], duration: 'ç´„3åˆ†', required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                AUDIO_SETTING: [
                    { action_id: 'A_BT_005', guide_id: null, title: 'ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚½ãƒ¼ã‚¹ã‚’Bluetoothã«åˆ‡ã‚Šæ›¿ãˆ', steps: ['ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªç”»é¢ã§ã‚½ãƒ¼ã‚¹ã‚’ã€ŒBluetoothã€ã«é¸æŠ', 'ã‚¹ãƒãƒ›ã§éŸ³æ¥½å†ç”Ÿã‚„é€šè©±ã‚’è©¦ã™'], duration: 'ç´„1åˆ†', required_items: [], risk_notice: null, alternative: null, is_immediate: true },
                    { action_id: 'A_BT_002', guide_id: null, title: 'å–èª¬ã§è¨­å®šã‚’ç¢ºèª', steps: ['ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ»Bluetoothã®é …ç›®ã‚’å‚ç…§'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                HARDWARE_FAULT: [
                    { action_id: 'A_BT_003', guide_id: null, title: 'ãƒšã‚¢ãƒªãƒ³ã‚°ã‚’ã‚„ã‚Šç›´ã—ã¦è©¦ã™', steps: ['å‰Šé™¤å¾Œã«å†ãƒšã‚¢ãƒªãƒ³ã‚°'], duration: 'ç´„3åˆ†', required_items: [], risk_notice: null, alternative: 'æ”¹å–„ã—ãªã„å ´åˆã¯è²©å£²åº—ã¸', is_immediate: true },
                    { action_id: 'A_BT_006', guide_id: null, title: 'è²©å£²åº—ã§ç‚¹æ¤œ', steps: ['ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ»Bluetoothã®ä¸èª¿ã¨ã—ã¦ç‚¹æ¤œã‚’ä¾é ¼'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ],
                _default: [
                    { action_id: 'A_BT_001', guide_id: null, title: 'ãƒšã‚¢ãƒªãƒ³ã‚°æ‰‹é †ã‚’å®Ÿè¡Œ', steps: ['è»Šè¼‰ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã¨ã‚¹ãƒãƒ›ã§Bluetoothè¨­å®šã‹ã‚‰æ¥ç¶š'], duration: 'ç´„2åˆ†', required_items: [], risk_notice: null, alternative: null, is_immediate: true },
                    { action_id: 'A_BT_002', guide_id: null, title: 'å–èª¬ã§ç¢ºèª', steps: ['Bluetoothãƒ»ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã®é …ç›®ã‚’å‚ç…§'], duration: null, required_items: [], risk_notice: null, alternative: null, is_immediate: false }
                ]
            },
            escalation_option: { dealer: 'è²©å£²åº—äºˆç´„', road_service: null }
        };

        const T16_KB_BY_EVENT = {
            DOOR_NOT_OPEN: T16_KB_DOOR_NOT_OPEN,
            WARNING_LIGHT: T16_KB_WARNING_LIGHT,
            BLUETOOTH: T16_KB_BLUETOOTH
        };

        let T16State = {
            t1Output: null,
            t2Output: null,
            t3Output: null,
            observationResult: null,
            t4Output: null,
            t5Output: null,
            lastActionId: null,
            step: null
        };

        var T3_SKIP_CONFIDENCE_THRESHOLD = 0.8;

        function runT1(userInput) {
            const s = (userInput || '').trim();
            var event_id = null;
            var subtype = null;
            var confidence = 0.85;
            if (/ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„|ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼.*é–‹ã‹ãªã„|ã‚­ãƒ¼é›»æ± åˆ‡ã‚Œ|é›»æ± åˆ‡ã‚Œã®è¡¨ç¤º/i.test(s)) {
                event_id = 'DOOR_NOT_OPEN';
                if (/ã‚­ãƒ¼é›»æ± åˆ‡ã‚Œã®è¡¨ç¤º|é›»æ± åˆ‡ã‚Œã®è¡¨ç¤º|é›»æ± ãŒåˆ‡ã‚Œ|é›»æ± åˆ‡ã‚Œ/i.test(s)) {
                    subtype = 'battery_indicator';
                    confidence = 0.95;
                }
            } else if (/è­¦å‘Šç¯ãŒç‚¹ç¯|è­¦å‘Šç¯.*ç‚¹ç¯|ãƒ©ãƒ³ãƒ—ãŒç‚¹ç¯|ã‚¨ãƒ³ã‚¸ãƒ³è­¦å‘Š/i.test(s)) {
                event_id = 'WARNING_LIGHT';
            } else if (/Bluetoothæ¥ç¶šãŒã§ããªã„|Bluetooth.*æ¥ç¶š|ãƒ–ãƒ«ãƒ¼ãƒˆã‚¥ãƒ¼ã‚¹.*ã¤ãªãŒã‚‰ãªã„|ãƒšã‚¢ãƒªãƒ³ã‚°/i.test(s)) {
                event_id = 'BLUETOOTH';
            }
            if (!event_id) return null;
            return {
                event_id: event_id,
                subtype: subtype,
                confidence: confidence,
                urgency: event_id === 'WARNING_LIGHT' ? 0.8 : 0.7,
                psychological_risk: event_id === 'WARNING_LIGHT' ? 'high' : 'high',
                context_labels: { time_band: 'day', location_type: 'outside', vehicle_state: 'stopped' },
                evidence: ['user_selected_symptom']
            };
        }

        function runT2(t1Output) {
            if (!t1Output || !t1Output.event_id) return null;
            var kb = T16_KB_BY_EVENT[t1Output.event_id];
            if (!kb) return null;
            var candidates = kb.cause_candidates;
            if (t1Output.event_id === 'DOOR_NOT_OPEN' && t1Output.subtype === 'battery_indicator') {
                candidates = candidates.filter(function(c) { return c.cause_id === 'KEY_BATTERY_EMPTY'; });
            }
            return { cause_candidates: candidates };
        }

        function runT3(t2Output, t1Output) {
            if (!t2Output || !t2Output.cause_candidates || !t1Output) return null;
            var kb = T16_KB_BY_EVENT[t1Output.event_id];
            return kb ? kb.t3_question : null;
        }

        function runT4(observationAnswer, t2Output, t3Output, evidenceFromFailure, t1Output) {
            if (!t2Output) return null;
            if (observationAnswer == null && !t3Output) {
                var causes = t2Output.cause_candidates || [];
                var n = causes.length;
                var ranked = causes.map(function(c) {
                    return { cause_id: c.cause_id, confidence: n === 1 ? 1.0 : 1 / n, evidence: [] };
                });
                return { ranked_causes: ranked, status: 'READY_FOR_ACTION' };
            }
            if (!t3Output) return null;
            if (t3Output.answer_type === 'single_choice' && t1Output && observationAnswer != null) {
                var kb = T16_KB_BY_EVENT[t1Output.event_id];
                var opts = kb && kb[t3Output.options_ref];
                var sel = opts && opts.find(function(o) { return o.option_id === observationAnswer; });
                if (sel) {
                    var ranked = [{ cause_id: sel.cause_id, confidence: 0.95, evidence: ['warning_light=' + observationAnswer] }];
                    return { ranked_causes: ranked, status: 'READY_FOR_ACTION' };
                }
            }
            var split = t3Output.expected_split;
            if (!split) return null;
            const isYes = observationAnswer === true || observationAnswer === 'yes' || observationAnswer === 'ã¯ã„';
            const favored = isYes ? (split.yes || []) : (split.no || []);
            const other = isYes ? (split.no || []) : (split.yes || []);
            const evidenceKey = 'key_indicator_light=' + (isYes ? 'yes' : 'no');
            var ranked = [];
            favored.forEach(cid => {
                ranked.push({ cause_id: cid, confidence: favored.length === 1 ? 0.72 : 0.5, evidence: [evidenceKey] });
            });
            if (ranked.length === 0) ranked.push({ cause_id: 'OTHER', confidence: 0.3, evidence: [] });
            other.forEach(cid => {
                ranked.push({ cause_id: cid, confidence: 0.15, evidence: [] });
            });
            ranked.sort((a, b) => b.confidence - a.confidence);
            if (evidenceFromFailure && (evidenceFromFailure.action_id === 'A_DOOR_004' || evidenceFromFailure.action_id === 'A_DOOR_005')) {
                ranked.forEach(function(r) {
                    if (r.cause_id === 'RADIO_INTERFERENCE') r.confidence *= 0.3;
                    else if (r.cause_id === 'LOCK_ACTUATOR_FAULT' || r.cause_id === 'VEHICLE_12V_LOW') r.confidence = Math.min(1, (r.confidence || 0.15) + 0.3);
                });
                ranked.sort((a, b) => b.confidence - a.confidence);
            }
            const top = ranked[0] && ranked[0].confidence || 0;
            const status = top >= 0.5 ? 'READY_FOR_ACTION' : 'MORE_OBSERVATION';
            return { ranked_causes: ranked, status };
        }

        function runT5(t4Output, t1Output) {
            if (!t1Output) return null;
            var kb = T16_KB_BY_EVENT[t1Output.event_id];
            if (!kb) return null;
            var defCards = (kb.action_cards_by_cause._default || []).slice(0, 3);
            if (!t4Output || t4Output.status === 'ESCALATE') {
                return { action_cards: defCards, escalation_option: kb.escalation_option };
            }
            const topCause = t4Output.ranked_causes && t4Output.ranked_causes[0] && t4Output.ranked_causes[0].cause_id;
            const cards = kb.action_cards_by_cause[topCause] || kb.action_cards_by_cause._default;
            const list = (Array.isArray(cards) ? cards : [cards]).slice(0, 3);
            return { action_cards: list, escalation_option: kb.escalation_option };
        }

        function runT6(resolved, actionId, t5Output, t1Output) {
            var event_id = (t1Output && t1Output.event_id) ? t1Output.event_id : 'DOOR_NOT_OPEN';
            if (resolved === true) {
                if (event_id === 'DOOR_NOT_OPEN') {
                    if (actionId === 'A_DOOR_005') {
                        return { resolved: true, next_step: 'done_with_next_steps', next_steps_guidance: [{ id: 'battery_replace_guide', label: 'ãã®ã‚­ãƒ¼ã®é›»æ± äº¤æ›ã®ã‚¬ã‚¤ãƒ‰', type: 'guide' }, { id: 'dealer_inspection', label: 'è²©å£²åº—ã§ã®ç‚¹æ¤œ', type: 'guide' }], spare_key_worked: true };
                    }
                    var isImmediateOnly = actionId === 'A_DOOR_001' || actionId === 'A_DOOR_004';
                    if (isImmediateOnly) {
                        return { resolved: true, next_step: 'done_with_next_steps', next_steps_guidance: [{ id: 'engine_start_guide', label: 'ã‚¨ãƒ³ã‚¸ãƒ³ã®ã‹ã‘æ–¹', type: 'guide' }, { id: 'battery_replace_guide', label: 'é›»æ± äº¤æ›ã®ã‚¬ã‚¤ãƒ‰', type: 'guide' }] };
                    }
                }
                return { resolved: true, next_step: 'done' };
            }
            if (event_id === 'DOOR_NOT_OPEN') {
                if (actionId === 'A_DOOR_001') {
                    return { resolved: false, next_step: 'retry_with_t4', evidence_from_failure: { action_id: 'A_DOOR_001', action_result: 'failed', summary: 'æ©Ÿæ¢°ã‚­ãƒ¼ã§è§£éŒ ã‚’è©¦ã—ãŸãŒé–‹ã‹ãªã‹ã£ãŸ' } };
                }
                if (actionId === 'A_DOOR_004') {
                    return { resolved: false, next_step: 'retry_with_t4', evidence_from_failure: { action_id: 'A_DOOR_004', action_result: 'failed', summary: 'ã‚­ãƒ¼ã‚’ãƒ‰ã‚¢ãƒãƒ³ãƒ‰ãƒ«ã«è¿‘ã¥ã‘ã¦å†è©¦è¡Œã—ãŸãŒé–‹ã‹ãªã‹ã£ãŸ' } };
                }
                if (actionId === 'A_DOOR_005') {
                    return { resolved: false, next_step: 'retry_with_t4', evidence_from_failure: { action_id: 'A_DOOR_005', action_result: 'failed', summary: 'äºˆå‚™ã‚­ãƒ¼ã§ã‚‚é–‹ã‹ãªã‹ã£ãŸ' } };
                }
            }
            return { resolved: false, next_step: 'escalate', handoff_payload: { event_id: event_id, actions_tried: [actionId || 'ä¸æ˜'], result_summary: 'è©¦ã—ãŸãŒæ”¹å–„ã—ãªã‹ã£ãŸã€‚' } };
        }

        function startT16Flow(userMessage) {
            const msg = (userMessage || '').trim();
            if (!msg) return;
            addTheme001Message('user', msg);

            const t1 = runT1(msg);
            if (!t1) return;
            T16State.t1Output = t1;
            T16State.t2Output = runT2(t1);
            var t2 = T16State.t2Output;
            var skipT3 = t2 && t2.cause_candidates && t2.cause_candidates.length === 1 && t1.confidence >= T3_SKIP_CONFIDENCE_THRESHOLD;

            if (skipT3) {
                T16State.t3Output = null;
                T16State.observationResult = null;
                T16State.t4Output = runT4(null, t2, null, undefined, t1);
                T16State.t5Output = runT5(T16State.t4Output, t1);
                T16State.step = 't5_actions';
                var cards = T16State.t5Output.action_cards || [];
                var card0 = cards[0];
                if (card0) {
                    var stepsHtml = '<strong>' + (card0.title || '') + '</strong><br><br>';
                    if (card0.steps && card0.steps.length) {
                        stepsHtml += '<strong>æ‰‹é †ï¼š</strong><br>';
                        card0.steps.forEach(function(s, i) { stepsHtml += (i + 1) + '. ' + s + '<br>'; });
                    }
                    if (card0.duration) stepsHtml += '<br>â± ' + card0.duration + '<br>';
                    if (card0.required_items && card0.required_items.length) stepsHtml += 'å¿…è¦ç‰©: ' + card0.required_items.join(', ') + '<br>';
                    if (card0.risk_notice) stepsHtml += '<br>âš ï¸ ' + card0.risk_notice + '<br>';
                    if (card0.alternative) stepsHtml += '<br>ã†ã¾ãã„ã‹ãªã„å ´åˆ: ' + card0.alternative + '<br>';
                    stepsHtml += '<br>è©¦ã—ãŸçµæœã‚’æ•™ãˆã¦ãã ã•ã„ï¼š<br>' +
                        '<div class="quick-reply-container">' +
                        '<div class="quick-reply" onclick="handleT16T6Result(true)">âœ… <span>ã†ã¾ãã„ã£ãŸ</span></div>' +
                        '<div class="quick-reply" onclick="handleT16T6Result(false)">âŒ <span>ã†ã¾ãã„ã‹ãªã‹ã£ãŸ</span></div>' +
                        '</div>';
                    if (cards.length > 1) {
                        stepsHtml += '<br><details style="margin-top:10px;"><summary style="cursor:pointer; font-size:0.9em; color:#aaa;">ãã®ä»–ã®é¸æŠè‚¢</summary>';
                        cards.slice(1).forEach(function(c) {
                            stepsHtml += '<div class="card" style="margin:6px 0; cursor:pointer; padding:8px;" onclick="handleT16ActionClick(\'' + (c.action_id || '') + '\')">' + (c.title || '') + '</div>';
                        });
                        stepsHtml += '</details>';
                    }
                    if (T16State.t5Output.escalation_option) {
                        stepsHtml += '<div style="margin-top: 10px; font-size: 0.9em; color: #aaa;">è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚‚é¸æŠã§ãã¾ã™</div>';
                    }
                    addTheme001Message('ai', stepsHtml);
                } else {
                    var introHtml = 'æ¬¡ã®å¯¾å‡¦ã‚’ã”æ¡ˆå†…ã—ã¾ã™ã€‚<br><br>';
                    cards.forEach(function(c) {
                        introHtml += '<div class="card" style="margin-bottom: 10px; cursor: pointer;" onclick="handleT16ActionClick(\'' + (c.action_id || '') + '\')">' +
                            '<div class="card-title">' + (c.title || '') + '</div></div>';
                    });
                    addTheme001Message('ai', introHtml);
                }
                return;
            }

            T16State.t3Output = runT3(t2, t1);
            T16State.step = 't3_question';
            const q = T16State.t3Output;
            if (t1.event_id === 'WARNING_LIGHT' && q.answer_type === 'single_choice' && q.options_ref) {
                var kb = T16_KB_BY_EVENT.WARNING_LIGHT;
                var opts = kb[q.options_ref] || [];
                var gridHtml = '<strong>ç¢ºèª</strong><br><br>' + (q.question_text || '') + '<br><br>' +
                    '<div style="display:grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">';
                opts.forEach(function(o) {
                    var iconUrl = (typeof WARNING_LIGHT_ICONS !== 'undefined' && WARNING_LIGHT_ICONS[o.icon]) ? WARNING_LIGHT_ICONS[o.icon] : '';
                    gridHtml += '<div class="card" style="cursor:pointer; margin-bottom:0; padding:10px; text-align:center;" onclick="handleT16T3Answer(\'' + (o.option_id || '') + '\')">' +
                        (iconUrl ? '<img src="' + iconUrl + '" alt="" style="width:48px; height:48px; margin:0 auto 6px; display:block;">' : '') +
                        '<span style="font-size:0.85em; color:#e0e0e0;">' + (o.label || o.option_id) + '</span></div>';
                });
                gridHtml += '</div>';
                addTheme001Message('ai', gridHtml);
                return;
            }
            var labelYes = (q && q.label_yes) ? q.label_yes : 'ã¯ã„';
            var labelNo = (q && q.label_no) ? q.label_no : 'ã„ã„ãˆ';
            const questionHtml = '<strong>ç¢ºèª</strong><br><br>' +
                (q.question_text || '') + '<br><br>' +
                '<div class="quick-reply-container">' +
                '<div class="quick-reply" onclick="handleT16T3Answer(\'yes\')">ğŸ’¡ <span>' + labelYes + '</span></div>' +
                '<div class="quick-reply" onclick="handleT16T3Answer(\'no\')">ğŸ”´ <span>' + labelNo + '</span></div>' +
                '</div>';
            addTheme001Message('ai', questionHtml);
        }

        function handleT16T3Answer(answerYesNo, optionLabel) {
            var label;
            if (optionLabel != null) label = optionLabel;
            else if (T16State.t1Output && T16State.t1Output.event_id === 'WARNING_LIGHT' && answerYesNo !== 'yes' && answerYesNo !== 'no') {
                var kb = T16_KB_BY_EVENT.WARNING_LIGHT;
                var opts = kb.warning_light_options || [];
                var sel = opts.find(function(o) { return o.option_id === answerYesNo; });
                label = sel ? sel.label : answerYesNo;
            } else label = answerYesNo === 'yes' ? 'ã¯ã„ã€ç‚¹ãã¾ã™' : 'ã„ã„ãˆã€ç‚¹ãã¾ã›ã‚“';
            addTheme001Message('user', label);

            T16State.observationResult = answerYesNo;
            T16State.t4Output = runT4(answerYesNo, T16State.t2Output, T16State.t3Output, undefined, T16State.t1Output);
            T16State.t5Output = runT5(T16State.t4Output, T16State.t1Output);
            var topCause = T16State.t4Output.ranked_causes && T16State.t4Output.ranked_causes[0] && T16State.t4Output.ranked_causes[0].cause_id;

            if (T16State.t1Output && T16State.t1Output.event_id === 'WARNING_LIGHT' && topCause === 'BRAKE_SYSTEM') {
                T16State.step = 'brake_urgent_done';
                var brakeHtml = '<strong style="color:#ff6b6b;">âš ï¸ ãƒ–ãƒ¬ãƒ¼ã‚­è­¦å‘Šç¯ãŒç‚¹ç¯ã—ã¦ã„ã¾ã™</strong><br><br>' +
                    'ãŸã ã¡ã«å®‰å…¨ãªå ´æ‰€ã«åœè»Šã—ã¦ãã ã•ã„ã€‚<br>ãƒ–ãƒ¬ãƒ¼ã‚­ç³»çµ±ã®è­¦å‘Šã®ãŸã‚ã€èµ°è¡Œã‚’ç¶šã‘ã‚‹ã¨å±é™ºã§ã™ã€‚<br><br>' +
                    '<strong>åœè»Šå¾Œã€æ¬¡ã®ã„ãšã‚Œã‹ã«é€£çµ¡ã—ã¦ãã ã•ã„ã€‚</strong><br><br>' +
                    '<div style="display:flex; flex-wrap:wrap; gap:10px;">' +
                    '<a href="tel:0120-XXX-XXX" class="button" style="text-decoration:none; display:inline-block; background:linear-gradient(135deg,#e53935 0%,#c62828 100%);">ğŸ“ ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«é›»è©±</a>' +
                    '<a href="tel:0120-XXX-XXX" class="button" style="text-decoration:none; display:inline-block; background:linear-gradient(135deg,#BF00FF 0%,#D200FF 100%);">ğŸ“ è²©å£²åº—ã«é€£çµ¡</a>' +
                    '</div>' +
                    '<div style="margin-top:12px; font-size:0.9em; color:#aaa;">â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ãŠæŒã¡ã®è»Šç¨®ãƒ»åœ°åŸŸã«å¿œã˜ãŸé€£çµ¡å…ˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</div>';
                addTheme001Message('ai', brakeHtml);
                return;
            }

            T16State.step = 't5_actions';
            const cards = T16State.t5Output.action_cards || [];
            var card0 = cards[0];
            if (card0) {
                var stepsHtml = '<strong>' + (card0.title || '') + '</strong><br><br>';
                if (card0.steps && card0.steps.length) {
                    stepsHtml += '<strong>æ‰‹é †ï¼š</strong><br>';
                    card0.steps.forEach(function(s, i) { stepsHtml += (i + 1) + '. ' + s + '<br>'; });
                }
                if (card0.duration) stepsHtml += '<br>â± ' + card0.duration + '<br>';
                if (card0.required_items && card0.required_items.length) stepsHtml += 'å¿…è¦ç‰©: ' + card0.required_items.join(', ') + '<br>';
                if (card0.risk_notice) stepsHtml += '<br>âš ï¸ ' + card0.risk_notice + '<br>';
                if (card0.alternative) stepsHtml += '<br>ã†ã¾ãã„ã‹ãªã„å ´åˆ: ' + card0.alternative + '<br>';
                stepsHtml += '<br>è©¦ã—ãŸçµæœã‚’æ•™ãˆã¦ãã ã•ã„ï¼š<br>' +
                    '<div class="quick-reply-container">' +
                    '<div class="quick-reply" onclick="handleT16T6Result(true)">âœ… <span>ã†ã¾ãã„ã£ãŸ</span></div>' +
                    '<div class="quick-reply" onclick="handleT16T6Result(false)">âŒ <span>ã†ã¾ãã„ã‹ãªã‹ã£ãŸ</span></div>' +
                    '</div>';
                if (cards.length > 1) {
                    stepsHtml += '<br><details style="margin-top:10px;"><summary style="cursor:pointer; font-size:0.9em; color:#aaa;">ãã®ä»–ã®é¸æŠè‚¢</summary>';
                    cards.slice(1).forEach(function(c) {
                        stepsHtml += '<div class="card" style="margin:6px 0; cursor:pointer; padding:8px;" onclick="handleT16ActionClick(\'' + (c.action_id || '') + '\')">' + (c.title || '') + '</div>';
                    });
                    stepsHtml += '</details>';
                }
                if (T16State.t1Output && T16State.t1Output.event_id === 'BLUETOOTH') {
                    stepsHtml += '<div style="margin-top: 15px; display: flex; flex-wrap: wrap; gap: 10px;">' +
                        '<div class="button" style="cursor: pointer; padding: 10px 14px; font-size: 0.9em;" onclick="showBluetoothStepGuide()">ğŸ“‹ ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹</div>' +
                        '<div class="button" style="cursor: pointer; padding: 10px 14px; font-size: 0.9em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="showBluetoothVideo()">ğŸ“‹ å‹•ç”»ã§è¦‹ã‚‹</div>' +
                        '</div>';
                }
                if (T16State.t5Output.escalation_option) {
                    stepsHtml += '<div style="margin-top: 10px; font-size: 0.9em; color: #aaa;">è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚‚é¸æŠã§ãã¾ã™</div>';
                }
                addTheme001Message('ai', stepsHtml);
            } else {
                var fallbackHtml = '';
                cards.forEach(function(c) {
                    fallbackHtml += '<div class="card" style="margin-bottom: 10px; cursor: pointer;" onclick="handleT16ActionClick(\'' + (c.action_id || '') + '\')">' +
                        '<div class="card-title">' + (c.title || '') + '</div></div>';
                });
                addTheme001Message('ai', fallbackHtml);
            }
        }

        function handleT16ActionClick(actionId) {
            T16State.lastActionId = actionId;
            const cards = (T16State.t5Output && T16State.t5Output.action_cards) || [];
            const card = cards.find(function(c) { return c.action_id === actionId; });
            if (!card) return;
            addTheme001Message('user', card.title || actionId);

            if (actionId === 'A_DOOR_002' && card.risk_notice) {
                T16State.step = 'battery_replace_choice';
                var choiceHtml = '<strong>' + (card.title || 'é›»æ± äº¤æ›') + '</strong><br><br>';
                choiceHtml += 'âš ï¸ ' + card.risk_notice + '<br><br>';
                choiceHtml += 'ã©ã¡ã‚‰ã§å¯¾å¿œã—ã¾ã™ã‹ï¼Ÿ<br>' +
                    '<div class="quick-reply-container">' +
                    '<div class="quick-reply" onclick="handleT16BatteryReplaceChoice(\'dealer\')">ğŸ¢ <span>è²©å£²åº—ã§äº¤æ›ã™ã‚‹</span></div>' +
                    '<div class="quick-reply" onclick="handleT16BatteryReplaceChoice(\'self\')">ğŸ”§ <span>è‡ªåˆ†ã§äº¤æ›ã™ã‚‹</span></div>' +
                    '</div>';
                addTheme001Message('ai', choiceHtml);
                return;
            }

            T16State.step = 't6_wait_result';
            var stepsHtml = '<strong>' + (card.title || '') + '</strong><br><br>';
            if (card.steps && card.steps.length) {
                stepsHtml += '<strong>æ‰‹é †ï¼š</strong><br>';
                card.steps.forEach(function(s, i) { stepsHtml += (i + 1) + '. ' + s + '<br>'; });
            }
            if (card.required_items && card.required_items.length) stepsHtml += '<br>å¿…è¦ç‰©: ' + card.required_items.join(', ') + '<br>';
            if (card.risk_notice) stepsHtml += '<br>âš ï¸ ' + card.risk_notice + '<br>';
            if (card.alternative) stepsHtml += '<br>ã†ã¾ãã„ã‹ãªã„å ´åˆ: ' + card.alternative + '<br>';
            var resultPrompt = actionId === 'A_DOOR_005' ? 'äºˆå‚™ã‚­ãƒ¼ã§è©¦ã—ãŸçµæœã‚’æ•™ãˆã¦ãã ã•ã„ï¼š' : 'è©¦ã—ãŸçµæœã‚’æ•™ãˆã¦ãã ã•ã„ï¼š';
            stepsHtml += '<br>' + resultPrompt + '<br>' +
                '<div class="quick-reply-container">' +
                '<div class="quick-reply" onclick="handleT16T6Result(true)">âœ… <span>ã†ã¾ãã„ã£ãŸ</span></div>' +
                '<div class="quick-reply" onclick="handleT16T6Result(false)">âŒ <span>ã†ã¾ãã„ã‹ãªã‹ã£ãŸ</span></div>' +
                '</div>';
            if (T16State.t1Output && T16State.t1Output.event_id === 'BLUETOOTH') {
                stepsHtml += '<div style="margin-top: 15px; display: flex; flex-wrap: wrap; gap: 10px;">' +
                    '<div class="button" style="cursor: pointer; padding: 10px 14px; font-size: 0.9em;" onclick="showBluetoothStepGuide()">ğŸ“‹ ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹</div>' +
                    '<div class="button" style="cursor: pointer; padding: 10px 14px; font-size: 0.9em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="showBluetoothVideo()">ğŸ¥ å‹•ç”»ã§è¦‹ã‚‹</div>' +
                    '</div>';
            }
            addTheme001Message('ai', stepsHtml);
        }

        function handleT16BatteryReplaceChoice(choice) {
            if (choice === 'dealer') {
                addTheme001Message('user', 'è²©å£²åº—ã§äº¤æ›ã™ã‚‹');
                addTheme001Message('ai', '<strong>è²©å£²åº—ã§ã®é›»æ± äº¤æ›</strong><br><br>' +
                    'ãƒˆãƒ¨ã‚¿è²©å£²åº—ã§é›»æ± äº¤æ›ã‚’ä¾é ¼ã§ãã¾ã™ã€‚<br><br>' +
                    '<strong>é€£çµ¡æ–¹æ³•ï¼š</strong><br>' +
                    'ãƒ»é›»è©±ã§äºˆç´„: 0120-XXX-XXX<br>' +
                    'ãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„: è²©å£²åº—æ¤œç´¢ãƒšãƒ¼ã‚¸ã‹ã‚‰äºˆç´„<br><br>' +
                    '<strong>äºˆç´„æ™‚ã®æº–å‚™ï¼š</strong><br>' +
                    'ãƒ»è»Šç¨®ãƒ»å¹´å¼<br>ãƒ»ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ç¨®é¡<br>ãƒ»å¸Œæœ›æ—¥æ™‚<br><br>' +
                    'â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ã€ä½ç½®æƒ…å ±ã«åŸºã¥ã„ãŸæœ€å¯„ã‚Šã®è²©å£²åº—ã‚’è¡¨ç¤ºã—ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><br>' +
                    'ä»–ã«ã”è³ªå•ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ');
                T16State.step = null;
                return;
            }
            addTheme001Message('user', 'è‡ªåˆ†ã§äº¤æ›ã™ã‚‹');
            T16State.step = 't6_wait_result';
            var card = (T16State.t5Output && T16State.t5Output.action_cards || []).find(function(c) { return c.action_id === 'A_DOOR_002'; });
            if (!card) card = { title: 'æ’ä¹…å¯¾å¿œï¼šé›»æ± äº¤æ›', steps: ['CR2032ï¼ˆã¾ãŸã¯CR2450ï¼‰ã‚’ç”¨æ„', 'ã‚­ãƒ¼ã‚’é–‹ã‘ã¦é›»æ± ã‚’äº¤æ›', 'å‹•ä½œç¢ºèª'], required_items: ['CR2032 ã¾ãŸã¯ CR2450ï¼ˆãƒœã‚¿ãƒ³é›»æ± ï¼‰'], risk_notice: 'éƒ¨å“ç ´æã®æã‚ŒãŒã‚ã‚‹ãŸã‚ã€æ…é‡ã«ä½œæ¥­ã—ã¦ãã ã•ã„ã€‚', alternative: 'é›»æ± è³¼å…¥å…ˆã®æ¡ˆå†…ã¸' };
            var stepsHtml = '<strong>è‡ªåˆ†ã§é›»æ± äº¤æ›ã‚’ã™ã‚‹å ´åˆ</strong><br><br>';
            stepsHtml += '<strong>æ‰‹é †ï¼š</strong><br>';
            (card.steps || []).forEach(function(s, i) { stepsHtml += (i + 1) + '. ' + s + '<br>'; });
            if (card.required_items && card.required_items.length) stepsHtml += '<br>å¿…è¦ç‰©: ' + card.required_items.join(', ') + '<br>';
            if (card.risk_notice) stepsHtml += '<br>âš ï¸ ' + card.risk_notice + '<br>';
            if (card.alternative) stepsHtml += '<br>ã†ã¾ãã„ã‹ãªã„å ´åˆ: ' + card.alternative + '<br>';
            stepsHtml += '<br>é›»æ± äº¤æ›å¾Œã€ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã‹ï¼Ÿ<br>' +
                '<div class="quick-reply-container">' +
                '<div class="quick-reply" onclick="handleT16T6Result(true)">âœ… <span>ã†ã¾ãã„ã£ãŸ</span></div>' +
                '<div class="quick-reply" onclick="handleT16T6Result(false)">âŒ <span>ã†ã¾ãã„ã‹ãªã‹ã£ãŸ</span></div>' +
                '</div>';
            addTheme001Message('ai', stepsHtml);
        }

        function handleT16T6Result(resolved) {
            const label = resolved ? 'ã†ã¾ãã„ã£ãŸ' : 'ã†ã¾ãã„ã‹ãªã‹ã£ãŸ';
            addTheme001Message('user', label);
            const t6 = runT6(resolved, T16State.lastActionId, T16State.t5Output, T16State.t1Output);

            if (t6.next_step === 'retry_with_t4') {
                T16State.t4Output = runT4(T16State.observationResult, T16State.t2Output, T16State.t3Output, t6.evidence_from_failure, T16State.t1Output);
                T16State.t5Output = runT5(T16State.t4Output, T16State.t1Output);
                T16State.step = 't5_actions';
                var cards = T16State.t5Output.action_cards || [];
                var card0 = cards[0];
                if (card0) {
                    var stepsHtml = '<strong>' + (card0.title || '') + '</strong><br><br>';
                    if (card0.steps && card0.steps.length) {
                        stepsHtml += '<strong>æ‰‹é †ï¼š</strong><br>';
                        card0.steps.forEach(function(s, i) { stepsHtml += (i + 1) + '. ' + s + '<br>'; });
                    }
                    if (card0.duration) stepsHtml += '<br>â± ' + card0.duration + '<br>';
                    if (card0.required_items && card0.required_items.length) stepsHtml += 'å¿…è¦ç‰©: ' + card0.required_items.join(', ') + '<br>';
                    if (card0.risk_notice) stepsHtml += '<br>âš ï¸ ' + card0.risk_notice + '<br>';
                    if (card0.alternative) stepsHtml += '<br>ã†ã¾ãã„ã‹ãªã„å ´åˆ: ' + card0.alternative + '<br>';
                    stepsHtml += '<br>è©¦ã—ãŸçµæœã‚’æ•™ãˆã¦ãã ã•ã„ï¼š<br>' +
                        '<div class="quick-reply-container">' +
                        '<div class="quick-reply" onclick="handleT16T6Result(true)">âœ… <span>ã†ã¾ãã„ã£ãŸ</span></div>' +
                        '<div class="quick-reply" onclick="handleT16T6Result(false)">âŒ <span>ã†ã¾ãã„ã‹ãªã‹ã£ãŸ</span></div>' +
                        '</div>';
                    if (cards.length > 1) {
                        stepsHtml += '<br><details style="margin-top:10px;"><summary style="cursor:pointer; font-size:0.9em; color:#aaa;">ãã®ä»–ã®é¸æŠè‚¢</summary>';
                        cards.slice(1).forEach(function(c) {
                            stepsHtml += '<div class="card" style="margin:6px 0; cursor:pointer; padding:8px;" onclick="handleT16ActionClick(\'' + (c.action_id || '') + '\')">' + (c.title || '') + '</div>';
                        });
                        stepsHtml += '</details>';
                    }
                    if (T16State.t5Output.escalation_option) {
                        stepsHtml += '<div style="margin-top: 10px; font-size: 0.9em; color: #aaa;">è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚‚é¸æŠã§ãã¾ã™</div>';
                    }
                    addTheme001Message('ai', stepsHtml);
                } else {
                    var aiHtml = 'åˆ¥ã®å¯¾å‡¦ã‚’ã”æ¡ˆå†…ã—ã¾ã™ã€‚<br><br>';
                    cards.forEach(function(c) {
                        aiHtml += '<div class="card" style="margin-bottom: 10px; cursor: pointer;" onclick="handleT16ActionClick(\'' + (c.action_id || '') + '\')">' +
                            '<div class="card-title">' + (c.title || '') + '</div></div>';
                    });
                    addTheme001Message('ai', aiHtml);
                }
                return;
            }

            var aiHtml = '';
            if (t6.next_step === 'done') {
                aiHtml = '<strong>ã‚ˆã‹ã£ãŸã§ã™ã€‚è§£æ±ºã—ã¾ã—ãŸã€‚</strong><br><br>ã¾ãŸå›°ã£ãŸã“ã¨ãŒã‚ã‚Œã°ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚';
            } else if (t6.next_step === 'done_with_next_steps') {
                if (T16State.t1Output && T16State.t1Output.event_id === 'DOOR_NOT_OPEN' && (T16State.lastActionId === 'A_DOOR_005' || t6.spare_key_worked)) {
                    aiHtml = '<strong>äºˆå‚™ã‚­ãƒ¼ã§é–‹ã‘ã‚‰ã‚Œã¦ã‚ˆã‹ã£ãŸã§ã™ã€‚</strong><br><br>ä»ŠãŠä½¿ã„ã®ã‚­ãƒ¼å´ã®ä¸èª¿ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®ã‚­ãƒ¼ã®é›»æ± äº¤æ›ã‚„è²©å£²åº—ã§ã®ç‚¹æ¤œã‚’ã”æ¡ˆå†…ã—ã¾ã™ã€‚<br><br>';
                } else if (T16State.t1Output && T16State.t1Output.event_id === 'DOOR_NOT_OPEN') {
                    aiHtml = '<strong>ãƒ‰ã‚¢ã‚’é–‹ã‘ã‚‰ã‚Œã¦ã‚ˆã‹ã£ãŸã§ã™ã€‚</strong><br><br>æ¬¡ã«ã€é›»æ± äº¤æ›ã‚’ã—ã¦ãŠãã¨ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§é–‹ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><br>';
                } else {
                    aiHtml = '<strong>ã‚ˆã‹ã£ãŸã§ã™ã€‚è§£æ±ºã—ã¾ã—ãŸã€‚</strong><br><br>';
                }
                if (t6.next_steps_guidance && t6.next_steps_guidance.length) {
                    t6.next_steps_guidance.forEach(function(g) { aiHtml += 'ãƒ»' + (g.label || g.id) + '<br>'; });
                }
            } else if (t6.next_step === 'escalate') {
                aiHtml = '<strong>å°‚é–€å®¶ã¸ã”æ¡ˆå†…</strong><br><br>è©¦ã—ã¦ã„ãŸã ã„ãŸå†…å®¹ã‚’ã¾ã¨ã‚ã¦ã€è²©å£²åº—ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ãŒå¼•ãç¶™ãã‚„ã™ãã—ã¦ã„ã¾ã™ã€‚<br><br>' +
                    'ğŸ“ ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹: 0120-XXX-XXXï¼ˆ24æ™‚é–“ï¼‰<br>ğŸ“ è²©å£²åº—: 0120-XXX-XXX';
            } else {
                aiHtml = 'æ¬¡ã®å¯¾å¿œã‚’ã”æ¡ˆå†…ã—ã¾ã™ã€‚';
            }
            addTheme001Message('ai', aiHtml);
            T16State.step = null;
        }

        // Bluetoothã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ï¼‰
        var currentBluetoothStep = 1;
        var totalBluetoothSteps = 5;
        var bluetoothStepsData = [
            { title: 'è¨­å®šç”»é¢ã‚’é–‹ã', content: 'ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã®ãƒ›ãƒ¼ãƒ ç”»é¢ã‹ã‚‰ã€Œâš™ï¸ è¨­å®šã€ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¾ã™ã€‚<br><br>ã¾ãŸã¯ã€ã‚¹ãƒ†ã‚¢ãƒªãƒ³ã‚°ãƒ›ã‚¤ãƒ¼ãƒ«ã®ã€ŒMENUã€ãƒœã‚¿ãƒ³ã‚’é•·æŠ¼ã—ã—ã¦ã‚‚è¨­å®šç”»é¢ãŒé–‹ãã¾ã™ã€‚' },
            { title: 'Bluetoothãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠ', content: 'â€¢ è¨­å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒğŸ“¡ Bluetoothã€ã‚’é¸æŠ<br>â€¢ BluetoothãŒã‚ªãƒ•ã®å ´åˆã¯ã€Œã‚ªãƒ³ã«ã™ã‚‹ã€ã‚’ã‚¿ãƒƒãƒ—<br>â€¢ ç”»é¢ã«ã€Œæ¤œç´¢ä¸­...ã€ã¨è¡¨ç¤ºã•ã‚Œã¾ã™' },
            { title: 'ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã‚’æ¤œå‡ºå¯èƒ½ã«ã™ã‚‹', content: '<strong>ğŸ“± iPhoneã®å ´åˆï¼š</strong><br>â€¢ ã€Œè¨­å®šã€â†’ã€ŒBluetoothã€ã‚’é–‹ã<br>â€¢ Bluetoothã‚’ã‚ªãƒ³ã«ã™ã‚‹ã¨è‡ªå‹•çš„ã«æ¤œå‡ºå¯èƒ½ã«ãªã‚Šã¾ã™<br><br><strong>ğŸ“± Androidã®å ´åˆï¼š</strong><br>â€¢ ã€Œè¨­å®šã€â†’ã€Œæ¥ç¶šæ¸ˆã¿ã®ãƒ‡ãƒã‚¤ã‚¹ã€â†’ã€ŒBluetoothã€ã‚’é–‹ã<br>â€¢ ã€Œæ–°ã—ã„ãƒ‡ãƒã‚¤ã‚¹ã¨ãƒšã‚¢è¨­å®šã™ã‚‹ã€ã‚’ã‚¿ãƒƒãƒ—' },
            { title: 'ãƒ‡ãƒã‚¤ã‚¹ã‚’é¸æŠã—ã¦ãƒšã‚¢ãƒªãƒ³ã‚°', content: 'â€¢ è»Šã®ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã«è¡¨ç¤ºã•ã‚ŒãŸã€Œåˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒã‚¤ã‚¹ã€ãƒªã‚¹ãƒˆã‹ã‚‰ã€ã‚ãªãŸã®ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³åã‚’æ¢ã—ã¦ã‚¿ãƒƒãƒ—<br><br>â€¢ è»Šã¨ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®ä¸¡æ–¹ã«åŒã˜PINã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™<br><br>â€¢ <strong style="color: #BF00FF;">PINã‚³ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª</strong>ã—ã¦ãã ã•ã„' },
            { title: 'ãƒšã‚¢ãƒªãƒ³ã‚°ã‚’æ‰¿èª', content: 'â€¢ è»Šã®ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã§ã€Œãƒšã‚¢ãƒªãƒ³ã‚°ã€ã¾ãŸã¯ã€Œæ¥ç¶šã€ã‚’ã‚¿ãƒƒãƒ—<br><br>â€¢ ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€Œãƒšã‚¢ãƒªãƒ³ã‚°ã€ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œãƒšã‚¢ãƒªãƒ³ã‚°ã€ã‚’ã‚¿ãƒƒãƒ—<br><br>â€¢ ã€Œâœ… æ¥ç¶šã—ã¾ã—ãŸã€ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰å®Œäº†ï¼' }
        ];

        function showBluetoothStepGuide() {
            currentBluetoothStep = 1;
            var modal = document.getElementById('bluetoothStepGuideModal');
            if (modal) { modal.style.display = 'block'; renderBluetoothStepModal(); }
        }

        function closeBluetoothStepGuide() {
            var modal = document.getElementById('bluetoothStepGuideModal');
            if (modal) modal.style.display = 'none';
        }

        function renderBluetoothStepModal() {
            var container = document.getElementById('bluetoothStepGuideContent');
            if (!container) return;
            var step = bluetoothStepsData[currentBluetoothStep - 1];
            var nextBtn = currentBluetoothStep < totalBluetoothSteps
                ? '<button class="button" onclick="nextBluetoothStep()" style="flex: 2; background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%);">æ¬¡ã¸ â†’</button>'
                : '<button class="button" onclick="completeBluetoothGuide()" style="flex: 2; background: linear-gradient(135deg, #00d084 0%, #00b96d 100%);">âœ“ å®Œäº†</button>';
            var prevBtn = currentBluetoothStep > 1 ? '<button class="button" onclick="previousBluetoothStep()" style="flex: 1; background: #444;">â† å‰ã¸</button>' : '';
            container.innerHTML = '<div style="color: #BF00FF; font-weight: 600; margin-bottom: 10px;">ã‚¹ãƒ†ãƒƒãƒ— ' + currentBluetoothStep + '/' + totalBluetoothSteps + '</div>' +
                '<div class="card" style="margin-bottom: 15px;"><div class="card-title">' + (step.title || '') + '</div><div class="card-content" style="line-height: 1.7;">' + (step.content || '') + '</div></div>' +
                '<div style="display: flex; gap: 10px; margin-bottom: 15px;">' + prevBtn + nextBtn + '</div>' +
                '<button class="button" onclick="closeBluetoothStepGuide()" style="background: #555; width: 100%;">é–‰ã˜ã‚‹</button>';
        }

        function nextBluetoothStep() {
            if (currentBluetoothStep < totalBluetoothSteps) { currentBluetoothStep++; renderBluetoothStepModal(); }
        }

        function previousBluetoothStep() {
            if (currentBluetoothStep > 1) { currentBluetoothStep--; renderBluetoothStepModal(); }
        }

        function completeBluetoothGuide() {
            var container = document.getElementById('bluetoothStepGuideContent');
            if (!container) return;
            container.innerHTML = '<div class="card" style="text-align: center; border: 2px solid #00d084;"><div class="card-content" style="padding: 30px 20px;">' +
                '<div style="font-size: 3em; margin-bottom: 15px;">ğŸ‰</div>' +
                '<div style="font-size: 1.3em; font-weight: bold; color: #00d084; margin-bottom: 10px;">Bluetoothæ¥ç¶šå®Œäº†ï¼</div>' +
                '<div style="color: #aaa; font-size: 0.95em; line-height: 1.7;">æ¬¡å›ã‹ã‚‰ã¯ã€ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ã‹ã‘ã‚‹ã¨è‡ªå‹•çš„ã«æ¥ç¶šã•ã‚Œã¾ã™ã€‚</div>' +
                '<button class="button" onclick="closeBluetoothStepGuide()" style="margin-top: 20px; background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%);">é–‰ã˜ã‚‹</button></div></div>';
        }

        function showBluetoothVideo() {
            addTheme001Message('user', 'å‹•ç”»ã§è¦‹ã‚‹');
            addTheme001Message('ai', '<strong>ğŸ¥ å‹•ç”»ã§è¦‹ã‚‹</strong><br><br>Bluetoothæ¥ç¶šã®æ‰‹é †å‹•ç”»ã¯æº–å‚™ä¸­ã§ã™ã€‚<br>ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚ã¾ãŸã¯ã€Œã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹ã€ã§æ‰‹é †ã‚’ç¢ºèªã§ãã¾ã™ã€‚');
        }

        function setQuestion(question) {
            document.getElementById('searchInput').value = question;
            performSearch();
        }

        function performSearch() {
            const query = document.getElementById('searchInput').value.trim();
            const resultDiv = document.getElementById('searchResult');
            const defaultContent = document.getElementById('defaultContent');

            if (!query) {
                alert('è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            try { recordOemQuestion(query, 'enduser'); } catch (e) {}

            // ã€Œãƒ‰ã‚¢ãŒé–‹ã‹ãªã„ã€ã¯ T1-T6 ãƒ•ãƒ­ãƒ¼ã§ãƒãƒ£ãƒƒãƒˆã«æ¥ç¶š
            if (query === 'ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„' || query.indexOf('ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„') !== -1) {
                switchToChatTabProgrammatic(true);
                setTimeout(function() { startT16Flow(query); }, 50);
                return;
            }

            defaultContent.classList.add('hidden');
            resultDiv.innerHTML = '<div class="loading">å›ç­”ã‚’ç”Ÿæˆä¸­</div>';
            resultDiv.classList.remove('hidden');

            setTimeout(() => {
                displayAnswer(query);
            }, 1000);
        }

        function switchToChatTabProgrammatic(skipInit) {
            document.querySelectorAll('.tab-item').forEach(function(t) {
                if ((t.getAttribute('onclick') || '').indexOf("'chat'") !== -1) t.classList.add('active');
                else t.classList.remove('active');
            });
            showChatScreen(skipInit ? { skipInit: true } : undefined);
        }

        function displayAnswer(query) {
            const resultDiv = document.getElementById('searchResult');
            
            let response = qaDatabase[query];
            
            if (!response) {
                for (let key in qaDatabase) {
                    if (query.includes(key.substring(0, 3)) || key.includes(query.substring(0, 3))) {
                        response = qaDatabase[key];
                        break;
                    }
                }
            }

            if (!response) {
                response = {
                    intent: 'æ“ä½œæ–¹æ³•ã‚¬ã‚¤ãƒ‰',
                    urgency: 'low',
                    answer: `
                        <strong>ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“</strong><br><br>
                        ã€Œ${query}ã€ã«é–¢ã™ã‚‹æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚<br><br>
                        ä»¥ä¸‹ã®æ–¹æ³•ã‚’ãŠè©¦ã—ãã ã•ã„ï¼š<br>
                        â€¢ åˆ¥ã®è¨€è‘‰ã§è³ªå•ã—ã¦ã¿ã‚‹<br>
                        â€¢ ã‚ˆãã‚ã‚‹è³ªå•ã‹ã‚‰é¸æŠã™ã‚‹<br>
                        â€¢ è²©å£²åº—ã«ç›´æ¥ãŠå•ã„åˆã‚ã›ãã ã•ã„<br><br>
                        <strong>è©¦ã—ã¦ã¿ã‚‹è³ªå•ä¾‹ï¼š</strong><br>
                        â€¢ ã€Œãƒ‰ã‚¢ãŒé–‹ã‹ãªã„ã€<br>
                        â€¢ ã€ŒBluetoothæ¥ç¶šã¯ã©ã†ã‚„ã£ã¦ã‚„ã‚‹ã®ï¼Ÿã€<br>
                        â€¢ ã€Œè­¦å‘Šç¯ãŒç‚¹ç¯ã—ãŸã€
                    `,
                    actions: [
                        { label: 'è²©å£²åº—ã«ç›¸è«‡', type: 'primary' }
                    ]
                };
            }

            const cardClass = response.urgency === 'high' ? 'card alert-card' : 'card';
            const intentBadge = response.urgency === 'high' ? 
                '<span class="badge" style="background: #ff6b6b; color: white;">ç·Šæ€¥</span>' : 
                '<span class="badge badge-info">é€šå¸¸</span>';

            let html = `
                <div class="chat-message user">
                    <div class="chat-bubble user">${query}</div>
                </div>
                <div class="chat-message ai">
                    <div class="chat-bubble ai" style="max-width: 100%;">
                        <div style="margin-bottom: 10px;">
                            ${intentBadge}
                            <span class="badge" style="background: #6c757d; color: white;">${response.intent}</span>
                        </div>
                        ${response.answer}
            `;

            if (response.actions && response.actions.length > 0) {
                html += '<div style="margin-top: 15px;">';
                response.actions.forEach(action => {
                    const buttonStyle = action.type === 'primary' ? 
                        'background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%); color: #1A1A1A;' : 
                        'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;';
                    
                    let onclick = '';
                    if (action.label === 'ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹') {
                        onclick = 'onclick="showBluetoothStepGuide()"';
                    }
                    
                    html += `<div class="button" style="${buttonStyle} margin-right: 10px; cursor: pointer;" ${onclick}>${action.label}</div>`;
                });
                html += '</div>';
            }

            html += `
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="button" onclick="resetSearch()" style="background: #6c757d;">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
                </div>
            `;

            resultDiv.innerHTML = html;
        }

        function resetSearch() {
            document.getElementById('searchInput').value = '';
            document.getElementById('searchResult').classList.add('hidden');
            document.getElementById('defaultContent').classList.remove('hidden');
        }

        // ãƒãƒ£ãƒƒãƒˆç”»é¢ã‚’è¡¨ç¤º
        function showChatScreen(options) {
            const resultDiv = document.getElementById('searchResult');
            const defaultContent = document.getElementById('defaultContent');
            
            defaultContent.classList.add('hidden');
            
            var t = translations[currentLang] || translations.ja;
            
            resultDiv.innerHTML = `
                <!-- ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é ˜åŸŸ -->
                <div id="chatMessages"></div>

                <!-- ãƒãƒ£ãƒƒãƒˆå…¥åŠ›æ¬„ -->
                <div style="position: sticky; bottom: 0; background: #1A1A1A; padding: 15px 0; margin-top: 20px; border-top: 1px solid rgba(191, 0, 255, 0.3);">
                    <div style="display: flex; gap: 10px; align-items: flex-end;">
                        <textarea id="chatInput" 
                                  placeholder="${t['chat-placeholder']}" 
                                  style="flex: 1.2; 
                                         background: rgba(45, 53, 97, 0.6); 
                                         color: #e0e0e0; 
                                         border: 1px solid rgba(191, 0, 255, 0.3); 
                                         border-radius: 12px; 
                                         padding: 12px; 
                                         font-size: 0.95em; 
                                         resize: none; 
                                         min-height: 45px; 
                                         max-height: 100px; 
                                         font-family: inherit;"
                                  rows="1"
                                  onkeypress="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); sendChatMessage(); }"></textarea>
                        <button onclick="sendChatMessage()" 
                                class="button" 
                                style="background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%); 
                                       color: #ffffff; 
                                       padding: 10px 16px; 
                                       border: none; 
                                       cursor: pointer; 
                                       font-weight: 600;
                                       height: 45px;
                                       display: flex;
                                       align-items: center;
                                       flex-shrink: 0;">
                            <span>${t['btn-send']}</span>
                        </button>
                    </div>
                    <div style="font-size: 0.8em; color: #888; margin-top: 8px;">
                        ğŸ’¡ Shift+Enterã§æ”¹è¡Œã§ãã¾ã™
                    </div>
                </div>
            `;
            
            resultDiv.classList.remove('hidden');
            document.getElementById('homeContent').scrollTop = 0;

            if (!options || !options.skipInit) {
                initTheme001Chat();
            }
        }

        // THEME-001 ç”¨ãƒãƒ£ãƒƒãƒˆ: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ ãƒ˜ãƒ«ãƒ‘ãƒ¼
        function addTheme001Message(sender, html) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;

            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;

            const bubble = document.createElement('div');
            bubble.className = `chat-bubble ${sender}`;
            bubble.innerHTML = html;

            messageDiv.appendChild(bubble);
            chatMessages.appendChild(messageDiv);

            // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ€ä¸‹éƒ¨ã«
            const homeContent = document.getElementById('homeContent');
            if (homeContent) {
                homeContent.scrollTop = homeContent.scrollHeight;
            }
        }

        // THEME-001 ç”¨ãƒãƒ£ãƒƒãƒˆ: åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆT1-T6 é§†å‹•ã«çµ±ä¸€ï¼‰
        function initTheme001Chat() {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            chatMessages.innerHTML = '';

            var userName = 'è¼æ˜';
            addTheme001Message('ai', `${userName}${t('chat-intro-name')}<br><br>
${t('chat-intro-quick')}
<div class="quick-reply-container">
  <div class="quick-reply" onclick="startT16Flow('ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§ãƒ‰ã‚¢ãŒé–‹ã‹ãªã„')">
    ğŸ”‘ <span>${t('chat-quick-door')}</span>
  </div>
  <div class="quick-reply" onclick="startT16Flow('ã‚­ãƒ¼é›»æ± åˆ‡ã‚Œã®è¡¨ç¤ºãŒå‡ºã¦ã„ã‚‹')">
    ğŸ”‹ <span>${t('chat-quick-battery')}</span>
  </div>
  <div class="quick-reply" onclick="startT16Flow('è­¦å‘Šç¯ãŒç‚¹ç¯')">
    âš ï¸ <span>${t('chat-quick-warning')}</span>
  </div>
  <div class="quick-reply" onclick="startT16Flow('Bluetoothæ¥ç¶šãŒã§ããªã„')">
    ğŸ“± <span>Bluetooth${t('quick-bluetooth')}</span>
  </div>
</div>`);
        }

        // THEME-001: çŠ¶æ³åˆ¥ã®ç°¡æ˜“ã‚¬ã‚¤ãƒ‰
        function handleTheme001Situation(type) {
            if (type === 'battery') {
                addTheme001Message('user', 'ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒå…‰ã‚‰ãªã„ / åå¿œãŒå¼±ã„');
                addTheme001Message('ai', `<strong>é›»æ± åˆ‡ã‚Œã®å¯èƒ½æ€§ãŒé«˜ã„ã§ã™</strong><br><br>
ã¾ãšã¯ãƒ‰ã‚¢ã‚’é–‹ã‘ã‚‹ãŸã‚ã«ã€ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã«å†…è”µã•ã‚Œã¦ã„ã‚‹ã€Œæ©Ÿæ¢°ã‚­ãƒ¼ã€ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚<br><br>
<strong>ä»Šã™ãã§ãã‚‹ã“ã¨ï¼š</strong><br>
ãƒ»ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼å´é¢ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€æ©Ÿæ¢°ã‚­ãƒ¼ã‚’å–ã‚Šå‡ºã™<br>
ãƒ»é‹è»¢å¸­ãƒ‰ã‚¢ã®éµç©´ã«å·®ã—è¾¼ã‚“ã§å›ã™ã¨ã€ãƒ‰ã‚¢ã‚’é–‹ã‘ã‚‰ã‚Œã¾ã™<br><br>
<strong>æ¬¡ã«ã€ã©ã†ã—ãŸã„ã§ã™ã‹ï¼Ÿ</strong><br><br>
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001BatteryChoice('mechanical')">
    ğŸ”‘ <span>ã¾ãšã¯æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹ã‘ã‚‹</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001BatteryChoice('replace')">
    ğŸ”‹ <span>é›»æ± äº¤æ›ã—ãŸã„</span>
  </div>
</div>`);
            } else if (type === 'interference') {
                addTheme001Message('user', 'ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã¯å…‰ã‚‹ãŒã€ã‚¯ãƒ«ãƒãŒåå¿œã—ãªã„');
                addTheme001Message('ai', `<strong>é›»æ³¢å¹²æ¸‰ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™</strong><br><br>
æ¬¡ã®ã‚ˆã†ãªå ´æ‰€ã§ã¯ã€å‘¨å›²ã®å¼·ã„é›»æ³¢ã®å½±éŸ¿ã§ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒåå¿œã—ã«ãããªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚<br>
ãƒ»ç©ºæ¸¯ã‚„æ”¾é€å±€ã€æºå¸¯é›»è©±åŸºåœ°å±€ã®è¿‘ã<br>
ãƒ»å¤§ããªé€é›»ç·šãƒ»å¤‰é›»æ–½è¨­ã®è¿‘ã ãªã©<br><br>
<strong>å¯¾å‡¦ã®ãƒã‚¤ãƒ³ãƒˆï¼š</strong><br>
1. ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã‚’ãƒ‰ã‚¢ãƒãƒ³ãƒ‰ãƒ«ã«ã§ãã‚‹ã ã‘è¿‘ã¥ã‘ã¦æ“ä½œã—ã¦ã¿ã‚‹<br>
2. å¯èƒ½ã§ã‚ã‚Œã°ã€æ•°ãƒ¡ãƒ¼ãƒˆãƒ«ã ã‘å ´æ‰€ã‚’ç§»å‹•ã—ã¦å†åº¦è©¦ã™<br>
3. ãã‚Œã§ã‚‚ãƒ€ãƒ¡ãªå ´åˆã¯ã€æ©Ÿæ¢°ã‚­ãƒ¼ã§ãƒ‰ã‚¢ã‚’é–‹ã‘ã¦ä¸€æ™‚çš„ã«åˆ©ç”¨ã™ã‚‹<br><br>
â€» è©³ã—ã„é›»æ³¢å¹²æ¸‰ã‚¬ã‚¤ãƒ‰ï¼ˆGUIDE-008ï¼‰ã¯ã€åˆ¥ç”»é¢ã§å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹æƒ³å®šã§ã™ã€‚<br><br>
è©¦ã—ã¦ã¿ãŸçµæœã«è¿‘ã„ã‚‚ã®ã‚’æ•™ãˆã¦ãã ã•ã„ï¼š
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001InterferenceResult('resolved')">
    âœ… <span>è©¦ã—ãŸã‚‰æ­£å¸¸ã«é–‹ãã‚ˆã†ã«ãªã£ãŸ</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001InterferenceResult('still_bad')">
    âŒ <span>è©¦ã—ã¦ã‚‚æ”¹å–„ã—ãªã„ / ä¸å®‰ãŒæ®‹ã‚‹</span>
  </div>
</div>`);
            } else {
                addTheme001Message('user', 'ã‚ˆãåˆ†ã‹ã‚‰ãªã„ / ç¢ºèªãŒé›£ã—ã„');
                addTheme001Message('ai', `<strong>ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã§ã¯ã€ã‚ˆã‚Šå®‰å…¨å´ã§ã”æ¡ˆå†…ã—ã¾ã™ã€‚</strong><br><br>
ãƒ»ã¾ãšã¯æ©Ÿæ¢°ã‚­ãƒ¼ã§ãƒ‰ã‚¢ã‚’é–‹ã‘ã‚‰ã‚Œã‚‹ã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚<br>
ãƒ»ãã®ã†ãˆã§ã€ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®é›»æ± äº¤æ›ã‹ã€è²©å£²åº—ã§ã®ç‚¹æ¤œã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚<br><br>
ã“ã®ãƒãƒ£ãƒƒãƒˆã§ã¯æµã‚Œã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã€å®Ÿéš›ã®è©³ç´°æ‰‹é †ã‚„è²©å£²åº—æ¤œç´¢ã¯ã€<br>
ã€ŒDIGITAL OMã€ã®æœ¬ç•ªç”»é¢ã§APIé€£æºã—ã¦å®Ÿç¾ã™ã‚‹æƒ³å®šã§ã™ã€‚`);
            }
        }

        // THEME-001: é›»æ± åˆ‡ã‚Œæ™‚ã®é¸æŠï¼ˆæ©Ÿæ¢°ã‚­ãƒ¼ or é›»æ± äº¤æ›ï¼‰
        function handleTheme001BatteryChoice(choice) {
            if (choice === 'mechanical') {
                addTheme001Message('user', 'ã¾ãšã¯æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹ã‘ã‚‹');
                addTheme001Message('ai', `<strong>æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹éŒ ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†</strong><br><br>
<strong>æ©Ÿæ¢°ã‚­ãƒ¼ã®å–ã‚Šå‡ºã—æ–¹ï¼š</strong><br>
1. ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼å´é¢ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™<br>
2. æ©Ÿæ¢°ã‚­ãƒ¼ãŒå–ã‚Šå‡ºã›ã¾ã™<br><br>
<strong>é–‹éŒ æ–¹æ³•ï¼š</strong><br>
1. é‹è»¢å¸­ãƒ‰ã‚¢ã®éµç©´ã«æ©Ÿæ¢°ã‚­ãƒ¼ã‚’å·®ã—è¾¼ã¿ã¾ã™<br>
2. å›ã™ã¨ãƒ‰ã‚¢ã‚’é–‹ã‘ã‚‰ã‚Œã¾ã™<br><br>
æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹éŒ ã§ãã¾ã—ãŸã‹ï¼Ÿ
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001MechanicalResult('opened')">
    âœ… <span>é–‹ã„ãŸï¼</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001MechanicalResult('not_opened')">
    âŒ <span>é–‹ã‹ãªã‹ã£ãŸ</span>
  </div>
</div>`);
            } else if (choice === 'replace') {
                addTheme001Message('user', 'é›»æ± äº¤æ›ã—ãŸã„');
                addTheme001Message('ai', `<strong>é›»æ± äº¤æ›ã«ã¤ã„ã¦</strong><br><br>
é›»æ± ã¯ã”è‡ªèº«ã§äº¤æ›ã§ãã¾ã™ãŒã€éƒ¨å“ãŒç ´æã™ã‚‹ãŠãã‚ŒãŒã‚ã‚‹ã®ã§ã€<br>
ãƒˆãƒ¨ã‚¿è²©å£²åº—ã§äº¤æ›ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚<br><br>
ã©ã¡ã‚‰ã§å¯¾å¿œã—ãŸã„ã§ã™ã‹ï¼Ÿ
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001ReplaceChoice('self')">
    ğŸ”§ <span>è‡ªåˆ†ã§äº¤æ›ã—ãŸã„</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001ReplaceChoice('dealer')">
    ğŸ¢ <span>è²©å£²åº—ã§äº¤æ›ã—ãŸã„</span>
  </div>
</div>`);
            }
        }

        // THEME-001: æ©Ÿæ¢°ã‚­ãƒ¼é–‹éŒ çµæœ
        function handleTheme001MechanicalResult(result) {
            if (result === 'opened') {
                addTheme001Message('user', 'é–‹ã„ãŸï¼');
                addTheme001Message('ai', `<strong>ã‚ˆã‹ã£ãŸã§ã™ï¼ãƒ‰ã‚¢ã‚’é–‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚</strong><br><br>
æ¬¡ã«ã€ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®é›»æ± äº¤æ›ã‚’ã—ã¦ãŠãã¨ã€æ¬¡å›ã‹ã‚‰ã¯ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§é–‹ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><br>
é›»æ± äº¤æ›ã¯ã€ã”è‡ªèº«ã§äº¤æ›ã™ã‚‹ã‹ã€è²©å£²åº—ã§äº¤æ›ã™ã‚‹ã‹ã‚’é¸ã¹ã¾ã™ã€‚<br>
ã©ã¡ã‚‰ã«ã—ã¾ã™ã‹ï¼Ÿ
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001ReplaceChoice('self')">
    ğŸ”§ <span>è‡ªåˆ†ã§äº¤æ›ã—ãŸã„</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001ReplaceChoice('dealer')">
    ğŸ¢ <span>è²©å£²åº—ã§äº¤æ›ã—ãŸã„</span>
  </div>
</div>`);
            } else {
                addTheme001Message('user', 'é–‹ã‹ãªã‹ã£ãŸ');
                addTheme001Message('ai', `<strong>æ©Ÿæ¢°ã‚­ãƒ¼ã§ã‚‚é–‹ã‹ãªã„å ´åˆã¯ã€ãƒ‰ã‚¢ãƒ­ãƒƒã‚¯ã®æ•…éšœã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</strong><br><br>
ã“ã®å ´åˆã¯ã€ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¾ãŸã¯è²©å£²åº—ã«ã”é€£çµ¡ãã ã•ã„ã€‚<br><br>
<strong>ç·Šæ€¥é€£çµ¡å…ˆï¼š</strong><br>
ãƒ»ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹: 0120-XXX-XXXï¼ˆ24æ™‚é–“å¯¾å¿œï¼‰<br>
ãƒ»æœ€å¯„ã‚Šã®è²©å£²åº—: 0120-XXX-XXX<br><br>
â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ã€ä½ç½®æƒ…å ±ã«åŸºã¥ã„ãŸæœ€å¯„ã‚Šã®è²©å£²åº—ã‚„ãƒ­ãƒ¼ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚`);
            }
        }

        // THEME-001: é›»æ± äº¤æ›ã®é¸æŠï¼ˆè‡ªåˆ†ã§ or è²©å£²åº—ï¼‰
        function handleTheme001ReplaceChoice(choice) {
            if (choice === 'self') {
                addTheme001Message('user', 'è‡ªåˆ†ã§äº¤æ›ã—ãŸã„');
                addTheme001Message('ai', `<strong>è‡ªåˆ†ã§é›»æ± äº¤æ›ã‚’ã™ã‚‹å ´åˆ</strong><br><br>
<strong>äº‹å‰ã«æº–å‚™ã™ã‚‹ã‚‚ã®ï¼š</strong><br>
ãƒ»ãƒã‚¤ãƒŠã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼<br>
ãƒ»å°ã•ã„ãƒã‚¤ãƒŠã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼<br>
ãƒ»ãƒªãƒã‚¦ãƒ é›»æ± ï¼šCR2450<br><br>
<strong>âš ï¸ æ³¨æ„ï¼š</strong><br>
éƒ¨å“ãŒç ´æã™ã‚‹ãŠãã‚ŒãŒã‚ã‚‹ã®ã§ã€æ…é‡ã«ä½œæ¥­ã—ã¦ãã ã•ã„ã€‚<br>
ä¸å®‰ãªå ´åˆã¯ã€è²©å£²åº—ã§äº¤æ›ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚<br><br>
æº–å‚™ç‰©ã¯æƒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001PreparationCheck('ready')">
    âœ… <span>æƒã£ã¦ã„ã‚‹</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001PreparationCheck('not_ready')">
    âŒ <span>æƒã£ã¦ã„ãªã„ï¼ˆç‰¹ã«é›»æ± ï¼‰</span>
  </div>
</div>`);
            } else if (choice === 'dealer') {
                addTheme001Message('user', 'è²©å£²åº—ã§äº¤æ›ã—ãŸã„');
                addTheme001Message('ai', `<strong>è²©å£²åº—ã§ã®é›»æ± äº¤æ›</strong><br><br>
ãƒˆãƒ¨ã‚¿è²©å£²åº—ã§é›»æ± äº¤æ›ã‚’ä¾é ¼ã§ãã¾ã™ã€‚<br><br>
<strong>é€£çµ¡æ–¹æ³•ï¼š</strong><br>
ãƒ»é›»è©±ã§äºˆç´„: 0120-XXX-XXX<br>
ãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„: è²©å£²åº—æ¤œç´¢ãƒšãƒ¼ã‚¸ã‹ã‚‰äºˆç´„<br><br>
<strong>äºˆç´„æ™‚ã®æº–å‚™ï¼š</strong><br>
ãƒ»è»Šç¨®ãƒ»å¹´å¼<br>
ãƒ»ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ç¨®é¡<br>
ãƒ»å¸Œæœ›æ—¥æ™‚<br><br>
â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ã€ä½ç½®æƒ…å ±ã«åŸºã¥ã„ãŸæœ€å¯„ã‚Šã®è²©å£²åº—ã‚’è¡¨ç¤ºã—ã€<br>
ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><br>
ä»–ã«ã”è³ªå•ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ`);
            }
        }

        // THEME-001: æº–å‚™ç‰©ã®ç¢ºèª
        function handleTheme001PreparationCheck(status) {
            if (status === 'ready') {
                addTheme001Message('user', 'æƒã£ã¦ã„ã‚‹');
                addTheme001Message('ai', `<strong>ãã‚Œã§ã¯ã€é›»æ± äº¤æ›ã‚’å®Ÿæ–½ã—ã¾ã—ã‚‡ã†</strong><br><br>
<strong>é›»æ± äº¤æ›æ‰‹é †ï¼š</strong><br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 1: ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ã‚«ãƒãƒ¼ã‚’å¤–ã™</strong><br>
ãƒ»å°ã•ã„ãƒã‚¤ãƒŠã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ä½¿ã£ã¦ã€ã‚«ãƒãƒ¼ã‚’æ…é‡ã«å¤–ã—ã¾ã™<br>
ãƒ»åŠ›ã‚’å…¥ã‚Œã™ãã‚‹ã¨ç ´æã™ã‚‹ãŠãã‚ŒãŒã‚ã‚Šã¾ã™<br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 2: å¤ã„é›»æ± ã‚’å–ã‚Šå‡ºã™</strong><br>
ãƒ»ãƒã‚¤ãƒŠã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã§é›»æ± ã‚’å¤–ã—ã¾ã™<br>
ãƒ»é›»æ± ã®å‘ãã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼ˆ+/-ã®å‘ãï¼‰<br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 3: æ–°ã—ã„é›»æ± ã‚’å–ã‚Šä»˜ã‘ã‚‹</strong><br>
ãƒ»CR2450é›»æ± ã‚’æ­£ã—ã„å‘ãã§å–ã‚Šä»˜ã‘ã¾ã™<br>
ãƒ»ã‚«ãƒãƒ¼ã‚’å…ƒã«æˆ»ã—ã¾ã™<br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 4: å‹•ä½œç¢ºèª</strong><br>
ãƒ»ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒå…‰ã‚‹ã‹ç¢ºèªã—ã¾ã™<br><br>
é›»æ± äº¤æ›å¾Œã€ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã‹ï¼Ÿ
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001ReplaceResult('solved')">
    âœ… <span>æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001ReplaceResult('not_solved')">
    âŒ <span>ã¾ã å‹•ä½œã—ãªã„</span>
  </div>
</div>`);
            } else if (status === 'not_ready') {
                addTheme001Message('user', 'æƒã£ã¦ã„ãªã„ï¼ˆç‰¹ã«é›»æ± ï¼‰');
                addTheme001Message('ai', `<strong>é›»æ± ã®è³¼å…¥æ–¹æ³•ã‚’ã”æ¡ˆå†…ã—ã¾ã™</strong><br><br>
<strong>ãƒªãƒã‚¦ãƒ é›»æ± CR2450ã®å…¥æ‰‹å…ˆï¼š</strong><br><br>
<strong>1. ã‚ªãƒ³ãƒ©ã‚¤ãƒ³è³¼å…¥</strong><br>
ãƒ»Amazon: <a href="https://amazon.co.jp/s?k=CR2450" target="_blank" style="color: #BF00FF;">CR2450ã‚’æ¤œç´¢</a><br>
ãƒ»æ¥½å¤©å¸‚å ´: <a href="https://search.rakuten.co.jp/search/mall/CR2450/" target="_blank" style="color: #BF00FF;">CR2450ã‚’æ¤œç´¢</a><br>
ãƒ»ä¾¡æ ¼ç›®å®‰: Â¥200-500<br><br>
<strong>2. åº—èˆ—è³¼å…¥</strong><br>
ãƒ»ãƒˆãƒ¨ã‚¿è²©å£²åº—<br>
ãƒ»æ™‚è¨ˆåº—<br>
ãƒ»ã‚«ãƒ¡ãƒ©åº—<br>
ãƒ»å®¶é›»é‡è²©åº—ï¼ˆé›»æ± ã‚³ãƒ¼ãƒŠãƒ¼ï¼‰<br><br>
<strong>3. è¿‘ãã®åº—èˆ—ã‚’æ¢ã™</strong><br>
â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ã€ä½ç½®æƒ…å ±ã«åŸºã¥ã„ã¦æœ€å¯„ã‚Šã®åº—èˆ—ã‚’æ¤œç´¢ã§ãã¾ã™ã€‚<br><br>
é›»æ± ã‚’å…¥æ‰‹ã§ãã¾ã—ãŸã‹ï¼Ÿ
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001BatteryPurchase('purchased')">
    âœ… <span>å…¥æ‰‹ã—ãŸ</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001BatteryPurchase('not_purchased')">
    âŒ <span>å…¥æ‰‹ã§ããªã„ / è²©å£²åº—ã§äº¤æ›ã—ãŸã„</span>
  </div>
</div>`);
            }
        }

        // THEME-001: é›»æ± è³¼å…¥çµæœ
        function handleTheme001BatteryPurchase(result) {
            if (result === 'purchased') {
                addTheme001Message('user', 'å…¥æ‰‹ã—ãŸ');
                addTheme001Message('ai', `<strong>ãã‚Œã§ã¯ã€é›»æ± äº¤æ›ã‚’å®Ÿæ–½ã—ã¾ã—ã‚‡ã†</strong><br><br>
<strong>é›»æ± äº¤æ›æ‰‹é †ï¼š</strong><br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 1: ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ã‚«ãƒãƒ¼ã‚’å¤–ã™</strong><br>
ãƒ»å°ã•ã„ãƒã‚¤ãƒŠã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ä½¿ã£ã¦ã€ã‚«ãƒãƒ¼ã‚’æ…é‡ã«å¤–ã—ã¾ã™<br>
ãƒ»åŠ›ã‚’å…¥ã‚Œã™ãã‚‹ã¨ç ´æã™ã‚‹ãŠãã‚ŒãŒã‚ã‚Šã¾ã™<br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 2: å¤ã„é›»æ± ã‚’å–ã‚Šå‡ºã™</strong><br>
ãƒ»ãƒã‚¤ãƒŠã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã§é›»æ± ã‚’å¤–ã—ã¾ã™<br>
ãƒ»é›»æ± ã®å‘ãã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼ˆ+/-ã®å‘ãï¼‰<br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 3: æ–°ã—ã„é›»æ± ã‚’å–ã‚Šä»˜ã‘ã‚‹</strong><br>
ãƒ»CR2450é›»æ± ã‚’æ­£ã—ã„å‘ãã§å–ã‚Šä»˜ã‘ã¾ã™<br>
ãƒ»ã‚«ãƒãƒ¼ã‚’å…ƒã«æˆ»ã—ã¾ã™<br><br>
<strong>ã‚¹ãƒ†ãƒƒãƒ— 4: å‹•ä½œç¢ºèª</strong><br>
ãƒ»ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒå…‰ã‚‹ã‹ç¢ºèªã—ã¾ã™<br><br>
é›»æ± äº¤æ›å¾Œã€ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã‹ï¼Ÿ
<div class="quick-reply-container">
  <div class="quick-reply" onclick="handleTheme001ReplaceResult('solved')">
    âœ… <span>æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ</span>
  </div>
  <div class="quick-reply" onclick="handleTheme001ReplaceResult('not_solved')">
    âŒ <span>ã¾ã å‹•ä½œã—ãªã„</span>
  </div>
</div>`);
            } else if (result === 'not_purchased') {
                addTheme001Message('user', 'å…¥æ‰‹ã§ããªã„ / è²©å£²åº—ã§äº¤æ›ã—ãŸã„');
                addTheme001Message('ai', `<strong>è²©å£²åº—ã§ã®é›»æ± äº¤æ›</strong><br><br>
ãƒˆãƒ¨ã‚¿è²©å£²åº—ã§é›»æ± äº¤æ›ã‚’ä¾é ¼ã§ãã¾ã™ã€‚<br><br>
<strong>é€£çµ¡æ–¹æ³•ï¼š</strong><br>
ãƒ»é›»è©±ã§äºˆç´„: 0120-XXX-XXX<br>
ãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„: è²©å£²åº—æ¤œç´¢ãƒšãƒ¼ã‚¸ã‹ã‚‰äºˆç´„<br><br>
<strong>äºˆç´„æ™‚ã®æº–å‚™ï¼š</strong><br>
ãƒ»è»Šç¨®ãƒ»å¹´å¼<br>
ãƒ»ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã®ç¨®é¡<br>
ãƒ»å¸Œæœ›æ—¥æ™‚<br><br>
â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ã€ä½ç½®æƒ…å ±ã«åŸºã¥ã„ãŸæœ€å¯„ã‚Šã®è²©å£²åº—ã‚’è¡¨ç¤ºã—ã€<br>
ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><br>
ä»–ã«ã”è³ªå•ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ`);
            }
        }

        // THEME-001: é›»æ± äº¤æ›çµæœ
        function handleTheme001ReplaceResult(result) {
            if (result === 'solved') {
                addTheme001Message('user', 'æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ');
                addTheme001Message('ai', `<strong>ğŸ‰ å•é¡ŒãŒè§£æ±ºã—ã¾ã—ãŸï¼</strong><br><br>
ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚<br><br>
<strong>ä»Šå¾Œã®äºˆé˜²ç­–ï¼š</strong><br>
ãƒ»é›»æ± ã®å¯¿å‘½ã¯ç´„1-2å¹´ã§ã™<br>
ãƒ»ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒå…‰ã‚‰ãªã„å ´åˆã¯ã€æ—©ã‚ã«é›»æ± äº¤æ›ã‚’æ¤œè¨ã—ã¦ãã ã•ã„<br>
ãƒ»äºˆå‚™ã®é›»æ± ã‚’å¸¸å‚™ã—ã¦ãŠãã¨å®‰å¿ƒã§ã™<br><br>
ä»–ã«ã”è³ªå•ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ`);
            } else if (result === 'not_solved') {
                addTheme001Message('user', 'ã¾ã å‹•ä½œã—ãªã„');
                addTheme001Message('ai', `<strong>é›»æ± äº¤æ›ã§ã‚‚è§£æ±ºã—ãªã„å ´åˆ</strong><br><br>
é›»æ± äº¤æ›ã‚’ã—ã¦ã‚‚å‹•ä½œã—ãªã„å ´åˆã¯ã€ä»¥ä¸‹ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š<br><br>
<strong>1. è»Šä¸¡ã®ãƒãƒƒãƒ†ãƒªãƒ¼ä¸ŠãŒã‚Š</strong><br>
ãƒ»è»Šã®é›»è£…å“ï¼ˆãƒ©ã‚¤ãƒˆã€ã‚¨ã‚¢ã‚³ãƒ³ãªã©ï¼‰ã¯å‹•ä½œã—ã¾ã™ã‹ï¼Ÿ<br>
ãƒ»å‹•ä½œã—ãªã„å ´åˆã¯ã€ãƒãƒƒãƒ†ãƒªãƒ¼ä¸ŠãŒã‚Šã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™<br><br>
<strong>2. ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼æœ¬ä½“ã®æ•…éšœ</strong><br>
ãƒ»äºˆå‚™ã®ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã§ã‚‚åŒã˜ç—‡çŠ¶ã§ã™ã‹ï¼Ÿ<br>
ãƒ»äºˆå‚™ã‚­ãƒ¼ã§å‹•ä½œã™ã‚‹å ´åˆã¯ã€å…ƒã®ã‚­ãƒ¼ã®æ•…éšœã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™<br><br>
<strong>3. è»Šä¸¡å´ã®æ•…éšœ</strong><br>
ãƒ»è²©å£²åº—ã§ã®ç‚¹æ¤œã‚’ãŠã™ã™ã‚ã—ã¾ã™<br><br>
<strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼š</strong><br>
è²©å£²åº—ã«ã”é€£çµ¡ã„ãŸã ãã€ç‚¹æ¤œã‚’ä¾é ¼ã—ã¦ãã ã•ã„ã€‚<br>
ãƒ»é›»è©±: 0120-XXX-XXX<br>
ãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„: è²©å£²åº—æ¤œç´¢ãƒšãƒ¼ã‚¸ã‹ã‚‰äºˆç´„<br><br>
â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ã€ä½ç½®æƒ…å ±ã«åŸºã¥ã„ãŸæœ€å¯„ã‚Šã®è²©å£²åº—ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚`);
            }
        }

        // THEME-001: é›»æ³¢å¹²æ¸‰å¾Œã®åˆ†å²
        function handleTheme001InterferenceResult(result) {
            if (result === 'resolved') {
                addTheme001Message('user', 'è©¦ã—ãŸã‚‰æ­£å¸¸ã«é–‹ãã‚ˆã†ã«ãªã£ãŸ');
                addTheme001Message('ai', `<strong>ã‚ˆã‹ã£ãŸã§ã™ï¼å•é¡Œã¯è§£æ¶ˆã—ãŸã‚ˆã†ã§ã™ã€‚</strong><br><br>
ä»Šå›ã®ã‚ˆã†ãªå ´æ‰€ã§ã¯ã€ä¸€æ™‚çš„ã«ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãŒåå¿œã—ã«ãããªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€<br>
è»Šä¸¡ã‚„ã‚­ãƒ¼ãã®ã‚‚ã®ã®æ•…éšœã§ã¯ãªã„ã‚±ãƒ¼ã‚¹ãŒã»ã¨ã‚“ã©ã§ã™ã€‚<br><br>
å¿µã®ãŸã‚ã€ä»Šå¾ŒåŒã˜ã‚ˆã†ãªå ´æ‰€ã§åŒã˜ç¾è±¡ãŒç¹°ã‚Šè¿”ã•ã‚Œã‚‹å ´åˆã¯ã€<br>
è²©å£²åº—ã§ã®ç‚¹æ¤œã‚‚ã”æ¤œè¨ãã ã•ã„ã€‚<br><br>
ä»–ã«ã‚‚æ°—ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Œã°ã€å…¥åŠ›ã—ã¦ã¿ã¦ãã ã•ã„ã€‚`);
            } else {
                addTheme001Message('user', 'è©¦ã—ã¦ã‚‚æ”¹å–„ã—ãªã„ / ä¸å®‰ãŒæ®‹ã‚‹');
                addTheme001Message('ai', `<strong>æ”¹å–„ã—ãªã„å ´åˆã¯ã€ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼æœ¬ä½“ã‚„è»Šä¸¡å´ã®ä¸å…·åˆã®å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚</strong><br><br>
å®‰å…¨ã®ãŸã‚ã€è²©å£²åº—ã§ã®ç‚¹æ¤œã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚<br><br>
æ¬¡ã®ã‚ˆã†ãªè¡Œå‹•ãŒã§ãã¾ã™ï¼š<br>
ãƒ»ä»Šã¯æ©Ÿæ¢°ã‚­ãƒ¼ã§é–‹é–‰ã—ã¤ã¤ã€è¿‘ã„ã†ã¡ã«è²©å£²åº—ã§ç‚¹æ¤œã‚’ä¾é ¼ã™ã‚‹<br>
ãƒ»ã™ãã«ç›¸è«‡ã—ãŸã„å ´åˆã¯ã€ãŠè¿‘ãã®ãƒˆãƒ¨ã‚¿è²©å£²åº—ã«é€£çµ¡ã™ã‚‹<br><br>
â€» å®Ÿéš›ã®ç”»é¢ã§ã¯ã€ã€Œè²©å£²åº—ã‚’æ¢ã™ã€ã€Œäºˆç´„ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‹ã‚‰ã€<br>
ãŠå®¢æ§˜ã®ä½ç½®æƒ…å ±ã«å¿œã˜ãŸåº—èˆ—æ¤œç´¢ã‚„äºˆç´„ãŒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹æƒ³å®šã§ã™ã€‚`);
            }
        }

        // ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const messageText = input.value.trim();
            
            if (!messageText) return;
            try { recordOemQuestion(messageText, 'enduser'); } catch (e) {}
            
            const chatMessages = document.getElementById('chatMessages');
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-message user';
            userMessage.innerHTML = `
                <div class="chat-bubble user">
                    ${messageText.replace(/\n/g, '<br>')}
                </div>
            `;
            chatMessages.appendChild(userMessage);
            
            // å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
            input.value = '';
            input.style.height = 'auto';
            
            // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ€ä¸‹éƒ¨ã«
            setTimeout(() => {
                document.getElementById('homeContent').scrollTop = document.getElementById('homeContent').scrollHeight;
            }, 100);
            
            // AIå¿œç­”ã‚’ç”Ÿæˆï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
            setTimeout(() => {
                const aiMessage = document.createElement('div');
                aiMessage.className = 'chat-message ai';
                aiMessage.innerHTML = `
                    <div class="chat-bubble ai">
                        <strong>è¿½åŠ ã®æƒ…å ±ã‚’ã”æ¡ˆå†…ã—ã¾ã™</strong><br><br>
                        ${generateChatResponse(messageText)}
                    </div>
                `;
                chatMessages.appendChild(aiMessage);
                
                // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ€ä¸‹éƒ¨ã«
                setTimeout(() => {
                    document.getElementById('homeContent').scrollTop = document.getElementById('homeContent').scrollHeight;
                }, 100);
            }, 1000);
        }

        // ãƒãƒ£ãƒƒãƒˆå¿œç­”ã‚’ç”Ÿæˆï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
        function generateChatResponse(question) {
            const lowerQuestion = question.toLowerCase();
            
            if (lowerQuestion.includes('ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼') || lowerQuestion.includes('äº¤æ›')) {
                return `
                    ã‚¨ã‚¢ã‚³ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®äº¤æ›æ‰‹é †ã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼š<br><br>
                    <strong>å¿…è¦ãªã‚‚ã®ï¼š</strong><br>
                    â€¢ æ–°ã—ã„ã‚¨ã‚¢ã‚³ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼<br>
                    â€¢ æ¸…æ½”ãªå¸ƒï¼ˆã‚ã‚Œã°ï¼‰<br><br>
                    <strong>äº¤æ›æ‰‹é †ï¼š</strong><br>
                    1. ã‚°ãƒ­ãƒ¼ãƒ–ãƒœãƒƒã‚¯ã‚¹ã‚’é–‹ã‘ã¾ã™<br>
                    2. ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚«ãƒãƒ¼ã‚’å¤–ã—ã¾ã™<br>
                    3. å¤ã„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’å–ã‚Šå‡ºã—ã¾ã™<br>
                    4. æ–°ã—ã„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’å–ã‚Šä»˜ã‘ã¾ã™<br><br>
                    è©³ã—ã„æ‰‹é †ã¯ã€Œã‚¨ã‚¢ã‚³ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ¸…æƒæ–¹æ³•ã€ã‚’ã”è¦§ãã ã•ã„ã€‚
                `;
            } else if (lowerQuestion.includes('è¨­å®š') || lowerQuestion.includes('æ¸©åº¦')) {
                return `
                    ã‚¨ã‚¢ã‚³ãƒ³ã®æ¸©åº¦è¨­å®šã«ã¤ã„ã¦ã”æ¡ˆå†…ã—ã¾ã™ï¼š<br><br>
                    <strong>æ¨å¥¨è¨­å®šï¼š</strong><br>
                    â€¢ å†·æˆ¿æ™‚ï¼š18-22â„ƒ<br>
                    â€¢ æš–æˆ¿æ™‚ï¼š22-25â„ƒ<br><br>
                    <strong>è¨­å®šæ–¹æ³•ï¼š</strong><br>
                    1. ã‚¨ã‚¢ã‚³ãƒ³ãƒ‘ãƒãƒ«ã®ã€Œæ¸©åº¦ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™<br>
                    2. +/- ãƒœã‚¿ãƒ³ã§æ¸©åº¦ã‚’èª¿æ•´<br>
                    3. é¢¨é‡ã¯ã€Œä¸­ã€ä»¥ä¸Šã‚’æ¨å¥¨<br><br>
                    é©åˆ‡ãªæ¸©åº¦è¨­å®šã§å¿«é©ã«ãŠéã”ã—ãã ã•ã„ã€‚
                `;
            } else if (lowerQuestion.includes('è²©å£²åº—') || lowerQuestion.includes('é€£çµ¡')) {
                return `
                    æœ€å¯„ã‚Šã®è²©å£²åº—ã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼š<br><br>
                    <strong>ğŸ“ ãƒˆãƒ¨ã‚¿æ±äº¬è²©å£²åº— æ¸‹è°·åº—</strong><br>
                    â€¢ ä½æ‰€ï¼šæ±äº¬éƒ½æ¸‹è°·åŒº...<br>
                    â€¢ é›»è©±ï¼š03-XXXX-XXXX<br>
                    â€¢ å–¶æ¥­æ™‚é–“ï¼š9:00-18:00<br><br>
                    äº‹å‰ã«ãŠé›»è©±ã§ã”äºˆç´„ã„ãŸã ãã¨ã‚¹ãƒ ãƒ¼ã‚ºã§ã™ã€‚
                `;
            } else {
                return `
                    ã”è³ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br><br>
                    ã€Œ${question}ã€ã«ã¤ã„ã¦ç¢ºèªã—ã¦ã„ã¾ã™ã€‚<br><br>
                    ã‚ˆã‚Šè©³ã—ã„æƒ…å ±ãŒå¿…è¦ãªå ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãŠè©¦ã—ãã ã•ã„ï¼š<br>
                    â€¢ æ¤œç´¢ãƒãƒ¼ã§å…·ä½“çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›<br>
                    â€¢ è²©å£²åº—ã«ãŠå•ã„åˆã‚ã›<br>
                    â€¢ å–æ‰±èª¬æ˜æ›¸ã®è©²å½“ãƒšãƒ¼ã‚¸ã‚’ç¢ºèª<br><br>
                    ä»–ã«ãŠå›°ã‚Šã®ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ
                `;
            }
        }

        // é€šçŸ¥ç”»é¢ã‚’è¡¨ç¤º
        function showNotificationScreen() {
            const resultDiv = document.getElementById('searchResult');
            const defaultContent = document.getElementById('defaultContent');
            
            defaultContent.classList.add('hidden');
            
            resultDiv.innerHTML = `
                <div class="card" style="margin-bottom: 15px;">
                    <div class="card-title" style="font-size: 1.1em;">
                        ğŸ”” ${t('notif-title')}
                    </div>
                    <div class="card-content" style="color: #aaa; font-size: 0.9em;">
                        ${t('notif-feedback')}
                    </div>
                </div>

                <div id="notificationList">
                    <div class="card" id="notification-1" style="margin-bottom: 15px; border: 1px solid rgba(191, 0, 255, 0.3);">
                        <div class="card-content">
                            <div style="font-size: 0.85em; color: #888; margin-bottom: 8px;">5${t('notif-time-minutes')}</div>
                            <div style="margin-bottom: 12px;">${t('notif-1')}</div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="removeNotification('notification-1', 'helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px;">
                                    âœ… ${t('notif-helpful')}
                                </button>
                                <button onclick="removeNotification('notification-1', 'not-helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px;">
                                    ğŸ˜’ ${t('notif-not-helpful')}
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card" id="notification-2" style="margin-bottom: 15px; border: 1px solid rgba(191, 0, 255, 0.3);">
                        <div class="card-content">
                            <div style="font-size: 0.85em; color: #888; margin-bottom: 8px;">1${t('notif-time-hours')}</div>
                            <div style="margin-bottom: 12px;">${t('notif-2')}</div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="removeNotification('notification-2', 'helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px;">
                                    âœ… ${t('notif-helpful')}
                                </button>
                                <button onclick="removeNotification('notification-2', 'not-helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px;">
                                    ğŸ˜’ ${t('notif-not-helpful')}
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card" id="notification-3" style="margin-bottom: 15px; border: 1px solid rgba(191, 0, 255, 0.3);">
                        <div class="card-content">
                            <div style="font-size: 0.85em; color: #888; margin-bottom: 8px;">3${t('notif-time-hours')}</div>
                            <div style="margin-bottom: 12px;">${t('notif-3')}</div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="removeNotification('notification-3', 'helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px;">
                                    âœ… ${t('notif-helpful')}
                                </button>
                                <button onclick="removeNotification('notification-3', 'not-helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px;">
                                    ğŸ˜’ ${t('notif-not-helpful')}
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card" id="notification-4" style="margin-bottom: 15px; border: 1px solid rgba(191, 0, 255, 0.3);">
                        <div class="card-content">
                            <div style="font-size: 0.85em; color: #888; margin-bottom: 8px;">${t('notif-time-yesterday')}</div>
                            <div style="margin-bottom: 12px;">${t('notif-4')}</div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="removeNotification('notification-4', 'helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px;">
                                    âœ… ${t('notif-helpful')}
                                </button>
                                <button onclick="removeNotification('notification-4', 'not-helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px;">
                                    ğŸ˜’ ${t('notif-not-helpful')}
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card" id="notification-5" style="margin-bottom: 15px; border: 1px solid rgba(191, 0, 255, 0.3);">
                        <div class="card-content">
                            <div style="font-size: 0.85em; color: #888; margin-bottom: 8px;">2${t('notif-time-days')}</div>
                            <div style="margin-bottom: 12px;">${t('notif-5')}</div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="removeNotification('notification-5', 'helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px;">
                                    âœ… ${t('notif-helpful')}
                                </button>
                                <button onclick="removeNotification('notification-5', 'not-helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px;">
                                    ğŸ˜’ ${t('notif-not-helpful')}
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card" id="notification-6" style="margin-bottom: 15px; border: 1px solid rgba(191, 0, 255, 0.3);">
                        <div class="card-content">
                            <div style="font-size: 0.85em; color: #888; margin-bottom: 8px;">3${t('notif-time-days')}</div>
                            <div style="margin-bottom: 12px;">${t('notif-6')}</div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="removeNotification('notification-6', 'helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #00d084 0%, #00b96d 100%); padding: 10px;">
                                    âœ… ${t('notif-helpful')}
                                </button>
                                <button onclick="removeNotification('notification-6', 'not-helpful')" class="button" style="flex: 1; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); padding: 10px;">
                                    ğŸ˜’ ${t('notif-not-helpful')}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            resultDiv.classList.remove('hidden');
            document.getElementById('homeContent').scrollTop = 0;
        }

        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼‰
        let userStatus = {
            totalPoints: 850,
            maxPoints: 2000,
            level: 2,
            usedFeatures: 8,
            totalFeatures: 20,
            levelHistory: {
                1: { startDate: '2025/11/01', endDate: '2025/12/15' },
                2: { startDate: '2025/12/15', endDate: null },
                3: { startDate: null, endDate: null },
                4: { startDate: null, endDate: null }
            }
        };

        // é€šçŸ¥ã‚’ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤
        function removeNotification(notificationId, feedback) {
            const notification = document.getElementById(notificationId);
            if (notification) {
                if (feedback === 'helpful') {
                    userStatus.totalPoints += 500;
                    userStatus.usedFeatures += 1;
                    checkLevelUp();
                    showStatusUpNotification();
                }
                
                notification.style.transition = 'all 0.3s ease';
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100px)';
                
                setTimeout(() => {
                    notification.remove();
                    
                    const notificationList = document.getElementById('notificationList');
                    if (notificationList && notificationList.children.length === 0) {
                        notificationList.innerHTML = `
                            <div class="card" style="text-align: center; padding: 40px 20px;">
                                <div style="font-size: 3em; margin-bottom: 15px;">âœ…</div>
                                <div style="color: #BF00FF; font-size: 1.1em; font-weight: 600;">
                                    ã™ã¹ã¦ã®é€šçŸ¥ã‚’ç¢ºèªã—ã¾ã—ãŸ
                                </div>
                                <div style="color: #aaa; margin-top: 10px; font-size: 0.9em;">
                                    ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼
                                </div>
                                <button class="button" onclick="switchTab('status')" style="margin-top: 20px; background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%); color: #1A1A1A;">
                                    ğŸ“Š ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèªã™ã‚‹
                                </button>
                            </div>
                        `;
                    }
                }, 300);
                
                console.log(`Notification ${notificationId} marked as ${feedback}`);
            }
        }

        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯
        function checkLevelUp() {
            let leveledUp = false;
            let newLevel = userStatus.level;
            const currentDate = getCurrentDate();
            
            if (userStatus.level === 2 && userStatus.totalPoints >= 2000) {
                userStatus.levelHistory[2].endDate = currentDate;
                userStatus.levelHistory[3].startDate = currentDate;
                userStatus.level = 3;
                userStatus.totalPoints = userStatus.totalPoints - 2000;
                userStatus.maxPoints = 3000;
                leveledUp = true;
                newLevel = 3;
            } else if (userStatus.level === 3 && userStatus.totalPoints >= 3000) {
                userStatus.levelHistory[3].endDate = currentDate;
                userStatus.levelHistory[4].startDate = currentDate;
                userStatus.level = 4;
                userStatus.totalPoints = userStatus.totalPoints - 3000;
                userStatus.maxPoints = 5000;
                leveledUp = true;
                newLevel = 4;
            }
            
            if (leveledUp) {
                showLevelUpNotification(newLevel);
            }
        }

        // ç¾åœ¨ã®æ—¥ä»˜ã‚’å–å¾—ï¼ˆYYYY/MM/DDå½¢å¼ï¼‰
        function getCurrentDate() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            return `${year}/${month}/${day}`;
        }

        // ãƒ¬ãƒ™ãƒ«ä¸€è¦§ã‚’ç”Ÿæˆ
        function generateLevelList() {
            const levels = [
                { level: 1, name: t('status-level-1'), desc: t('status-level-1-desc') },
                { level: 2, name: t('status-level-2'), desc: t('status-level-2-desc') },
                { level: 3, name: t('status-level-3'), desc: t('status-level-3-desc') },
                { level: 4, name: t('status-level-4'), desc: t('status-level-4-desc') }
            ];
            
            let html = '';
            
            for (let i = levels.length - 1; i >= 0; i--) {
                const levelData = levels[i];
                const levelNum = levelData.level;
                const history = userStatus.levelHistory[levelNum];
                const isCurrent = levelNum === userStatus.level;
                const isAchieved = history.startDate !== null;
                
                let periodText = '';
                if (isAchieved) {
                    if (history.endDate) {
                        periodText = `${history.startDate} ã€œ ${history.endDate}`;
                    } else {
                        periodText = `${history.startDate} ã€œ ${t('status-current')}`;
                    }
                }
                
                let cardStyle = '';
                let textColor = '';
                let badge = '';
                
                if (isCurrent) {
                    cardStyle = 'padding: 12px; background: rgba(191, 0, 255, 0.1); border-radius: 8px; margin-bottom: 10px; border-left: 3px solid #BF00FF;';
                    textColor = '#BF00FF';
                    badge = `<span style="color: #00d084; margin-left: 5px;">â— ${t('status-current')}</span>`;
                } else if (isAchieved) {
                    cardStyle = 'padding: 12px; background: rgba(45, 53, 97, 0.4); border-radius: 8px; margin-bottom: 10px; opacity: 0.6;';
                    textColor = '#888';
                    badge = `<span style="color: #888; margin-left: 5px;">âœ“ ${t('status-achieved')}</span>`;
                } else {
                    cardStyle = 'padding: 12px; background: rgba(45, 53, 97, 0.4); border-radius: 8px; margin-bottom: 10px;';
                    textColor = '#888';
                    badge = `<span style="margin-left: 5px;">${t('status-locked')}</span>`;
                }
                
                html += `
                    <div style="${cardStyle}">
                        <strong style="color: ${textColor};">Lv ${levelNum} | ${levelData.name}</strong> ${badge}<br>
                        <span style="font-size: 0.85em; color: ${isAchieved || isCurrent ? '#aaa' : '#666'};">${levelData.desc}</span>
                        ${periodText ? `<br><span style="font-size: 0.8em; color: #888; margin-top: 5px; display: inline-block;">ğŸ“… ${periodText}</span>` : ''}
                    </div>
                `;
            }
            
            return html;
        }

        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—é€šçŸ¥ã‚’è¡¨ç¤º
        function showLevelUpNotification(newLevel) {
            const levelNames = {
                2: 'é¡”ãªã˜ã¿',
                3: 'é ¼ã‚Œã‚‹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼',
                4: 'ç›¸æ£’'
            };
            
            const existingToast = document.getElementById('levelUpToast');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.id = 'levelUpToast';
            toast.style.cssText = `
                position: fixed;
                top: 80px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                color: white;
                padding: 20px 30px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(240, 147, 251, 0.6);
                z-index: 10000;
                font-weight: 600;
                animation: slideDown 0.3s ease;
                text-align: center;
            `;
            toast.innerHTML = `
                <div style="font-size: 2em; margin-bottom: 5px;">ğŸ‰</div>
                ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼<br>
                <span style="font-size: 1.2em;">Lv ${newLevel} | ${levelNames[newLevel]}</span>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideUp 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¢ãƒƒãƒ—ã®é€šçŸ¥ã‚’è¡¨ç¤º
        function showStatusUpNotification() {
            const existingToast = document.getElementById('statusUpToast');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.id = 'statusUpToast';
            toast.style.cssText = `
                position: fixed;
                top: 80px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #00d084 0%, #00b96d 100%);
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                box-shadow: 0 4px 15px rgba(0, 208, 132, 0.5);
                z-index: 10000;
                font-weight: 600;
                animation: slideDown 0.3s ease;
                text-align: center;
            `;
            toast.innerHTML = `
                âœ¨ +500pt ç²å¾—ï¼<br>
                <span style="font-size: 0.85em; font-weight: 400;">æ©Ÿèƒ½ã‚’1ã¤ç¿’å¾—ã—ã¾ã—ãŸ</span>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideUp 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 2000);
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç”»é¢ã‚’è¡¨ç¤º
        function showStatusScreen() {
            const resultDiv = document.getElementById('searchResult');
            const defaultContent = document.getElementById('defaultContent');
            
            defaultContent.classList.add('hidden');
            
            const percentage = (userStatus.totalPoints / userStatus.maxPoints) * 100;
            const levelName = userStatus.level === 1 ? t('status-level-1') : 
                             userStatus.level === 2 ? t('status-level-2') : 
                             userStatus.level === 3 ? t('status-level-3') : t('status-level-4');
            
            resultDiv.innerHTML = `
                <div class="card" style="margin-bottom: 15px; border: 2px solid #BF00FF;">
                    <div class="card-title" style="background: linear-gradient(135deg, #BF00FF 0%, #D200FF 100%); color: #1A1A1A; padding: 15px; margin: -1px -1px 0 -1px; border-radius: 10px 10px 0 0; font-size: 1.1em;">
                        ğŸ¤ ${t('status-title')}
                    </div>
                    <div class="card-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="font-size: 3em; margin-bottom: 10px;">ğŸš—ğŸ’™</div>
                            <div style="font-size: 1.8em; font-weight: bold; color: #BF00FF; margin-bottom: 5px;">Lv ${userStatus.level} | ${levelName}</div>
                            <div style="color: #aaa; font-size: 0.9em;">${t('status-next-level')} ${userStatus.totalPoints} / ${userStatus.maxPoints} pt</div>
                        </div>

                        <div style="background: rgba(45, 53, 97, 0.6); height: 25px; border-radius: 12px; overflow: hidden; margin: 20px 0; position: relative;">
                            <div id="statusProgressBar" style="background: linear-gradient(90deg, #BF00FF 0%, #D200FF 100%); width: ${percentage}%; height: 100%; border-radius: 12px; transition: width 0.5s ease;">
                            </div>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 0.85em; font-weight: 600;">${Math.round(percentage)}%</div>
                        </div>

                        <div style="background: linear-gradient(135deg, rgba(191, 0, 255, 0.15) 0%, rgba(210, 0, 255, 0.1) 100%); padding: 15px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #BF00FF;">
                            <strong style="color: #BF00FF;">ğŸ’¡ ${t('status-hint-title')}</strong><br>
                            <div style="margin-top: 10px; color: #e0e0e0; font-size: 0.9em;">
                                â€¢ ${t('status-hint-1')}<br>
                                â€¢ ${t('status-hint-2')}<br>
                                â€¢ ${t('status-hint-3')}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-bottom: 15px;">
                    <div class="card-title">
                        ğŸš™ ${t('status-drive-title')}
                    </div>
                    <div class="card-content">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="color: #aaa;">${t('status-total-distance')}</span>
                                <span style="color: #BF00FF; font-weight: 600;">12,450 km</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="color: #aaa;">${t('status-monthly-distance')}</span>
                                <span style="color: #BF00FF; font-weight: 600;">450 km</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #aaa;">${t('status-avg-fuel')}</span>
                                <span style="color: #BF00FF; font-weight: 600;">8.9 km/L</span>
                            </div>
                        </div>
                        <div style="text-align: center; padding: 10px; background: rgba(0, 208, 132, 0.1); border-radius: 8px; border: 1px solid rgba(0, 208, 132, 0.3);">
                            <span style="color: #00d084; font-weight: 600;">+50 pt</span>
                            <span style="color: #aaa; font-size: 0.9em; margin-left: 5px;">${t('status-monthly-goal')}</span>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-bottom: 15px;">
                    <div class="card-title">
                        âœ¨ ${t('status-feature-title')}
                    </div>
                    <div class="card-content">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #aaa;">${t('status-features-used')}</span>
                                <span style="color: #BF00FF; font-weight: 600;">${userStatus.usedFeatures} / ${userStatus.totalFeatures}</span>
                            </div>
                            <div style="background: rgba(45, 53, 97, 0.6); height: 10px; border-radius: 5px; overflow: hidden;">
                                <div id="featureProgressBar" style="background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); width: ${(userStatus.usedFeatures / userStatus.totalFeatures) * 100}%; height: 100%; border-radius: 5px; transition: width 0.5s ease;"></div>
                            </div>
                        </div>
                        <div style="font-size: 0.9em; color: #aaa;">
                            ${t('status-recent-features')}<br>
                            â€¢ ${t('status-feature-seat')}<br>
                            â€¢ ${t('status-feature-panoramic')}<br>
                            â€¢ ${t('status-feature-eco')}
                        </div>
                        <div style="text-align: center; padding: 10px; background: rgba(102, 126, 234, 0.1); border-radius: 8px; border: 1px solid rgba(102, 126, 234, 0.3); margin-top: 10px;">
                            <span style="color: #667eea; font-weight: 600;">+30 pt</span>
                            <span style="color: #aaa; font-size: 0.9em; margin-left: 5px;">${t('status-new-feature')}</span>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-bottom: 15px;">
                    <div class="card-title">
                        ğŸ”§ ${t('status-maintenance-title')}
                    </div>
                    <div class="card-content">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="color: #aaa;">${t('status-last-check')}</span>
                                <span style="color: #BF00FF; font-weight: 600;">2025/12/15</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="color: #aaa;">${t('status-next-check')}</span>
                                <span style="color: #BF00FF; font-weight: 600;">2026/03/15</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #aaa;">${t('status-maintenance-rate')}</span>
                                <span style="color: #00d084; font-weight: 600;">95%</span>
                            </div>
                        </div>
                        <div style="text-align: center; padding: 10px; background: rgba(191, 0, 255, 0.1); border-radius: 8px; border: 1px solid rgba(191, 0, 255, 0.3);">
                            <span style="color: #BF00FF; font-weight: 600;">+70 pt</span>
                            <span style="color: #aaa; font-size: 0.9em; margin-left: 5px;">${t('status-proper-maintenance')}</span>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-bottom: 15px;">
                    <div class="card-title">
                        ğŸ† ${t('status-level-list-title')}
                    </div>
                    <div class="card-content">
                        ${generateLevelList()}
                    </div>
                </div>
            `;
            
            resultDiv.classList.remove('hidden');
            document.getElementById('homeContent').scrollTop = 0;
        }

        // Enterã‚­ãƒ¼ã§æ¤œç´¢ãƒ»åˆæœŸè¡¨ç¤º
        document.addEventListener('DOMContentLoaded', function() {
            // è¨€èªè¨­å®šã‚’å¾©å…ƒ
            var savedLang = localStorage.getItem('preferred_language');
            if (savedLang && savedLang !== 'ja') {
                selectLanguage(savedLang);
            }
            
            var searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') performSearch();
                });
            }
            try { displayRandomAlert(); } catch (e) { console.warn('displayRandomAlert:', e); }
            setTimeout(function() { try { displayRandomAlert(); } catch (e) {} }, 100);
        });
    </script>
</body>
</html>
